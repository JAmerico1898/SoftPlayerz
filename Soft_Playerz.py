import streamlit as st
from streamlit_option_menu import option_menu
import streamlit.components.v1 as html
#from PIL import image
import numpy as np
import pandas as pd
#from st_aggrid import AgGrid, GridOptionsBuilder, ColumnsAutoSizeMode
import plotly.express as px
import io
import matplotlib.pyplot as plt
from soccerplots.radar_chart import Radar
from sklearn.decomposition import PCA
from PIL import Image
#from pandas.plotting import table
import seaborn as sns
from matplotlib import cm
import matplotlib.ticker as ticker
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import google.generativeai as genai
from dotenv import load_dotenv
import os
from streamlit.components.v1 import html
import matplotlib.patches as patches
from matplotlib.patches import FancyBboxPatch, Arc
   
#CABEÇALHO DO FORM
st.markdown("<h2 style='text-align: center;'>Plataforma de Scouting</h2>", unsafe_allow_html=True)
st.markdown("<h6 style='text-align: center;'>Atualizado em 19Dez2025.</h6>", unsafe_allow_html=True)

st.markdown("""
<style>
@keyframes blink {
    0% { opacity: 1; color: #dc2626; }
    50% { opacity: 0.3; color: #ef4444; }
    100% { opacity: 1; color: #dc2626; }
}

.blinking-text {
    animation: blink 2s ease-in-out infinite;
    text-align: center;
    font-weight: 500;
}
</style>
<h4 class='blinking-text'>Após selecionar a opção, role até o final da página!</h4>
""", unsafe_allow_html=True)

st.markdown("<hr style='border:0.5px solid black;'>", unsafe_allow_html=True)

df = pd.read_csv("jogadores.csv")
df1 = pd.read_csv("jogador.csv")
df2 = pd.read_csv("Funções.csv")
df5 = pd.read_csv("ligas.csv")
df6 = pd.read_csv("Posições.csv")
df7 = pd.read_csv("temporadas.csv")
df8 = pd.read_csv("nacionalidades.csv")
df9 = pd.read_csv("contratos.csv")
df10 = pd.read_csv('jogadores_similares_2.csv')
df14 = pd.read_csv(
    "performance_historica.csv.zip",
    compression="zip"
)
df_comp = pd.read_csv("jogadores_comp_wyscout.csv")
jogadores = df1["Atleta"]

# Define your options
options = [
            "Ranking de Jogadores ",
            "10 Melhores da Liga",
            "Nacionais pelo Mundo", 
            "Free Agents pelo Mundo",
            "Histórico de Performance",
            "Jogadores Similares",
            "Histórico do Jogador",
            "Sobre o APP",
            "Compare Jogadores",
            "Seleção da Liga",
            "Dúvidas, Sugestões"
]

###############################################################################################################################
###############################################################################################################################
###############################################################################################################################
###############################################################################################################################

# Function to scroll to bottom of page
def scroll_to_bottom():
    # JavaScript to scroll to bottom of page
    js = """
    <script>
        // Use setTimeout to ensure this runs after Streamlit has rendered everything
        setTimeout(function() {
            window.scrollTo(0, document.body.scrollHeight);
        }, 700);  // Increased delay to ensure content is loaded
    </script>
    """
    html(js, height=0)    
    

# Initialize session state variables if they don't exist
if 'selected_option' not in st.session_state:
    st.session_state.selected_option = None
    st.session_state.should_scroll = False

# Define button click handlers for each option
def select_option(option):
    st.session_state.selected_option = option

# Define custom CSS for button styling
st.markdown("""
<style>
    /* Default button style (light gray) */
    .stButton > button {
        background-color: #f0f2f6 !important;
        color: #31333F !important;
        border-color: #d2d6dd !important;
        width: 100%;
    }
    
    /* Selected button style (red) */
    .selected-button {
        background-color: #FF4B4B !important;
        color: white !important;
        border-color: #FF0000 !important;
        width: 100%;
        padding: 0.5rem;
        font-weight: 400;
        border-radius: 0.25rem;
        cursor: default;
        text-align: center;
        margin-bottom: 0.75rem;
    }
</style>
""", unsafe_allow_html=True)

       

st.markdown("<h3 style='text-align: center;'>Mapeamento de Jogadores</h3>", unsafe_allow_html=True)
st.markdown("<h4 style='text-align: center;'>(Dados Wyscout)</h4>", unsafe_allow_html=True)

# Row 2
# Create three columns for the initial choices
col7, col8, col9 = st.columns([1, 4, 1])

# Render buttons based on current state
with col8:
    if st.session_state.selected_option == options[0]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[0]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[0], key="btn3", use_container_width=True, on_click=select_option, args=(options[0],))



# Create three columns for the initial choices
col10, col11, col12 = st.columns([3, 3, 3])

# Row 1
with col10:
    if st.session_state.selected_option == options[1]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[1]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[1], key="btn4", use_container_width=True, on_click=select_option, args=(options[1],))

with col11:
    if st.session_state.selected_option == options[2]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[2]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[2], key="btn5", use_container_width=True, on_click=select_option, args=(options[2],))

with col12:
    if st.session_state.selected_option == options[3]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[3]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[3], key="btn6", use_container_width=True, on_click=select_option, args=(options[3],))


# Create three columns for the initial choices
col13, col14, col15 = st.columns([3, 3, 3])

# Row 5
with col13:
    if st.session_state.selected_option == options[4]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[4]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[4], key="btn7", use_container_width=True, on_click=select_option, args=(options[4],))

with col14:
    if st.session_state.selected_option == options[5]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[5]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[5], key="btn8", use_container_width=True, on_click=select_option, args=(options[5],))

with col15:
    if st.session_state.selected_option == options[6]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[6]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[6], key="btn9", use_container_width=True, on_click=select_option, args=(options[6],))

# Create three columns for the initial choices
col16, col17, col18 = st.columns([3, 3, 3])

# Row 2
with col16:
    if st.session_state.selected_option == options[7]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[7]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[7], key="btn1", use_container_width=True, on_click=select_option, args=(options[7],))

# Row 2
with col17:
    if st.session_state.selected_option == options[9]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[9]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        # Display default (gray) button
        st.button(options[9], key="btn11", use_container_width=True, on_click=select_option, args=(options[9],))

with col18:
    if st.session_state.selected_option == options[8]:
        # Display selected (red) button
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[8]}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )

    else:
        # Display default (gray) button
        st.button(options[8], key="btn10", use_container_width=True, on_click=select_option, args=(options[8],))

# Create three columns for the initial choices
col19, col20, col21 = st.columns([3, 3, 3])

# Row 5
with col20:
    badge_novo = '<span style="color: gold; font-size: 0.75em; font-weight: bold;">novo</span>'
    
    if st.session_state.selected_option == options[10]:
        st.markdown(
            f"""
            <div data-testid="stButton">
                <button class="selected-button">
                    {options[10]} {badge_novo}
                </button>
            </div>
            """, 
            unsafe_allow_html=True
        )
    else:
        st.button(options[10], key="btn12", use_container_width=True, on_click=select_option, args=(options[10],))
        st.markdown(
            '<p style="text-align: right; margin-top: -62px; margin-right: 12px; font-size: 0.70em; color: gold; font-weight: bold; pointer-events: none;">novo</p>',
            unsafe_allow_html=True
        )

st.markdown("<hr style='border:0.5px solid black;'>", unsafe_allow_html=True)

   
###########################################################################################################
###########################################################################################################
import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.patches as patches
from matplotlib.patches import FancyBboxPatch, Arc, Rectangle, Circle, Wedge
import numpy as np

# ============================================================================
# CÓDIGO PARA A FEATURE "SELEÇÃO DA LIGA"
# Cole este código dentro do bloco: if st.session_state.selected_option == "Seleção da Liga":
# ============================================================================

# Mapeamento dos perfis para os arquivos CSV
PERFIS_CSV = {
    "Goleiro": "PlayerAnalysis_Role_1.csv",
    "Goleiro-Líbero": "PlayerAnalysis_Role_2.csv",
    "Lateral Defensivo": "PlayerAnalysis_Role_3.csv",
    "Lateral Ofensivo": "PlayerAnalysis_Role_4.csv",
    "Lateral Equilibrado": "PlayerAnalysis_Role_5.csv",
    "Zagueiro Defensivo": "PlayerAnalysis_Role_6.csv",
    "Zagueiro Construtor": "PlayerAnalysis_Role_7.csv",
    "Zagueiro Equilibrado": "PlayerAnalysis_Role_8.csv",
    "1° Volante Defensivo": "PlayerAnalysis_Role_9.csv",
    "1° Volante Construtor": "PlayerAnalysis_Role_10.csv",
    "1° Volante Equilibrado": "PlayerAnalysis_Role_11.csv",
    "2° Volante Box to Box": "PlayerAnalysis_Role_12.csv",
    "2° Volante Organizador": "PlayerAnalysis_Role_13.csv",
    "2° Volante Equilibrado": "PlayerAnalysis_Role_14.csv",
    "Meia Organizador": "PlayerAnalysis_Role_15.csv",
    "Meia Atacante": "PlayerAnalysis_Role_16.csv",
    "Extremo Organizador": "PlayerAnalysis_Role_17.csv",
    "Extremo Tático": "PlayerAnalysis_Role_18.csv",
    "Extremo Agudo": "PlayerAnalysis_Role_19.csv",
    "Atacante Referência": "PlayerAnalysis_Role_20.csv",
    "Atacante Móvel": "PlayerAnalysis_Role_21.csv",
    "Segundo Atacante": "PlayerAnalysis_Role_22.csv",
}

def carregar_dados_perfil(perfil, liga, ranking, pe=None):
    """
    Carrega os dados do jogador de um perfil específico.
    """
    try:
        arquivo = PERFIS_CSV.get(perfil)
        if not arquivo:
            return None
        
        df = pd.read_csv(arquivo)
        
        # Filtrar por temporada 2025 e liga
        df_filtrado = df[
            (df["Versão_Temporada"] == 2025) & 
            (df["Liga"] == liga)
        ]

        # Se for lateral, filtrar pelo pé PRIMEIRO e depois ordenar por ranking dentro do grupo
        if pe and "Lateral" in perfil:
            df_filtrado = df_filtrado[df_filtrado["Pé"] == pe]
            # Ordenar por L_Ranking e pegar o n-ésimo melhor (ranking 1, 2 ou 3)
            df_filtrado = df_filtrado.sort_values("L_Ranking")
            if len(df_filtrado) >= ranking:
                df_ranking = df_filtrado.iloc[[ranking - 1]]  # índice 0 = ranking 1, etc.
            else:
                df_ranking = pd.DataFrame()  # vazio se não houver jogadores suficientes
        else:
            # Para outros perfis, manter lógica original
            df_ranking = df_filtrado[df_filtrado["L_Ranking"] == ranking]
            
        if df_ranking.empty:
            return None
        
        jogador = df_ranking.iloc[0]
        return {
            "atleta": jogador["Atleta"],
            "equipe": jogador["Equipe_Janela_Análise"][:3].upper()
        }
    except Exception as e:
        return None


def desenhar_campo_realista(ax):
    """
    Desenha um campo de futebol realista com grama e todas as marcações.
    Usa coordenadas normalizadas 0-100 para facilitar posicionamento.
    """
    # Dimensões normalizadas (0-100 em ambos os eixos)
    largura = 100
    altura = 100
    
    # ========== GRAMA DO CAMPO ==========
    ax.set_facecolor('#228B22')
    
    # Listras de grama
    num_listras = 10
    cores_grama = ['#1E7B1E', '#228B22']
    altura_listra = altura / num_listras
    
    for i in range(num_listras):
        cor = cores_grama[i % 2]
        rect = Rectangle((0, i * altura_listra), largura, altura_listra, 
                         facecolor=cor, edgecolor='none', zorder=0)
        ax.add_patch(rect)
    
    # ========== LINHAS DO CAMPO ==========
    cor_linha = 'white'
    lw = 2
    
    # Contorno
    contorno = Rectangle((0, 0), largura, altura, 
                         facecolor='none', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(contorno)
    
    # Linha do meio
    ax.plot([0, largura], [altura/2, altura/2], color=cor_linha, linewidth=lw, zorder=1)
    
    # Círculo central
    circulo = Circle((largura/2, altura/2), 9, 
                     facecolor='none', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(circulo)
    
    # Ponto central
    ponto_central = Circle((largura/2, altura/2), 0.5, 
                          facecolor=cor_linha, edgecolor=cor_linha, zorder=1)
    ax.add_patch(ponto_central)
    
    # ========== ÁREA INFERIOR ==========
    # Área grande
    area_grande_inf = Rectangle((20, 0), 60, 16,
                                facecolor='none', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(area_grande_inf)
    
    # Área pequena
    area_pequena_inf = Rectangle((36, 0), 28, 6,
                                 facecolor='none', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(area_pequena_inf)
    
    # Marca do pênalti
    penalti_inf = Circle((50, 11), 0.5, facecolor=cor_linha, zorder=1)
    ax.add_patch(penalti_inf)
    
    # Meia-lua
    arco_inf = Arc((50, 11), 18, 18, angle=0, theta1=37, theta2=143, 
                   color=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(arco_inf)
    
    # Gol inferior
    gol_inf = Rectangle((44, -3), 12, 3,
                        facecolor='#404040', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(gol_inf)
    
    # ========== ÁREA SUPERIOR ==========
    area_grande_sup = Rectangle((20, 84), 60, 16,
                                facecolor='none', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(area_grande_sup)
    
    area_pequena_sup = Rectangle((36, 94), 28, 6,
                                 facecolor='none', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(area_pequena_sup)
    
    penalti_sup = Circle((50, 89), 0.5, facecolor=cor_linha, zorder=1)
    ax.add_patch(penalti_sup)
    
    arco_sup = Arc((50, 89), 18, 18, angle=0, theta1=217, theta2=323, 
                   color=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(arco_sup)
    
    gol_sup = Rectangle((44, 100), 12, 3,
                        facecolor='#404040', edgecolor=cor_linha, linewidth=lw, zorder=1)
    ax.add_patch(gol_sup)
    
    # Configurar eixos
    ax.set_xlim(-2, 102)
    ax.set_ylim(-5, 105)
    ax.set_aspect('equal')
    ax.axis('off')
    
    return largura, altura


def adicionar_jogador(ax, x, y, perfil, atleta, equipe, fontsize=11):
    """
    Adiciona um jogador no campo com perfil, nome e equipe.
    Texto grande e legível.
    """
    texto = f"{perfil}\n{atleta}\n{equipe}"
    
    ax.annotate(texto, (x, y), 
                fontsize=fontsize, 
                ha='center', 
                va='center',
                color='white', 
                fontweight='bold',
                linespacing=1.1,
                bbox=dict(
                    boxstyle='round,pad=0.5', 
                    facecolor='#1B4D3E',
                    edgecolor='white',
                    linewidth=2,
                    alpha=0.95
                ),
                zorder=10)


def criar_selecao_liga(liga, ranking):
    """
    Cria a visualização da seleção da liga com campo realista.
    Coordenadas em escala 0-100.
    """
    # Figura grande para textos legíveis
    fig, ax = plt.subplots(figsize=(20, 28))
    
    desenhar_campo_realista(ax)
    
    # Centro do campo
    cx = 50
    
    # ========================================================================
    # POSIÇÕES DOS JOGADORES (escala 0-100)
    # ========================================================================
    
    # Fontes GRANDES
    fs_grande = 17
    fs_medio = 17
    
    # === GOLEIROS (y ~ 5) ===
    posicoes_goleiros = [
        ("Goleiro", 35, 5, None, fs_grande),
        ("Goleiro-Líbero", 65, 5, None, fs_grande),
    ]
    
    # === ZAGUEIROS (y ~ 18) ===
    posicoes_zagueiros = [
        ("Zagueiro Defensivo", 28, 18, None, fs_medio),
        ("Zagueiro Construtor", 50, 18, None, fs_medio),
        ("Zagueiro Equilibrado", 72, 18, None, fs_medio),
    ]
    
    # === LATERAIS ESQUERDOS (x ~ 6, vertical) ===
    posicoes_lat_esq = [
        ("Lateral Defensivo", 7.5, 18, "left", fs_medio),
        ("Lateral Equilibrado", 8, 27, "left", fs_medio),
        ("Lateral Ofensivo", 7, 36, "left", fs_medio),
    ]
    
    # === LATERAIS DIREITOS (x ~ 94, vertical) ===
    posicoes_lat_dir = [
        ("Lateral Defensivo", 92.5, 18, "right", fs_medio),
        ("Lateral Equilibrado", 92, 27, "right", fs_medio),
        ("Lateral Ofensivo", 93, 36, "right", fs_medio),
    ]
    
    # === 1° VOLANTES (y ~ 36) ===
    posicoes_volante1 = [
        ("1° Volante Defensivo", 28, 38, None, fs_medio),
        ("1° Volante Construtor", 50, 38, None, fs_medio),
        ("1° Volante Equilibrado", 72, 38, None, fs_medio),
    ]
    
    # === 2° VOLANTES (y ~ 54) ===
    posicoes_volante2 = [
        ("2° Volante Box to Box", 28, 54, None, fs_medio),
        ("2° Volante Organizador", 50, 54, None, fs_medio),
        ("2° Volante Equilibrado", 72, 54, None, fs_medio),
    ]
    
    # === MEIAS (y ~ 68) ===
    posicoes_meias = [
        ("Meia Organizador", 37, 68, None, fs_grande),
        ("Meia Atacante", 63, 68, None, fs_grande),
    ]
    
    # === EXTREMOS (x ~ 94, vertical no ataque) ===
    posicoes_extremos = [
        ("Extremo Tático", 93, 68, None, fs_medio),
        ("Extremo Organizador", 91, 78, None, fs_medio),
        ("Extremo Agudo", 93, 88, None, fs_medio),
    ]
    
    # === ATACANTES (x ~ 6, vertical no ataque) ===
    posicoes_atacantes = [
        ("Atacante Referência", 28, 94, None, fs_medio),
        ("Atacante Móvel", 50, 94, None, fs_medio),
        ("Segundo Atacante", 72, 94, None, fs_medio),
    ]
    
    # ========================================================================
    # PLOTAR JOGADORES
    # ========================================================================
    
    todas_posicoes = (
        posicoes_goleiros + 
        posicoes_zagueiros + 
        posicoes_lat_esq + 
        posicoes_lat_dir + 
        posicoes_volante1 + 
        posicoes_volante2 + 
        posicoes_meias + 
        posicoes_extremos + 
        posicoes_atacantes
    )
    
    for perfil, x, y, pe, fontsize in todas_posicoes:
        dados = carregar_dados_perfil(perfil, liga, ranking, pe)
        if dados:
            adicionar_jogador(ax, x, y, perfil, dados['atleta'], dados['equipe'], fontsize)
        else:
            adicionar_jogador(ax, x, y, perfil, "N/D", "---", fontsize)
    
    # Título
    ranking_texto = {1: "Melhores", 2: "2° Melhores", 3: "3° Melhores"}
    plt.title(f"Seleção da Liga - {liga}\n{ranking_texto[ranking]} Jogadores por Perfil - Temporada 2025", 
              fontsize=24, fontweight='bold', color='#1B4D3E', pad=25)
    
    plt.tight_layout()
    return fig


# ============================================================================
# CÓDIGO PRINCIPAL PARA O STREAMLIT
# Cole a partir daqui no seu app, substituindo o código existente
# ============================================================================

if st.session_state.selected_option == "Seleção da Liga":
    
    st.markdown("<h2 style='text-align: center;'>Seleção da Liga</h2>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center;'>2025</h3>", unsafe_allow_html=True)
    
    # Obter ligas disponíveis
    ligas = df5["Liga"].unique().tolist()
    
    # Seleção da liga
    liga_selecionada = st.selectbox(
        "Selecione a liga desejada:", 
        options=ligas, 
        index=None, 
        placeholder="Escolha uma liga..."
    )
    
    if liga_selecionada:
        # Radio para selecionar qual ranking mostrar
        opcao_ranking = st.radio(
            "Selecione a versão da Seleção:",
            options=["Melhor Jogador (1°)", "2° Melhor Jogador", "3° Melhor Jogador"],
            index=0,
            horizontal=True
        )
        
        # Mapear opção para ranking
        mapa_ranking = {
            "Melhor Jogador (1°)": 1,
            "2° Melhor Jogador": 2,
            "3° Melhor Jogador": 3
        }
        ranking = mapa_ranking[opcao_ranking]
        
        # Criar e exibir a visualização
        with st.spinner("Gerando a Seleção da Liga..."):
            fig = criar_selecao_liga(liga_selecionada, ranking)
            st.pyplot(fig)
            plt.close(fig)
        

###########################################################################################################
###########################################################################################################

if st.session_state.selected_option == "Dúvidas, Sugestões":
    
    st.markdown("<h2 style='text-align: center;'>Caso identifique um erro ou tenha uma sugestão de melhoria, envie uma mensagem!</h2>", unsafe_allow_html=True)
    from caixa_sugestoes import render
    render()

###########################################################################################################
###########################################################################################################

if st.session_state.selected_option == "Histórico do Jogador":
           
    st.markdown("<h2 style='text-align: center;'>Histórico do Jogador</h2>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center;'>2021-2025</h3>", unsafe_allow_html=True)
    nacionalidades = df8["Nacionalidade"]
    historico = pd.read_csv("base_bruta.csv")
    jogadores = st.selectbox("Digite o nome do seu jogador. A grafia deve ser exata!", options=jogadores, index=None, placeholder="Jogador")
    if jogadores:
        #Determinar a Nacionalidade
        df40 = historico.loc[(historico['Atleta']==jogadores)]
        nacionalidades = df40['Nacionalidade'].unique()
        nacionalidade = st.selectbox("Escolha a Nacionalidade do Jogador", options=nacionalidades)
   
#    if jogadores and nacionalidade:
        st.markdown("<h4 style='text-align: center;'>Histórico do Jogador<br>Temporadas 2021/2022/2023/2024/2025</b></h4>", unsafe_allow_html=True)
        historico = historico.loc[(historico['Atleta']==jogadores)&(historico['Nacionalidade']==nacionalidade)]
        historico = historico.iloc[:, np.r_[0, 2, 9, 10, 13, 15, 19]]
        historico = historico.rename(columns={"Equipe_Janela_Análise": "Equipe",
                                    "Versão_Temporada": "Temporada",
                                    "Posição.1": "Posição" 
                                    })
            
        historico = historico.sort_values(by='Temporada', ascending=False)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            return df.style.format().set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '8px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(historico).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################

if st.session_state.selected_option == "10 Melhores da Liga":
    st.markdown("<h2 style='text-align: center;'>10 Melhores da Liga</h2>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center;'>2022-2025</h3>", unsafe_allow_html=True)
    ligas = df5["Liga"]
    posições = df6["Posição"]
    temporadas = (2025, 2024, 2023, 2022)
    liga = st.selectbox("Escolha a Liga", options=ligas)
    temporada = st.selectbox("Escolha a Temporada", options=temporadas)
    posição = st.selectbox("Escolha a Posição", options=posições, index=None, placeholder="Atacante")

    if liga and temporada:
        if posição == "Goleiro":
            st.markdown("<h4 style='text-align: center;'>10 Goleiros Clássicos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_3 = pd.read_csv("1_Role_Goleiro.csv")
            tabela_3 = tabela_3[(tabela_3['Liga']==liga)&(tabela_3['Versão_Temporada']==temporada)]
            tabela_3 = tabela_3.iloc[:, np.r_[1, 30, 3, 7, 9:12, 15]]
            tabela_3 = tabela_3.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise', 'Interceptações.1':'Interceptações'})
            tabela_3 = tabela_3.sort_values(by='Rating', ascending=False)
            tabela_3["Idade"] = pd.to_numeric(tabela_3["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_3 = tabela_3.head(10)
            #st.dataframe(tabela_3, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_3).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>10 Goleiros Líberos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_4 = pd.read_csv("2_Role_Goleiro_Líbero.csv")
            tabela_4 = tabela_4[(tabela_4['Liga']==liga)&(tabela_4['Versão_Temporada']==temporada)]
            tabela_4 = tabela_4.iloc[:, np.r_[1, 33, 3, 7, 9:12, 15]]
            tabela_4 = tabela_4.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise', 'Interceptações.1':'Interceptações'})
            tabela_4 = tabela_4.sort_values(by='Rating', ascending=False)
            tabela_4["Idade"] = pd.to_numeric(tabela_4["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_4 = tabela_4.head(10)
            #st.dataframe(tabela_4, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_4).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



        elif posição == "Lateral":
            st.markdown("<h4 style='text-align: center;'>10 Laterais Defensivos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_3 = pd.read_csv("3_Role_Lateral_Defensivo.csv")
            tabela_3 = tabela_3[(tabela_3['Liga']==liga)&(tabela_3['Versão_Temporada']==temporada)]
            tabela_3 = tabela_3.iloc[:, np.r_[1, 28, 3, 7, 9:12, 15]]
            tabela_3 = tabela_3.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_3 = tabela_3.sort_values(by='Rating', ascending=False)
            tabela_3["Idade"] = pd.to_numeric(tabela_3["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_3 = tabela_3.head(10)
            #st.dataframe(tabela_3, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_3).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Laterais Ofensivos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_4 = pd.read_csv("4_Role_Lateral_Ofensivo.csv")
            tabela_4 = tabela_4[(tabela_4['Liga']==liga)&(tabela_4['Versão_Temporada']==temporada)]
            tabela_4 = tabela_4.iloc[:, np.r_[1, 33, 3, 7, 9:12, 15]]
            tabela_4 = tabela_4.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_4 = tabela_4.sort_values(by='Rating', ascending=False)
            tabela_4["Idade"] = pd.to_numeric(tabela_4["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_4 = tabela_4.head(10)
            #st.dataframe(tabela_4, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_4).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Laterais Equilibrados Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_5 = pd.read_csv("5_Role_Lateral_Equilibrado.csv")
            tabela_5 = tabela_5[(tabela_5['Liga']==liga)&(tabela_5['Versão_Temporada']==temporada)]
            tabela_5 = tabela_5.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_5 = tabela_5.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_5 = tabela_5.sort_values(by='Rating', ascending=False)
            tabela_5["Idade"] = pd.to_numeric(tabela_5["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_5 = tabela_5.head(10)
            #st.dataframe(tabela_5, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_5).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Zagueiro":
            st.markdown("<h4 style='text-align: center;'><br>10 Zagueiros Clássicos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_6 = pd.read_csv("6_Role_Zagueiro_Defensivo.csv")
            tabela_6 = tabela_6[(tabela_6['Liga']==liga)&(tabela_6['Versão_Temporada']==temporada)]
            tabela_6 = tabela_6.iloc[:, np.r_[1, 29, 3, 7, 9:12, 15]]
            tabela_6 = tabela_6.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_6 = tabela_6.sort_values(by='Rating', ascending=False)
            tabela_6 = tabela_6.head(10)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_6).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Zagueiros Construtores Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_7 = pd.read_csv("7_Role_Zagueiro_Construtor.csv")
            tabela_7 = tabela_7[(tabela_7['Liga']==liga)&(tabela_7['Versão_Temporada']==temporada)]
            tabela_7 = tabela_7.iloc[:, np.r_[1, 33, 3, 7, 9:12, 15]]
            tabela_7 = tabela_7.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_7 = tabela_7.sort_values(by='Rating', ascending=False)
            tabela_7 = tabela_7.head(10)
            #st.dataframe(tabela_7, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_7).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Zagueiros Equilibrados Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_8 = pd.read_csv("8_Role_Zagueiro_Equilibrado.csv")
            tabela_8 = tabela_8[(tabela_8['Liga']==liga)&(tabela_8['Versão_Temporada']==temporada)]
            tabela_8 = tabela_8.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_8 = tabela_8.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_8 = tabela_8.sort_values(by='Rating', ascending=False)
            tabela_8 = tabela_8.head(10)
            #st.dataframe(tabela_8, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_8).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


        elif posição == "Primeiro Volante":
            st.markdown("<h4 style='text-align: center;'>10 Primeiros Volantes Defensivos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_12 = pd.read_csv("9_Role_Volante_Defensivo.csv")
            tabela_12 = tabela_12[(tabela_12['Liga']==liga)&(tabela_12['Versão_Temporada']==temporada)]
            tabela_12 = tabela_12.iloc[:, np.r_[1, 27, 3, 7, 9:12, 15]]
            tabela_12 = tabela_12.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_12 = tabela_12.sort_values(by='Rating', ascending=False)
            tabela_12 = tabela_12.head(10)
            #st.dataframe(tabela_12, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_12).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Primeiros Volantes Construtores Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_13 = pd.read_csv("10_Role_Volante_Construtor.csv")
            tabela_13 = tabela_13[(tabela_13['Liga']==liga)&(tabela_13['Versão_Temporada']==temporada)]
            tabela_13 = tabela_13.iloc[:, np.r_[1, 32, 3, 7, 9:12, 15]]
            tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
            tabela_13["Idade"] = pd.to_numeric(tabela_13["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_13 = tabela_13.head(10)
            #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Primeiros Volantes Equilibrados Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_14 = pd.read_csv("11_Role_Volante_Equilibrado.csv")
            tabela_14 = tabela_14[(tabela_14['Liga']==liga)&(tabela_14['Versão_Temporada']==temporada)]
            tabela_14 = tabela_14.iloc[:, np.r_[1, 34, 3, 7, 9:12, 15]]
            tabela_14 = tabela_14.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_14 = tabela_14.sort_values(by='Rating', ascending=False)
            tabela_14["Idade"] = pd.to_numeric(tabela_14["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_14 = tabela_14.head(10)
            #st.dataframe(tabela_14, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_14).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Segundo Volante":
            st.markdown("<h4 style='text-align: center;'>10 Segundos Volantes Box-to-Box Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_12 = pd.read_csv("12_Role_Segundo_Volante_Box_to_Box.csv")
            tabela_12 = tabela_12[(tabela_12['Liga']==liga)&(tabela_12['Versão_Temporada']==temporada)]
            tabela_12 = tabela_12.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_12 = tabela_12.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_12 = tabela_12.sort_values(by='Rating', ascending=False)
            tabela_12["Idade"] = pd.to_numeric(tabela_12["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_12 = tabela_12.head(10)
            #st.dataframe(tabela_12, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_12).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Segundos Volantes Organizadores Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_13 = pd.read_csv("13_Role_Segundo_Volante_Organizador.csv")
            tabela_13 = tabela_13[(tabela_13['Liga']==liga)&(tabela_13['Versão_Temporada']==temporada)]
            tabela_13 = tabela_13.iloc[:, np.r_[1, 33, 3, 7, 9:12, 15]]
            tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
            tabela_13 = tabela_13.head(10)
            #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Segundos Volantes Equilibrados Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_14 = pd.read_csv("14_Role_Segundo_Volante_Equilibrado.csv")
            tabela_14 = tabela_14[(tabela_14['Liga']==liga)&(tabela_14['Versão_Temporada']==temporada)]
            tabela_14 = tabela_14.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_14 = tabela_14.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_14 = tabela_14.sort_values(by='Rating', ascending=False)
            tabela_14 = tabela_14.head(10)
            #st.dataframe(tabela_14, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_14).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Meia":
            st.markdown("<h4 style='text-align: center;'>10 Meias Organizadores Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_15 = pd.read_csv("15_Role_Meia_Organizador.csv")
            tabela_15 = tabela_15[(tabela_15['Liga']==liga)&(tabela_15['Versão_Temporada']==temporada)]
            tabela_15 = tabela_15.iloc[:, np.r_[1, 33, 3, 7, 9:12, 15]]
            tabela_15 = tabela_15.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_15 = tabela_15.sort_values(by='Rating', ascending=False)
            tabela_15 = tabela_15.head(10)
            #st.dataframe(tabela_15, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_15).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Meias Atacantes Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_16 = pd.read_csv("16_Role_Meia_Atacante.csv")
            tabela_16 = tabela_16[(tabela_16['Liga']==liga)&(tabela_16['Versão_Temporada']==temporada)]
            tabela_16 = tabela_16.iloc[:, np.r_[1, 40, 3, 7, 9:12, 15]]
            tabela_16 = tabela_16.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_16 = tabela_16.sort_values(by='Rating', ascending=False)
            tabela_16 = tabela_16.head(10)
            #st.dataframe(tabela_16, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_16).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Extremo":
            st.markdown("<h4 style='text-align: center;'>10 Extremos Organizadores Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_17 = pd.read_csv("17_Role_Extremo_Organizador.csv")
            tabela_17 = tabela_17[(tabela_17['Liga']==liga)&(tabela_17['Versão_Temporada']==temporada)]
            tabela_17 = tabela_17.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_17 = tabela_17.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_17 = tabela_17.sort_values(by='Rating', ascending=False)
            tabela_17["Idade"] = pd.to_numeric(tabela_17["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_17 = tabela_17.head(10)
            #st.dataframe(tabela_17, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_17).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Extremos Táticos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_18 = pd.read_csv("18_Role_Extremo_Tático.csv")
            tabela_18 = tabela_18[(tabela_18['Liga']==liga)&(tabela_18['Versão_Temporada']==temporada)]
            tabela_18 = tabela_18.iloc[:, np.r_[1, 30, 3, 7, 9:12, 15]]
            tabela_18 = tabela_18.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_18 = tabela_18.sort_values(by='Rating', ascending=False)
            tabela_18["Idade"] = pd.to_numeric(tabela_18["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_18 = tabela_18.head(10)
            #st.dataframe(tabela_18, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_18).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Extremos Agudos Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_19 = pd.read_csv("19_Role_Extremo_Agudo.csv")
            tabela_19 = tabela_19[(tabela_19['Liga']==liga)&(tabela_19['Versão_Temporada']==temporada)]
            tabela_19 = tabela_19.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_19 = tabela_19.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_19 = tabela_19.sort_values(by='Rating', ascending=False)
            tabela_19["Idade"] = pd.to_numeric(tabela_19["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_19 = tabela_19.head(10)
            #st.dataframe(tabela_19, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_19).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        else:
            st.markdown("<h4 style='text-align: center;'>10 Atacantes Referências Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_17 = pd.read_csv("20_Role_Atacante_Referência.csv")
            tabela_17 = tabela_17[(tabela_17['Liga']==liga)&(tabela_17['Versão_Temporada']==temporada)]
            tabela_17 = tabela_17.iloc[:, np.r_[1, 33, 3, 7, 9:12, 15]]
            tabela_17 = tabela_17.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_17 = tabela_17.sort_values(by='Rating', ascending=False)
            tabela_17["Idade"] = pd.to_numeric(tabela_17["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_17 = tabela_17.head(10)
            #st.dataframe(tabela_17, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_17).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Atacantes Móveis Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_18 = pd.read_csv("21_Role_Atacante_Móvel.csv")
            tabela_18 = tabela_18[(tabela_18['Liga']==liga)&(tabela_18['Versão_Temporada']==temporada)]
            tabela_18 = tabela_18.iloc[:, np.r_[1, 32, 3, 7, 9:12, 15]]
            tabela_18 = tabela_18.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_18 = tabela_18.sort_values(by='Rating', ascending=False)
            tabela_18["Idade"] = pd.to_numeric(tabela_18["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_18 = tabela_18.head(10)
            #st.dataframe(tabela_18, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_18).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>10 Segundos Atacantes Mais Bem Ranqueados<br></b></h4>", unsafe_allow_html=True)
            tabela_19 = pd.read_csv("22_Role_Segundo_Atacante.csv")
            tabela_19 = tabela_19[(tabela_19['Liga']==liga)&(tabela_19['Versão_Temporada']==temporada)]
            tabela_19 = tabela_19.iloc[:, np.r_[1, 36, 3, 7, 9:12, 15]]
            tabela_19 = tabela_19.rename(columns={'Equipe_Janela_Análise':'Equipe'})
            tabela_19 = tabela_19.sort_values(by='Rating', ascending=False)
            tabela_19["Idade"] = pd.to_numeric(tabela_19["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_19 = tabela_19.head(10)
            #st.dataframe(tabela_19, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_19).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

###############################################################################################################################
###############################################################################################################################
###############################################################################################################################
###############################################################################################################################

if st.session_state.selected_option == "Nacionais pelo Mundo":
    st.markdown("<h2 style='text-align: center;'>Nacionais pelo Mundo</h2>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center;'>2025</h3>", unsafe_allow_html=True)
    nacionalidades = df8["Nacionalidade"]
    posições = df6["Posição"]
    temporadas = df7["Versão_Temporada"]
    mundo_options = ['BRA1', 'ARG1', 'ENG1', 'ENG2', 'FRA1', 'FRA2', 'SPA1', 'SPA2', 'ITA1', 'ITA2', 'GER1', 'GER2', 'POR1', 'POR2', 'SWZ', 'CZH', 'CRO', 'SER', 'RUS', 'UKR', 'BEL1', 'BEL2', 'CHN',
             'DEN', 'GRE', 'HOL', 'JAP', 'MEX', 'SAUD', 'SCT', 'TUR', 'UAE', 'USA', 'BUL', 'AUT', 'QAT']
    nacionalidade = st.selectbox("Escolha a Nacionalidade do Atleta", options=nacionalidades)
    posição = st.selectbox("Escolha a Posição do Atleta", options=posições)
    temporada = 2025
    
    if nacionalidade and temporada:
        if posição == "Goleiro":
            st.markdown("<h4 style='text-align: center;'>Nacionais Mais Bem Ranqueados<br><br>Goleiros Clássicos</b></h4>", unsafe_allow_html=True)
            tabela_5 = pd.read_csv("1_Role_Goleiro_Full.csv")
            tabela_5 = tabela_5[(tabela_5['Nacionalidade']==nacionalidade)&(tabela_5['Versão_Temporada']==temporada)]
            tabela_5 = tabela_5.iloc[:, np.r_[1, 25, 30, 3, 4, 7, 9:12, 15]]
            tabela_5 = tabela_5.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise', 'Interceptações.1':'Interceptações'})
            tabela_5 = tabela_5[(tabela_5['Liga'] == 'ENG1') | (tabela_5['Liga'] == 'ENG2') | (tabela_5['Liga'] == 'FRA1') | (tabela_5['Liga'] == 'FRA2') 
                                | (tabela_5['Liga'] == 'SPA1') | (tabela_5['Liga'] == 'ITA1') | (tabela_5['Liga'] == 'GER1') | (tabela_5['Liga'] == 'POR1') 
                                | (tabela_5['Liga'] == 'SWZ') | (tabela_5['Liga'] == 'RUS') | (tabela_5['Liga'] == 'UKR') | (tabela_5['Liga'] == 'BEL1') 
                                | (tabela_5['Liga'] == 'CHN') | (tabela_5['Liga'] == 'DEN') | (tabela_5['Liga'] == 'GRE') | (tabela_5['Liga'] == 'HOL') 
                                | (tabela_5['Liga'] == 'JAP') | (tabela_5['Liga'] == 'MEX') | (tabela_5['Liga'] == 'SAUD') | (tabela_5['Liga'] == 'TUR') 
                                | (tabela_5['Liga'] == 'UAE') | (tabela_5['Liga'] == 'USA') | (tabela_5['Liga'] == 'ITA2') | (tabela_5['Liga'] == 'GER2') 
                                | (tabela_5['Liga'] == 'POR2') | (tabela_5['Liga'] == 'BUL') | (tabela_5['Liga'] == 'AUT') | (tabela_5['Liga'] == 'QAT')
                                | (tabela_5['Liga'] == 'CRO') | (tabela_5['Liga'] == 'CZH') | (tabela_5['Liga'] == 'NOR') | (tabela_5['Liga'] == 'POL')
                                | (tabela_5['Liga'] == 'SCT') | (tabela_5['Liga'] == 'SER') | (tabela_5['Liga'] == 'SPA2')]
            tabela_5 = tabela_5.sort_values(by='Rating', ascending=False)
            tabela_5 = tabela_5.head(50)
            #st.dataframe(tabela_5, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_5).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Goleiros Líberos</b></h4>", unsafe_allow_html=True)
            tabela_6 = pd.read_csv("2_Role_Goleiro_Líbero_Full.csv")
            tabela_6 = tabela_6[(tabela_6['Nacionalidade']==nacionalidade)&(tabela_6['Versão_Temporada']==temporada)]
            tabela_6 = tabela_6.iloc[:, np.r_[1, 28, 33, 3, 4, 7, 9:12, 15]]
            tabela_6 = tabela_6.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise', 'Interceptações.1':'Interceptações'})
            tabela_6 = tabela_6[(tabela_6['Liga'] == 'ENG1') | (tabela_6['Liga'] == 'ENG2') | (tabela_6['Liga'] == 'FRA1') | (tabela_6['Liga'] == 'FRA2') 
                                | (tabela_6['Liga'] == 'SPA1') | (tabela_6['Liga'] == 'ITA1') | (tabela_6['Liga'] == 'GER1') | (tabela_6['Liga'] == 'POR1') 
                                | (tabela_6['Liga'] == 'SWZ') | (tabela_6['Liga'] == 'RUS') | (tabela_6['Liga'] == 'UKR') | (tabela_6['Liga'] == 'BEL1') 
                                | (tabela_6['Liga'] == 'CHN') | (tabela_6['Liga'] == 'DEN') | (tabela_6['Liga'] == 'GRE') | (tabela_6['Liga'] == 'HOL') 
                                | (tabela_6['Liga'] == 'JAP') | (tabela_6['Liga'] == 'MEX') | (tabela_6['Liga'] == 'SAUD') | (tabela_6['Liga'] == 'TUR') 
                                | (tabela_6['Liga'] == 'UAE') | (tabela_6['Liga'] == 'USA') | (tabela_6['Liga'] == 'ITA2') | (tabela_6['Liga'] == 'GER2') 
                                | (tabela_6['Liga'] == 'POR2') | (tabela_6['Liga'] == 'BUL') | (tabela_6['Liga'] == 'AUT') | (tabela_6['Liga'] == 'QAT')
                                | (tabela_6['Liga'] == 'CRO') | (tabela_6['Liga'] == 'CZH') | (tabela_6['Liga'] == 'NOR') | (tabela_6['Liga'] == 'POL')
                                | (tabela_6['Liga'] == 'SCT') | (tabela_6['Liga'] == 'SER') | (tabela_6['Liga'] == 'SPA2')]
            tabela_6 = tabela_6.sort_values(by='Rating', ascending=False)
            tabela_6 = tabela_6.head(50)
            #st.dataframe(tabela_6, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_6).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


        elif posição == "Lateral":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Laterais Defensivos</b></h4>", unsafe_allow_html=True)
            tabela_5 = pd.read_csv("3_Role_Lateral_Defensivo_Full.csv")
            tabela_5 = tabela_5[(tabela_5['Nacionalidade']==nacionalidade)&(tabela_5['Versão_Temporada']==temporada)]
            tabela_5 = tabela_5.iloc[:, np.r_[1, 23, 28, 3, 7, 9:12, 15]]
            tabela_5 = tabela_5.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_5 = tabela_5[(tabela_5['Liga'] == 'ENG1') | (tabela_5['Liga'] == 'ENG2') | (tabela_5['Liga'] == 'FRA1') | (tabela_5['Liga'] == 'FRA2') 
                                | (tabela_5['Liga'] == 'SPA1') | (tabela_5['Liga'] == 'ITA1') | (tabela_5['Liga'] == 'GER1') | (tabela_5['Liga'] == 'POR1') 
                                | (tabela_5['Liga'] == 'SWZ') | (tabela_5['Liga'] == 'RUS') | (tabela_5['Liga'] == 'UKR') | (tabela_5['Liga'] == 'BEL1') 
                                | (tabela_5['Liga'] == 'CHN') | (tabela_5['Liga'] == 'DEN') | (tabela_5['Liga'] == 'GRE') | (tabela_5['Liga'] == 'HOL') 
                                | (tabela_5['Liga'] == 'JAP') | (tabela_5['Liga'] == 'MEX') | (tabela_5['Liga'] == 'SAUD') | (tabela_5['Liga'] == 'TUR') 
                                | (tabela_5['Liga'] == 'UAE') | (tabela_5['Liga'] == 'USA') | (tabela_5['Liga'] == 'ITA2') | (tabela_5['Liga'] == 'GER2') 
                                | (tabela_5['Liga'] == 'POR2') | (tabela_5['Liga'] == 'BUL') | (tabela_5['Liga'] == 'AUT') | (tabela_5['Liga'] == 'QAT')
                                | (tabela_5['Liga'] == 'CRO') | (tabela_5['Liga'] == 'CZH') | (tabela_5['Liga'] == 'NOR') | (tabela_5['Liga'] == 'POL')
                                | (tabela_5['Liga'] == 'SCT') | (tabela_5['Liga'] == 'SER') | (tabela_5['Liga'] == 'SPA2')]
            tabela_5 = tabela_5.sort_values(by='Rating', ascending=False)
            tabela_5["Idade"] = pd.to_numeric(tabela_5["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_5 = tabela_5.head(50)
            #st.dataframe(tabela_5, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_5).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Laterais Ofensivos</b></h4>", unsafe_allow_html=True)
            tabela_6 = pd.read_csv("4_Role_Lateral_Ofensivo_Full.csv")
            tabela_6 = tabela_6[(tabela_6['Nacionalidade']==nacionalidade)&(tabela_6['Versão_Temporada']==temporada)]
            tabela_6 = tabela_6.iloc[:, np.r_[1, 28, 33, 3, 7, 9:12, 15]]
            tabela_6 = tabela_6.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_6 = tabela_6[(tabela_6['Liga'] == 'ENG1') | (tabela_6['Liga'] == 'ENG2') | (tabela_6['Liga'] == 'FRA1') | (tabela_6['Liga'] == 'FRA2') 
                                | (tabela_6['Liga'] == 'SPA1') | (tabela_6['Liga'] == 'ITA1') | (tabela_6['Liga'] == 'GER1') | (tabela_6['Liga'] == 'POR1') 
                                | (tabela_6['Liga'] == 'SWZ') | (tabela_6['Liga'] == 'RUS') | (tabela_6['Liga'] == 'UKR') | (tabela_6['Liga'] == 'BEL1') 
                                | (tabela_6['Liga'] == 'CHN') | (tabela_6['Liga'] == 'DEN') | (tabela_6['Liga'] == 'GRE') | (tabela_6['Liga'] == 'HOL') 
                                | (tabela_6['Liga'] == 'JAP') | (tabela_6['Liga'] == 'MEX') | (tabela_6['Liga'] == 'SAUD') | (tabela_6['Liga'] == 'TUR') 
                                | (tabela_6['Liga'] == 'UAE') | (tabela_6['Liga'] == 'USA') | (tabela_6['Liga'] == 'ITA2') | (tabela_6['Liga'] == 'GER2') 
                                | (tabela_6['Liga'] == 'POR2') | (tabela_6['Liga'] == 'BUL') | (tabela_6['Liga'] == 'AUT') | (tabela_6['Liga'] == 'QAT')
                                | (tabela_6['Liga'] == 'CRO') | (tabela_6['Liga'] == 'CZH') | (tabela_6['Liga'] == 'NOR') | (tabela_6['Liga'] == 'POL')
                                | (tabela_6['Liga'] == 'SCT') | (tabela_6['Liga'] == 'SER') | (tabela_6['Liga'] == 'SPA2')]
            tabela_6 = tabela_6.sort_values(by='Rating', ascending=False)
            tabela_6["Idade"] = pd.to_numeric(tabela_6["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_6 = tabela_6.head(50)
            #st.dataframe(tabela_6, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_6).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Laterais Equilibrados</b></h4>", unsafe_allow_html=True)
            tabela_7 = pd.read_csv("5_Role_Lateral_Equilibrado_Full.csv")
            tabela_7 = tabela_7[(tabela_7['Nacionalidade']==nacionalidade)&(tabela_7['Versão_Temporada']==temporada)]
            tabela_7 = tabela_7.iloc[:, np.r_[1, 31, 36, 3, 7, 9:12, 15]]
            tabela_7 = tabela_7.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_7 = tabela_7[(tabela_7['Liga'] == 'ENG1') | (tabela_7['Liga'] == 'ENG2') | (tabela_7['Liga'] == 'FRA1') | (tabela_7['Liga'] == 'FRA2') 
                                | (tabela_7['Liga'] == 'SPA1') | (tabela_7['Liga'] == 'ITA1') | (tabela_7['Liga'] == 'GER1') | (tabela_7['Liga'] == 'POR1') 
                                | (tabela_7['Liga'] == 'SWZ') | (tabela_7['Liga'] == 'RUS') | (tabela_7['Liga'] == 'UKR') | (tabela_7['Liga'] == 'BEL1') 
                                | (tabela_7['Liga'] == 'CHN') | (tabela_7['Liga'] == 'DEN') | (tabela_7['Liga'] == 'GRE') | (tabela_7['Liga'] == 'HOL') 
                                | (tabela_7['Liga'] == 'JAP') | (tabela_7['Liga'] == 'MEX') | (tabela_7['Liga'] == 'SAUD') | (tabela_7['Liga'] == 'TUR') 
                                | (tabela_7['Liga'] == 'UAE') | (tabela_7['Liga'] == 'USA') | (tabela_7['Liga'] == 'ITA2') | (tabela_7['Liga'] == 'GER2') 
                                | (tabela_7['Liga'] == 'POR2') | (tabela_7['Liga'] == 'BUL') | (tabela_7['Liga'] == 'AUT') | (tabela_7['Liga'] == 'QAT')
                                | (tabela_7['Liga'] == 'CRO') | (tabela_7['Liga'] == 'CZH') | (tabela_7['Liga'] == 'NOR') | (tabela_7['Liga'] == 'POL')
                                | (tabela_7['Liga'] == 'SCT') | (tabela_7['Liga'] == 'SER') | (tabela_7['Liga'] == 'SPA2')]
            tabela_7 = tabela_7.sort_values(by='Rating', ascending=False)
            tabela_7["Idade"] = pd.to_numeric(tabela_7["Idade"], errors='coerce').fillna(0).astype(int)
            tabela_7 = tabela_7.head(50)
            #st.dataframe(tabela_7, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_7).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Zagueiro":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Zagueiros Clássicos</b></h4>", unsafe_allow_html=True)
            tabela_8 = pd.read_csv("6_Role_Zagueiro_Defensivo_Full.csv")
            tabela_8 = tabela_8[(tabela_8['Nacionalidade']==nacionalidade)&(tabela_8['Versão_Temporada']==temporada)]
            tabela_8 = tabela_8.iloc[:, np.r_[1, 24, 29, 3, 4, 7, 9:12, 15]]
            tabela_8 = tabela_8.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_8 = tabela_8[(tabela_8['Liga'] == 'ENG1') | (tabela_8['Liga'] == 'ENG2') | (tabela_8['Liga'] == 'FRA1') | (tabela_8['Liga'] == 'FRA2') 
                                | (tabela_8['Liga'] == 'SPA1') | (tabela_8['Liga'] == 'ITA1') | (tabela_8['Liga'] == 'GER1') | (tabela_8['Liga'] == 'POR1') 
                                | (tabela_8['Liga'] == 'SWZ') | (tabela_8['Liga'] == 'RUS') | (tabela_8['Liga'] == 'UKR') | (tabela_8['Liga'] == 'BEL1') 
                                | (tabela_8['Liga'] == 'CHN') | (tabela_8['Liga'] == 'DEN') | (tabela_8['Liga'] == 'GRE') | (tabela_8['Liga'] == 'HOL') 
                                | (tabela_8['Liga'] == 'JAP') | (tabela_8['Liga'] == 'MEX') | (tabela_8['Liga'] == 'SAUD') | (tabela_8['Liga'] == 'TUR') 
                                | (tabela_8['Liga'] == 'UAE') | (tabela_8['Liga'] == 'USA') | (tabela_8['Liga'] == 'ITA2') | (tabela_8['Liga'] == 'GER2') 
                                | (tabela_8['Liga'] == 'POR2') | (tabela_8['Liga'] == 'BUL') | (tabela_8['Liga'] == 'AUT') | (tabela_8['Liga'] == 'QAT')
                                | (tabela_8['Liga'] == 'CRO') | (tabela_8['Liga'] == 'CZH') | (tabela_8['Liga'] == 'NOR') | (tabela_8['Liga'] == 'POL')
                                | (tabela_8['Liga'] == 'SCT') | (tabela_8['Liga'] == 'SER') | (tabela_8['Liga'] == 'SPA2')]
            tabela_8 = tabela_8.sort_values(by='Rating', ascending=False)
            tabela_8 = tabela_8.head(50)
            #st.dataframe(tabela_8, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_8).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Zagueiros Construtores</b></h4>", unsafe_allow_html=True)
            tabela_9 = pd.read_csv("7_Role_Zagueiro_Construtor_Full.csv")
            tabela_9 = tabela_9[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Versão_Temporada']==temporada)]
            tabela_9 = tabela_9.iloc[:, np.r_[1, 28, 33, 3, 4, 7, 9:12, 15]]
            tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_9 = tabela_9[(tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') 
                                | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'POR1') 
                                | (tabela_9['Liga'] == 'SWZ') | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'UKR') | (tabela_9['Liga'] == 'BEL1') 
                                | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
                                | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'TUR') 
                                | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'ITA2') | (tabela_9['Liga'] == 'GER2') 
                                | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'AUT') | (tabela_9['Liga'] == 'QAT')
                                | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH') | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'POL')
                                | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') | (tabela_9['Liga'] == 'SPA2')]
            tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
            tabela_9 = tabela_9.head(50)
            #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Zagueiros Equilibrados</b></h4>", unsafe_allow_html=True)
            tabela_10 = pd.read_csv("8_Role_Zagueiro_Equilibrado_Full.csv")
            tabela_10 = tabela_10[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Versão_Temporada']==temporada)]
            tabela_10 = tabela_10.iloc[:, np.r_[1, 31, 36, 3, 4, 7, 9:12, 15]]
            tabela_10 = tabela_10.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_10 = tabela_10[(tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') 
                                | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'POR1') 
                                | (tabela_10['Liga'] == 'SWZ') | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'UKR') | (tabela_10['Liga'] == 'BEL1') 
                                | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
                                | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'TUR') 
                                | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'ITA2') | (tabela_10['Liga'] == 'GER2') 
                                | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'AUT') | (tabela_10['Liga'] == 'QAT')
                                | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH') | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'POL')
                                | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') | (tabela_10['Liga'] == 'SPA2')]
            tabela_10 = tabela_10.sort_values(by='Rating', ascending=False)
            tabela_10 = tabela_10.head(50)
            #st.dataframe(tabela_10, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_10).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Primeiro Volante":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Primeiros Volantes Defensivos</b></h4>", unsafe_allow_html=True)
            tabela_11 = pd.read_csv("9_Role_Volante_Defensivo_Full.csv")
            tabela_11 = tabela_11[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Versão_Temporada']==temporada)]
            tabela_11 = tabela_11.iloc[:, np.r_[1, 22, 27, 3, 4, 7, 9:12, 15]]
            tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_11 = tabela_11[(tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') 
                                | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'POR1') 
                                | (tabela_11['Liga'] == 'SWZ') | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'UKR') | (tabela_11['Liga'] == 'BEL1') 
                                | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
                                | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'TUR') 
                                | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'ITA2') | (tabela_11['Liga'] == 'GER2') 
                                | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'AUT') | (tabela_11['Liga'] == 'QAT')
                                | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH') | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'POL')
                                | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') | (tabela_11['Liga'] == 'SPA2')]
            tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
            tabela_11 = tabela_11.head(50)
            #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Primeiros Volantes Construtores</b></h4>", unsafe_allow_html=True)
            tabela_12 = pd.read_csv("10_Role_Volante_Construtor_Full.csv")
            tabela_12 = tabela_12[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Versão_Temporada']==temporada)]
            tabela_12 = tabela_12.iloc[:, np.r_[1, 27, 32, 3, 4, 7, 9:12, 15]]
            tabela_12 = tabela_12.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_12 = tabela_12[(tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') 
                                | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'POR1') 
                                | (tabela_12['Liga'] == 'SWZ') | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'UKR') | (tabela_12['Liga'] == 'BEL1') 
                                | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
                                | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'TUR') 
                                | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'ITA2') | (tabela_12['Liga'] == 'GER2') 
                                | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'AUT') | (tabela_12['Liga'] == 'QAT')
                                | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH') | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'POL')
                                | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') | (tabela_12['Liga'] == 'SPA2')]
            tabela_12 = tabela_12.sort_values(by='Rating', ascending=False)
            tabela_12 = tabela_12.head(50)
            #st.dataframe(tabela_12, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_12).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Primeiros Volantes Equilibrados</b></h4>", unsafe_allow_html=True)
            tabela_13 = pd.read_csv("11_Role_Volante_Equilibrado_Full.csv")
            tabela_13 = tabela_13[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Versão_Temporada']==temporada)]
            tabela_13 = tabela_13.iloc[:, np.r_[1, 29, 34, 3, 4, 7, 9:12, 15]]
            tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_13 = tabela_13[(tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') 
                                | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'POR1') 
                                | (tabela_13['Liga'] == 'SWZ') | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'UKR') | (tabela_13['Liga'] == 'BEL1') 
                                | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
                                | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'TUR') 
                                | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'ITA2') | (tabela_13['Liga'] == 'GER2') 
                                | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'AUT') | (tabela_13['Liga'] == 'QAT')
                                | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH') | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'POL')
                                | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') | (tabela_13['Liga'] == 'SPA2')]
            tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
            tabela_13 = tabela_13.head(50)
            #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Segundo Volante":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Segundos Volantes Box-to-Box</b></h4>", unsafe_allow_html=True)
            tabela_11 = pd.read_csv("12_Role_Segundo_Volante_Box_to_Box_Full.csv")
            tabela_11 = tabela_11[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Versão_Temporada']==temporada)]
            tabela_11 = tabela_11.iloc[:, np.r_[1, 31, 36, 3, 4, 7, 9:12, 15]]
            tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_11 = tabela_11[(tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') 
                                | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'POR1') 
                                | (tabela_11['Liga'] == 'SWZ') | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'UKR') | (tabela_11['Liga'] == 'BEL1') 
                                | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
                                | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'TUR') 
                                | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'ITA2') | (tabela_11['Liga'] == 'GER2') 
                                | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'AUT') | (tabela_11['Liga'] == 'QAT')
                                | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH') | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'POL')
                                | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') | (tabela_11['Liga'] == 'SPA2')]
            tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
            tabela_11 = tabela_11.head(50)
            #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Segundos Volantes Organizadores</b></h4>", unsafe_allow_html=True)
            tabela_12 = pd.read_csv("13_Role_Segundo_Volante_Organizador_Full.csv")
            tabela_12 = tabela_12[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Versão_Temporada']==temporada)]
            tabela_12 = tabela_12.iloc[:, np.r_[1, 28, 33, 3, 4, 7, 9:12, 15]]
            tabela_12 = tabela_12.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_12 = tabela_12[(tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') 
                                | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'POR1') 
                                | (tabela_12['Liga'] == 'SWZ') | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'UKR') | (tabela_12['Liga'] == 'BEL1') 
                                | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
                                | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'TUR') 
                                | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'ITA2') | (tabela_12['Liga'] == 'GER2') 
                                | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'AUT') | (tabela_12['Liga'] == 'QAT')
                                | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH') | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'POL')
                                | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') | (tabela_12['Liga'] == 'SPA2')]
            tabela_12 = tabela_12.sort_values(by='Rating', ascending=False)
            tabela_12 = tabela_12.head(50)
            #st.dataframe(tabela_12, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_12).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Segundos Volantes Equilibrados</b></h4>", unsafe_allow_html=True)
            tabela_13 = pd.read_csv("14_Role_Segundo_Volante_Equilibrado_Full.csv")
            tabela_13 = tabela_13[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Versão_Temporada']==temporada)]
            tabela_13 = tabela_13.iloc[:, np.r_[1, 31, 36, 3, 4, 7, 9:12, 15]]
            tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_13 = tabela_13[(tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') 
                                | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'POR1') 
                                | (tabela_13['Liga'] == 'SWZ') | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'UKR') | (tabela_13['Liga'] == 'BEL1') 
                                | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
                                | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'TUR') 
                                | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'ITA2') | (tabela_13['Liga'] == 'GER2') 
                                | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'AUT') | (tabela_13['Liga'] == 'QAT')
                                | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH') | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'POL')
                                | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') | (tabela_13['Liga'] == 'SPA2')]
            tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
            tabela_13 = tabela_13.head(50)
            #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


        elif posição == "Meia":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Meias Organizadores </b></h4>", unsafe_allow_html=True)
            tabela_14 = pd.read_csv("15_Role_Meia_Organizador_Full.csv")
            tabela_14 = tabela_14[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Versão_Temporada']==temporada)]
            tabela_14 = tabela_14.iloc[:, np.r_[1, 28, 33, 3, 4, 7, 9:12, 15]]
            tabela_14 = tabela_14.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_14 = tabela_14[(tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') 
                                | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'POR1') 
                                | (tabela_14['Liga'] == 'SWZ') | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'UKR') | (tabela_14['Liga'] == 'BEL1') 
                                | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
                                | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'TUR') 
                                | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'ITA2') | (tabela_14['Liga'] == 'GER2') 
                                | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'AUT') | (tabela_14['Liga'] == 'QAT')
                                | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH') | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'POL')
                                | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') | (tabela_14['Liga'] == 'SPA2')]
            tabela_14 = tabela_14.sort_values(by='Rating', ascending=False)
            tabela_14 = tabela_14.head(50)
            #st.dataframe(tabela_14, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_14).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Meias Atacantes</b></h4>", unsafe_allow_html=True)
            tabela_15 = pd.read_csv("16_Role_Meia_Atacante_Full.csv")
            tabela_15 = tabela_15[(tabela_15['Nacionalidade']==nacionalidade)&(tabela_15['Versão_Temporada']==temporada)]
            tabela_15 = tabela_15.iloc[:, np.r_[1, 35, 40, 3, 4, 7, 9:12, 15]]
            tabela_15 = tabela_15.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_15 = tabela_15[(tabela_15['Liga'] == 'ENG1') | (tabela_15['Liga'] == 'ENG2') | (tabela_15['Liga'] == 'FRA1') | (tabela_15['Liga'] == 'FRA2') 
                                | (tabela_15['Liga'] == 'SPA1') | (tabela_15['Liga'] == 'ITA1') | (tabela_15['Liga'] == 'GER1') | (tabela_15['Liga'] == 'POR1') 
                                | (tabela_15['Liga'] == 'SWZ') | (tabela_15['Liga'] == 'RUS') | (tabela_15['Liga'] == 'UKR') | (tabela_15['Liga'] == 'BEL1') 
                                | (tabela_15['Liga'] == 'CHN') | (tabela_15['Liga'] == 'DEN') | (tabela_15['Liga'] == 'GRE') | (tabela_15['Liga'] == 'HOL') 
                                | (tabela_15['Liga'] == 'JAP') | (tabela_15['Liga'] == 'MEX') | (tabela_15['Liga'] == 'SAUD') | (tabela_15['Liga'] == 'TUR') 
                                | (tabela_15['Liga'] == 'UAE') | (tabela_15['Liga'] == 'USA') | (tabela_15['Liga'] == 'ITA2') | (tabela_15['Liga'] == 'GER2') 
                                | (tabela_15['Liga'] == 'POR2') | (tabela_15['Liga'] == 'BUL') | (tabela_15['Liga'] == 'AUT') | (tabela_15['Liga'] == 'QAT')
                                | (tabela_15['Liga'] == 'CRO') | (tabela_15['Liga'] == 'CZH') | (tabela_15['Liga'] == 'NOR') | (tabela_15['Liga'] == 'POL')
                                | (tabela_15['Liga'] == 'SCT') | (tabela_15['Liga'] == 'SER') | (tabela_15['Liga'] == 'SPA2')]
            tabela_15 = tabela_15.sort_values(by='Rating', ascending=False)
            tabela_15 = tabela_15.head(50)
            #st.dataframe(tabela_15, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_15).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Extremo":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Extremos Organizadores</b></h4>", unsafe_allow_html=True)
            tabela_16 = pd.read_csv("17_Role_Extremo_Organizador_Full.csv")
            tabela_16 = tabela_16[(tabela_16['Nacionalidade']==nacionalidade)&(tabela_16['Versão_Temporada']==temporada)]
            tabela_16 = tabela_16.iloc[:, np.r_[1, 31, 36, 3, 4, 7, 9:12, 15]]
            tabela_16 = tabela_16.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_16 = tabela_16[(tabela_16['Liga'] == 'ENG1') | (tabela_16['Liga'] == 'ENG2') | (tabela_16['Liga'] == 'FRA1') | (tabela_16['Liga'] == 'FRA2') 
                                | (tabela_16['Liga'] == 'SPA1') | (tabela_16['Liga'] == 'ITA1') | (tabela_16['Liga'] == 'GER1') | (tabela_16['Liga'] == 'POR1') 
                                | (tabela_16['Liga'] == 'SWZ') | (tabela_16['Liga'] == 'RUS') | (tabela_16['Liga'] == 'UKR') | (tabela_16['Liga'] == 'BEL1') 
                                | (tabela_16['Liga'] == 'CHN') | (tabela_16['Liga'] == 'DEN') | (tabela_16['Liga'] == 'GRE') | (tabela_16['Liga'] == 'HOL') 
                                | (tabela_16['Liga'] == 'JAP') | (tabela_16['Liga'] == 'MEX') | (tabela_16['Liga'] == 'SAUD') | (tabela_16['Liga'] == 'TUR') 
                                | (tabela_16['Liga'] == 'UAE') | (tabela_16['Liga'] == 'USA') | (tabela_16['Liga'] == 'ITA2') | (tabela_16['Liga'] == 'GER2') 
                                | (tabela_16['Liga'] == 'POR2') | (tabela_16['Liga'] == 'BUL') | (tabela_16['Liga'] == 'AUT') | (tabela_16['Liga'] == 'QAT')
                                | (tabela_16['Liga'] == 'CRO') | (tabela_16['Liga'] == 'CZH') | (tabela_16['Liga'] == 'NOR') | (tabela_16['Liga'] == 'POL')
                                | (tabela_16['Liga'] == 'SCT') | (tabela_16['Liga'] == 'SER') | (tabela_16['Liga'] == 'SPA2')]
            tabela_16 = tabela_16.sort_values(by='Rating', ascending=False)
            tabela_16 = tabela_16.head(50)
            #st.dataframe(tabela_16, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_16).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Extremos Táticos</b></h4>", unsafe_allow_html=True)
            tabela_17 = pd.read_csv("18_Role_Extremo_Tático_Full.csv")
            tabela_17 = tabela_17[(tabela_17['Nacionalidade']==nacionalidade)&(tabela_17['Versão_Temporada']==temporada)]
            tabela_17 = tabela_17.iloc[:, np.r_[1, 25, 30, 3, 4, 7, 9:12, 15]]
            tabela_17 = tabela_17.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_17 = tabela_17[(tabela_17['Liga'] == 'ENG1') | (tabela_17['Liga'] == 'ENG2') | (tabela_17['Liga'] == 'FRA1') | (tabela_17['Liga'] == 'FRA2') 
                                | (tabela_17['Liga'] == 'SPA1') | (tabela_17['Liga'] == 'ITA1') | (tabela_17['Liga'] == 'GER1') | (tabela_17['Liga'] == 'POR1') 
                                | (tabela_17['Liga'] == 'SWZ') | (tabela_17['Liga'] == 'RUS') | (tabela_17['Liga'] == 'UKR') | (tabela_17['Liga'] == 'BEL1') 
                                | (tabela_17['Liga'] == 'CHN') | (tabela_17['Liga'] == 'DEN') | (tabela_17['Liga'] == 'GRE') | (tabela_17['Liga'] == 'HOL') 
                                | (tabela_17['Liga'] == 'JAP') | (tabela_17['Liga'] == 'MEX') | (tabela_17['Liga'] == 'SAUD') | (tabela_17['Liga'] == 'TUR') 
                                | (tabela_17['Liga'] == 'UAE') | (tabela_17['Liga'] == 'USA') | (tabela_17['Liga'] == 'ITA2') | (tabela_17['Liga'] == 'GER2') 
                                | (tabela_17['Liga'] == 'POR2') | (tabela_17['Liga'] == 'BUL') | (tabela_17['Liga'] == 'AUT') | (tabela_17['Liga'] == 'QAT')
                                | (tabela_17['Liga'] == 'CRO') | (tabela_17['Liga'] == 'CZH') | (tabela_17['Liga'] == 'NOR') | (tabela_17['Liga'] == 'POL')
                                | (tabela_17['Liga'] == 'SCT') | (tabela_17['Liga'] == 'SER') | (tabela_17['Liga'] == 'SPA2')]
            tabela_17 = tabela_17.sort_values(by='Rating', ascending=False)
            tabela_17 = tabela_17.head(50)
            #st.dataframe(tabela_17, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_17).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Extremos Agudos</b></h4>", unsafe_allow_html=True)
            tabela_18 = pd.read_csv("19_Role_Extremo_Agudo_Full.csv")
            tabela_18 = tabela_18[(tabela_18['Nacionalidade']==nacionalidade)&(tabela_18['Versão_Temporada']==temporada)]
            tabela_18 = tabela_18.iloc[:, np.r_[1, 31, 36, 3, 4, 7, 9:12, 15]]
            tabela_18 = tabela_18.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_18 = tabela_18[(tabela_18['Liga'] == 'ENG1') | (tabela_18['Liga'] == 'ENG2') | (tabela_18['Liga'] == 'FRA1') | (tabela_18['Liga'] == 'FRA2') 
                                | (tabela_18['Liga'] == 'SPA1') | (tabela_18['Liga'] == 'ITA1') | (tabela_18['Liga'] == 'GER1') | (tabela_18['Liga'] == 'POR1') 
                                | (tabela_18['Liga'] == 'SWZ') | (tabela_18['Liga'] == 'RUS') | (tabela_18['Liga'] == 'UKR') | (tabela_18['Liga'] == 'BEL1') 
                                | (tabela_18['Liga'] == 'CHN') | (tabela_18['Liga'] == 'DEN') | (tabela_18['Liga'] == 'GRE') | (tabela_18['Liga'] == 'HOL') 
                                | (tabela_18['Liga'] == 'JAP') | (tabela_18['Liga'] == 'MEX') | (tabela_18['Liga'] == 'SAUD') | (tabela_18['Liga'] == 'TUR') 
                                | (tabela_18['Liga'] == 'UAE') | (tabela_18['Liga'] == 'USA') | (tabela_18['Liga'] == 'ITA2') | (tabela_18['Liga'] == 'GER2') 
                                | (tabela_18['Liga'] == 'POR2') | (tabela_18['Liga'] == 'BUL') | (tabela_18['Liga'] == 'AUT') | (tabela_18['Liga'] == 'QAT')
                                | (tabela_18['Liga'] == 'CRO') | (tabela_18['Liga'] == 'CZH') | (tabela_18['Liga'] == 'NOR') | (tabela_18['Liga'] == 'POL')
                                | (tabela_18['Liga'] == 'SCT') | (tabela_18['Liga'] == 'SER') | (tabela_18['Liga'] == 'SPA2')]
            tabela_18 = tabela_18.sort_values(by='Rating', ascending=False)
            tabela_18 = tabela_18.head(50)
            #st.dataframe(tabela_18, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_18).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()

        elif posição == "Atacante":
            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Atacantes Referência</b></h4>", unsafe_allow_html=True)
            tabela_19 = pd.read_csv("20_Role_Atacante_Referência_Full.csv")
            tabela_19 = tabela_19[(tabela_19['Nacionalidade']==nacionalidade)&(tabela_19['Versão_Temporada']==temporada)]
            tabela_19 = tabela_19.iloc[:, np.r_[1, 28, 33, 3, 4, 7, 9:12, 15]]
            tabela_19 = tabela_19.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_19 = tabela_19[(tabela_19['Liga'] == 'ENG1') | (tabela_19['Liga'] == 'ENG2') | (tabela_19['Liga'] == 'FRA1') | (tabela_19['Liga'] == 'FRA2') 
                                | (tabela_19['Liga'] == 'SPA1') | (tabela_19['Liga'] == 'ITA1') | (tabela_19['Liga'] == 'GER1') | (tabela_19['Liga'] == 'POR1') 
                                | (tabela_19['Liga'] == 'SWZ') | (tabela_19['Liga'] == 'RUS') | (tabela_19['Liga'] == 'UKR') | (tabela_19['Liga'] == 'BEL1') 
                                | (tabela_19['Liga'] == 'CHN') | (tabela_19['Liga'] == 'DEN') | (tabela_19['Liga'] == 'GRE') | (tabela_19['Liga'] == 'HOL') 
                                | (tabela_19['Liga'] == 'JAP') | (tabela_19['Liga'] == 'MEX') | (tabela_19['Liga'] == 'SAUD') | (tabela_19['Liga'] == 'TUR') 
                                | (tabela_19['Liga'] == 'UAE') | (tabela_19['Liga'] == 'USA') | (tabela_19['Liga'] == 'ITA2') | (tabela_19['Liga'] == 'GER2') 
                                | (tabela_19['Liga'] == 'POR2') | (tabela_19['Liga'] == 'BUL') | (tabela_19['Liga'] == 'AUT') | (tabela_19['Liga'] == 'QAT')
                                | (tabela_19['Liga'] == 'CRO') | (tabela_19['Liga'] == 'CZH') | (tabela_19['Liga'] == 'NOR') | (tabela_19['Liga'] == 'POL')
                                | (tabela_19['Liga'] == 'SCT') | (tabela_19['Liga'] == 'SER') | (tabela_19['Liga'] == 'SPA2')]
            tabela_19 = tabela_19.sort_values(by='Rating', ascending=False)
            tabela_19 = tabela_19.head(50)
            #st.dataframe(tabela_19, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_19).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Atacantes Móveis</b></h4>", unsafe_allow_html=True)
            tabela_20 = pd.read_csv("21_Role_Atacante_Móvel_Full.csv")
            tabela_20 = tabela_20[(tabela_20['Nacionalidade']==nacionalidade)&(tabela_20['Versão_Temporada']==temporada)]
            tabela_20 = tabela_20.iloc[:, np.r_[1, 27, 32, 3, 4, 7, 9:12, 15]]
            tabela_20 = tabela_20.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_20 = tabela_20[(tabela_20['Liga'] == 'ENG1') | (tabela_20['Liga'] == 'ENG2') | (tabela_20['Liga'] == 'FRA1') | (tabela_20['Liga'] == 'FRA2') 
                                | (tabela_20['Liga'] == 'SPA1') | (tabela_20['Liga'] == 'ITA1') | (tabela_20['Liga'] == 'GER1') | (tabela_20['Liga'] == 'POR1') 
                                | (tabela_20['Liga'] == 'SWZ') | (tabela_20['Liga'] == 'RUS') | (tabela_20['Liga'] == 'UKR') | (tabela_20['Liga'] == 'BEL1') 
                                | (tabela_20['Liga'] == 'CHN') | (tabela_20['Liga'] == 'DEN') | (tabela_20['Liga'] == 'GRE') | (tabela_20['Liga'] == 'HOL') 
                                | (tabela_20['Liga'] == 'JAP') | (tabela_20['Liga'] == 'MEX') | (tabela_20['Liga'] == 'SAUD') | (tabela_20['Liga'] == 'TUR') 
                                | (tabela_20['Liga'] == 'UAE') | (tabela_20['Liga'] == 'USA') | (tabela_20['Liga'] == 'ITA2') | (tabela_20['Liga'] == 'GER2') 
                                | (tabela_20['Liga'] == 'POR2') | (tabela_20['Liga'] == 'BUL') | (tabela_20['Liga'] == 'AUT') | (tabela_20['Liga'] == 'QAT')
                                | (tabela_20['Liga'] == 'CRO') | (tabela_20['Liga'] == 'CZH') | (tabela_20['Liga'] == 'NOR') | (tabela_20['Liga'] == 'POL')
                                | (tabela_20['Liga'] == 'SCT') | (tabela_20['Liga'] == 'SER') | (tabela_20['Liga'] == 'SPA2')]
            tabela_20 = tabela_20.sort_values(by='Rating', ascending=False)
            tabela_20 = tabela_20.head(50)
            #st.dataframe(tabela_20, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_20).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


            st.markdown("<h4 style='text-align: center;'><br>Nacionais Mais Bem Ranqueados<br><br>Segundos Atacantes</b></h4>", unsafe_allow_html=True)
            tabela_21 = pd.read_csv("22_Role_Segundo_Atacante_Full.csv")
            tabela_21 = tabela_21[(tabela_21['Nacionalidade']==nacionalidade)&(tabela_21['Versão_Temporada']==temporada)]
            tabela_21 = tabela_21.iloc[:, np.r_[1, 31, 36, 3, 4, 7, 9:12, 15]]
            tabela_21 = tabela_21.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Posição_Wyscout':'Posição', 'Versão_Temporada':'Janela de Análise'})
            tabela_21 = tabela_21[(tabela_21['Liga'] == 'ENG1') | (tabela_21['Liga'] == 'ENG2') | (tabela_21['Liga'] == 'FRA1') | (tabela_21['Liga'] == 'FRA2') 
                                | (tabela_21['Liga'] == 'SPA1') | (tabela_21['Liga'] == 'ITA1') | (tabela_21['Liga'] == 'GER1') | (tabela_21['Liga'] == 'POR1') 
                                | (tabela_21['Liga'] == 'SWZ') | (tabela_21['Liga'] == 'RUS') | (tabela_21['Liga'] == 'UKR') | (tabela_21['Liga'] == 'BEL1') 
                                | (tabela_21['Liga'] == 'CHN') | (tabela_21['Liga'] == 'DEN') | (tabela_21['Liga'] == 'GRE') | (tabela_21['Liga'] == 'HOL') 
                                | (tabela_21['Liga'] == 'JAP') | (tabela_21['Liga'] == 'MEX') | (tabela_21['Liga'] == 'SAUD') | (tabela_21['Liga'] == 'TUR') 
                                | (tabela_21['Liga'] == 'UAE') | (tabela_21['Liga'] == 'USA') | (tabela_21['Liga'] == 'ITA2') | (tabela_21['Liga'] == 'GER2') 
                                | (tabela_21['Liga'] == 'POR2') | (tabela_21['Liga'] == 'BUL') | (tabela_21['Liga'] == 'AUT') | (tabela_21['Liga'] == 'QAT')
                                | (tabela_21['Liga'] == 'CRO') | (tabela_21['Liga'] == 'CZH') | (tabela_21['Liga'] == 'NOR') | (tabela_21['Liga'] == 'POL')
                                | (tabela_21['Liga'] == 'SCT') | (tabela_21['Liga'] == 'SER') | (tabela_21['Liga'] == 'SPA2')]
            tabela_21 = tabela_21.sort_values(by='Rating', ascending=False)
            tabela_21 = tabela_21.head(50)
            #st.dataframe(tabela_21, use_container_width=True, hide_index=True)

            # Styling DataFrame using Pandas
            def style_table(df):
                df = df.reset_index(drop=True)
                # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
                return df.style.format(formatter).set_table_styles(
                    [{
                        'selector': 'thead th',
                        'props': [('font-weight', 'bold'),
                                ('border-style', 'solid'),
                                ('border-width', '0px 0px 2px 0px'),
                                ('border-color', 'black')]
                    }, {
                        'selector': 'thead th:not(:first-child)',
                        'props': [('text-align', 'center')]  # Centering all headers except the first
                    }, {
                        'selector': 'thead th:last-child',
                        'props': [('color', 'black')]  # Make last column header black
                    }, {
                        'selector': 'td',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'center')]
                    }, {
                        'selector': 'th',
                        'props': [('border-style', 'solid'),
                                ('border-width', '0px 0px 1px 0px'),
                                ('border-color', 'black'),
                                ('text-align', 'left')]
                    }]
                ).set_properties(**{'padding': '2px',
                                    'font-size': '15px'})

            # Displaying in Streamlit
            def main():
                #st.title("Your DataFrame")

                # Convert the styled DataFrame to HTML without the index and display it
                styled_html = style_table(tabela_21).to_html(escape=False, index=False, hide_index=True)
                st.markdown(styled_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()


###############################################################################################################################
###############################################################################################################################
###############################################################################################################################
###############################################################################################################################

if st.session_state.selected_option == "Free Agents pelo Mundo":
    st.markdown("<h2 style='text-align: center;'>Free Agents pelo Mundo</h2>", unsafe_allow_html=True)
    nacionalidades = df8["Nacionalidade"]
    posições = df6["Posição"]
    contratos = ["2025-12-31", "2026-01-31", "2026-02-28", "2026-06-30", "2026-09-30", "2026-12-31", "2027-06-30"]
    temporada = 2025
    #mundo_options = df5["Liga"]#['BRA1', 'ARG1', 'ENG1', 'ENG2', 'FRA1', 'FRA2', 'SPA1', 'SPA2', 'ITA1', 'ITA2', 'GER1', 'POR1', 'POR2', 'SWZ', 'CZH', 'CRO', 'SER', 'RUS', 'UKR', 'BEL1', 'BEL2', 'CHN',
             #'DEN', 'GRE', 'HOL', 'JAP', 'MEX', 'SAUD', 'SCT', 'TUR', 'UAE', 'USA', 'BUL', 'AUT', 'QAT']
    nacionalidade = st.selectbox("Escolha a Nacionalidade do Atleta", options=nacionalidades)
    posição = st.selectbox("Escolha a Posição do Atleta", options=posições)
    #função = st.selectbox("Escolha a Posição", options=funções)
    contrato = st.selectbox("Escolha a Data de Fim de Contrato", options=contratos)

    if posição == ("Goleiro"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Goleiros</b></h4>", unsafe_allow_html=True)
        tabela_7 = pd.read_csv("1_Role_Goleiro_Full.csv")
        tabela_7 = tabela_7.loc[(tabela_7['Nacionalidade']==nacionalidade)&(tabela_7['Fim_Contrato']<=contrato)&(tabela_7['Versão_Temporada']==temporada)]   
        tabela_7 = tabela_7.iloc[:, np.r_[1, 3, 7, 15, 9:12, 25]]
        tabela_7 = tabela_7[(tabela_7['Liga'] == 'ARG1') | (tabela_7['Liga'] == 'AUS') | (tabela_7['Liga'] == 'AUT') 
            | (tabela_7['Liga'] == 'BEL1') | (tabela_7['Liga'] == 'BEL2') | (tabela_7['Liga'] == 'BOL') 
            | (tabela_7['Liga'] == 'BRA1') | (tabela_7['Liga'] == 'BRA2') | (tabela_7['Liga'] == 'BUL') | (tabela_7['Liga'] == 'CHI')
            | (tabela_7['Liga'] == 'CHN') | (tabela_7['Liga'] == 'COL') | (tabela_7['Liga'] == 'CRO') | (tabela_7['Liga'] == 'CZH')
            | (tabela_7['Liga'] == 'DEN') | (tabela_7['Liga'] == 'ECU') | (tabela_7['Liga'] == 'ENG1') | (tabela_7['Liga'] == 'ENG2') 
            | (tabela_7['Liga'] == 'FIN') | (tabela_7['Liga'] == 'FRA1') | (tabela_7['Liga'] == 'FRA2') | (tabela_7['Liga'] == 'GEO')  
            | (tabela_7['Liga'] == 'GER1') | (tabela_7['Liga'] == 'GER2') | (tabela_7['Liga'] == 'GRE') | (tabela_7['Liga'] == 'HOL') 
            | (tabela_7['Liga'] == 'IND') | (tabela_7['Liga'] == 'INDO') | (tabela_7['Liga'] == 'ITA1') | (tabela_7['Liga'] == 'ITA2') 
            | (tabela_7['Liga'] == 'JAP') | (tabela_7['Liga'] == 'KOR') | (tabela_7['Liga'] == 'MEX') | (tabela_7['Liga'] == 'MOR') 
            | (tabela_7['Liga'] == 'NOR') | (tabela_7['Liga'] == 'PAR') | (tabela_7['Liga'] == 'PER') | (tabela_7['Liga'] == 'POL') 
            | (tabela_7['Liga'] == 'POR1') | (tabela_7['Liga'] == 'POR2') | (tabela_7['Liga'] == 'QAT') | (tabela_7['Liga'] == 'ROM') 
            | (tabela_7['Liga'] == 'RUS') | (tabela_7['Liga'] == 'SAUD') | (tabela_7['Liga'] == 'SCT') | (tabela_7['Liga'] == 'SER') 
            | (tabela_7['Liga'] == 'SPA1') | (tabela_7['Liga'] == 'SPA2') | (tabela_7['Liga'] == 'SWE') | (tabela_7['Liga'] == 'SWZ') 
            | (tabela_7['Liga'] == 'TUR') | (tabela_7['Liga'] == 'UAE') | (tabela_7['Liga'] == 'UKR')  | (tabela_7['Liga'] == 'URU')
            | (tabela_7['Liga'] == 'USA') | (tabela_7['Liga'] == 'UZB') | (tabela_7['Liga'] == 'VEN')]

        tabela_8 = pd.read_csv("PlayerAnalysis_Role_1_Full.csv")
        tabela_8 = tabela_8.loc[(tabela_8['Nacionalidade']==nacionalidade)&(tabela_8['Fim_Contrato']<=contrato)&(tabela_8['Versão_Temporada']==temporada)]
        tabela_8 = tabela_8.iloc[:, np.r_[9, 30:34, 26, 28]]
        tabela_8 = tabela_8[(tabela_8['Liga'] == 'ARG1') | (tabela_8['Liga'] == 'AUS') | (tabela_8['Liga'] == 'AUT') 
            | (tabela_8['Liga'] == 'BEL1') | (tabela_8['Liga'] == 'BEL2') | (tabela_8['Liga'] == 'BOL') 
            | (tabela_8['Liga'] == 'BRA1') | (tabela_8['Liga'] == 'BRA2') | (tabela_8['Liga'] == 'BUL') | (tabela_8['Liga'] == 'CHI')
            | (tabela_8['Liga'] == 'CHN') | (tabela_8['Liga'] == 'COL') | (tabela_8['Liga'] == 'CRO') | (tabela_8['Liga'] == 'CZH')
            | (tabela_8['Liga'] == 'DEN') | (tabela_8['Liga'] == 'ECU') | (tabela_8['Liga'] == 'ENG1') | (tabela_8['Liga'] == 'ENG2') 
            | (tabela_8['Liga'] == 'FIN') | (tabela_8['Liga'] == 'FRA1') | (tabela_8['Liga'] == 'FRA2') | (tabela_8['Liga'] == 'GEO')  
            | (tabela_8['Liga'] == 'GER1') | (tabela_8['Liga'] == 'GER2') | (tabela_8['Liga'] == 'GRE') | (tabela_8['Liga'] == 'HOL') 
            | (tabela_8['Liga'] == 'IND') | (tabela_8['Liga'] == 'INDO') | (tabela_8['Liga'] == 'ITA1') | (tabela_8['Liga'] == 'ITA2') 
            | (tabela_8['Liga'] == 'JAP') | (tabela_8['Liga'] == 'KOR') | (tabela_8['Liga'] == 'MEX') | (tabela_8['Liga'] == 'MOR') 
            | (tabela_8['Liga'] == 'NOR') | (tabela_8['Liga'] == 'PAR') | (tabela_8['Liga'] == 'PER') | (tabela_8['Liga'] == 'POL') 
            | (tabela_8['Liga'] == 'POR1') | (tabela_8['Liga'] == 'POR2') | (tabela_8['Liga'] == 'QAT') | (tabela_8['Liga'] == 'ROM') 
            | (tabela_8['Liga'] == 'RUS') | (tabela_8['Liga'] == 'SAUD') | (tabela_8['Liga'] == 'SCT') | (tabela_8['Liga'] == 'SER') 
            | (tabela_8['Liga'] == 'SPA1') | (tabela_8['Liga'] == 'SPA2') | (tabela_8['Liga'] == 'SWE') | (tabela_8['Liga'] == 'SWZ') 
            | (tabela_8['Liga'] == 'TUR') | (tabela_8['Liga'] == 'UAE') | (tabela_8['Liga'] == 'UKR')  | (tabela_8['Liga'] == 'URU')
            | (tabela_8['Liga'] == 'USA') | (tabela_8['Liga'] == 'UZB') | (tabela_8['Liga'] == 'VEN')]

        tabela_7 = pd.merge(tabela_7, tabela_8[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_7 = tabela_7.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado':'Valor'})
        tabela_7 = tabela_7.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><b>Goleiros Clássicos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_7, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_7).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

        tabela_8 = pd.read_csv("2_Role_Goleiro_Líbero_Full.csv")
        tabela_8 = tabela_8.loc[(tabela_8['Nacionalidade']==nacionalidade)&(tabela_8['Fim_Contrato']<=contrato)&(tabela_8['Versão_Temporada']==temporada)]   
        tabela_8 = tabela_8.iloc[:, np.r_[1, 3, 7, 15, 9:12, 28]]
        tabela_8 = tabela_8[(tabela_8['Liga'] == 'ARG1') | (tabela_8['Liga'] == 'AUS') | (tabela_8['Liga'] == 'AUT') 
            | (tabela_8['Liga'] == 'BEL1') | (tabela_8['Liga'] == 'BEL2') | (tabela_8['Liga'] == 'BOL') 
            | (tabela_8['Liga'] == 'BRA1') | (tabela_8['Liga'] == 'BRA2') | (tabela_8['Liga'] == 'BUL') | (tabela_8['Liga'] == 'CHI')
            | (tabela_8['Liga'] == 'CHN') | (tabela_8['Liga'] == 'COL') | (tabela_8['Liga'] == 'CRO') | (tabela_8['Liga'] == 'CZH')
            | (tabela_8['Liga'] == 'DEN') | (tabela_8['Liga'] == 'ECU') | (tabela_8['Liga'] == 'ENG1') | (tabela_8['Liga'] == 'ENG2') 
            | (tabela_8['Liga'] == 'FIN') | (tabela_8['Liga'] == 'FRA1') | (tabela_8['Liga'] == 'FRA2') | (tabela_8['Liga'] == 'GEO')  
            | (tabela_8['Liga'] == 'GER1') | (tabela_8['Liga'] == 'GER2') | (tabela_8['Liga'] == 'GRE') | (tabela_8['Liga'] == 'HOL') 
            | (tabela_8['Liga'] == 'IND') | (tabela_8['Liga'] == 'INDO') | (tabela_8['Liga'] == 'ITA1') | (tabela_8['Liga'] == 'ITA2') 
            | (tabela_8['Liga'] == 'JAP') | (tabela_8['Liga'] == 'KOR') | (tabela_8['Liga'] == 'MEX') | (tabela_8['Liga'] == 'MOR') 
            | (tabela_8['Liga'] == 'NOR') | (tabela_8['Liga'] == 'PAR') | (tabela_8['Liga'] == 'PER') | (tabela_8['Liga'] == 'POL') 
            | (tabela_8['Liga'] == 'POR1') | (tabela_8['Liga'] == 'POR2') | (tabela_8['Liga'] == 'QAT') | (tabela_8['Liga'] == 'ROM') 
            | (tabela_8['Liga'] == 'RUS') | (tabela_8['Liga'] == 'SAUD') | (tabela_8['Liga'] == 'SCT') | (tabela_8['Liga'] == 'SER') 
            | (tabela_8['Liga'] == 'SPA1') | (tabela_8['Liga'] == 'SPA2') | (tabela_8['Liga'] == 'SWE') | (tabela_8['Liga'] == 'SWZ') 
            | (tabela_8['Liga'] == 'TUR') | (tabela_8['Liga'] == 'UAE') | (tabela_8['Liga'] == 'UKR')  | (tabela_8['Liga'] == 'URU')
            | (tabela_8['Liga'] == 'USA') | (tabela_8['Liga'] == 'UZB') | (tabela_8['Liga'] == 'VEN')]

        tabela_9 = pd.read_csv("PlayerAnalysis_Role_2_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]
        tabela_9 = tabela_9.iloc[:, np.r_[12, 33:37, 29, 31]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_8 = pd.merge(tabela_8, tabela_9[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_8 = tabela_8.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado':'Valor'})
        tabela_8['Rating'] = tabela_8['Rating'].round(3)
        st.markdown("<h4 style='text-align: center;'><br><b>Goleiros Líberos</b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_8, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_8).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

    elif posição == ("Lateral"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Laterais </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("3_Role_Lateral_Defensivo_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 7, 15, 9:12, 23]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_3_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[7, 28, 29, 31, 30, 24]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        tabela_9["Idade"] = pd.to_numeric(tabela_9["Idade"], errors='coerce').fillna(0).astype(int)
        st.markdown("<h4 style='text-align: center;'><b>Laterais Defensivos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("4_Role_Lateral_Ofensivo_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 7, 15, 9:12, 28]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_4_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[12, 33, 34, 36, 35, 29]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]

        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas'})
        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        tabela_11["Idade"] = pd.to_numeric(tabela_11["Idade"], errors='coerce').fillna(0).astype(int)
        st.markdown("<h4 style='text-align: center;'><br><b>Laterais Ofensivos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)
        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '0px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_13 = pd.read_csv("5_Role_Lateral_Equilibrado_Full.csv")
        tabela_13 = tabela_13.loc[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Fim_Contrato']<=contrato)&(tabela_13['Versão_Temporada']==temporada)]   
        tabela_13 = tabela_13.iloc[:, np.r_[1, 3, 7, 15, 9:12, 31]]
        tabela_13 = tabela_13[(tabela_13['Liga'] == 'ARG1') | (tabela_13['Liga'] == 'AUS') | (tabela_13['Liga'] == 'AUT') 
            | (tabela_13['Liga'] == 'BEL1') | (tabela_13['Liga'] == 'BEL2') | (tabela_13['Liga'] == 'BOL') 
            | (tabela_13['Liga'] == 'BRA1') | (tabela_13['Liga'] == 'BRA2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'CHI')
            | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'COL') | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH')
            | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'ECU') | (tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') 
            | (tabela_13['Liga'] == 'FIN') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') | (tabela_13['Liga'] == 'GEO')  
            | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'GER2') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
            | (tabela_13['Liga'] == 'IND') | (tabela_13['Liga'] == 'INDO') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'ITA2') 
            | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'KOR') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'MOR') 
            | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'PAR') | (tabela_13['Liga'] == 'PER') | (tabela_13['Liga'] == 'POL') 
            | (tabela_13['Liga'] == 'POR1') | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'QAT') | (tabela_13['Liga'] == 'ROM') 
            | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') 
            | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'SPA2') | (tabela_13['Liga'] == 'SWE') | (tabela_13['Liga'] == 'SWZ') 
            | (tabela_13['Liga'] == 'TUR') | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'UKR')  | (tabela_13['Liga'] == 'URU')
            | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'UZB') | (tabela_13['Liga'] == 'VEN')]

        tabela_14 = pd.read_csv("PlayerAnalysis_Role_5_Full.csv")
        tabela_14 = tabela_14.loc[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Fim_Contrato']<=contrato)&(tabela_14['Versão_Temporada']==temporada)]
        tabela_14 = tabela_14.iloc[:, np.r_[15, 36, 37, 39, 38, 32]]
        tabela_14 = tabela_14[(tabela_14['Liga'] == 'ARG1') | (tabela_14['Liga'] == 'AUS') | (tabela_14['Liga'] == 'AUT') 
            | (tabela_14['Liga'] == 'BEL1') | (tabela_14['Liga'] == 'BEL2') | (tabela_14['Liga'] == 'BOL') 
            | (tabela_14['Liga'] == 'BRA1') | (tabela_14['Liga'] == 'BRA2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'CHI')
            | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'COL') | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH')
            | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'ECU') | (tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') 
            | (tabela_14['Liga'] == 'FIN') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') | (tabela_14['Liga'] == 'GEO')  
            | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'GER2') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
            | (tabela_14['Liga'] == 'IND') | (tabela_14['Liga'] == 'INDO') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'ITA2') 
            | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'KOR') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'MOR') 
            | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'PAR') | (tabela_14['Liga'] == 'PER') | (tabela_14['Liga'] == 'POL') 
            | (tabela_14['Liga'] == 'POR1') | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'QAT') | (tabela_14['Liga'] == 'ROM') 
            | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') 
            | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'SPA2') | (tabela_14['Liga'] == 'SWE') | (tabela_14['Liga'] == 'SWZ') 
            | (tabela_14['Liga'] == 'TUR') | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'UKR')  | (tabela_14['Liga'] == 'URU')
            | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'UZB') | (tabela_14['Liga'] == 'VEN')]

        tabela_13 = pd.merge(tabela_13, tabela_14[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas'})
        tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
        tabela_13["Idade"] = pd.to_numeric(tabela_13["Idade"], errors='coerce').fillna(0).astype(int)
        st.markdown("<h4 style='text-align: center;'><br><b>Laterais Equilibrados </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}"}  # Format the 'Rating' column to 3 decimal places
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


    elif posição == ("Zagueiro"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Zagueiros </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("6_Role_Zagueiro_Defensivo_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 24]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_6_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[8, 25, 29:33]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Zagueiros Clássicos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("7_Role_Zagueiro_Construtor_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 28]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_7_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[12, 29, 33:37]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]

        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})

        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Zagueiros Construtores </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_13 = pd.read_csv("8_Role_Zagueiro_Equilibrado_Full.csv")
        tabela_13 = tabela_13.loc[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Fim_Contrato']<=contrato)&(tabela_13['Versão_Temporada']==temporada)]   
        tabela_13 = tabela_13.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 31]]
        tabela_13 = tabela_13[(tabela_13['Liga'] == 'ARG1') | (tabela_13['Liga'] == 'AUS') | (tabela_13['Liga'] == 'AUT') 
            | (tabela_13['Liga'] == 'BEL1') | (tabela_13['Liga'] == 'BEL2') | (tabela_13['Liga'] == 'BOL') 
            | (tabela_13['Liga'] == 'BRA1') | (tabela_13['Liga'] == 'BRA2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'CHI')
            | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'COL') | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH')
            | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'ECU') | (tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') 
            | (tabela_13['Liga'] == 'FIN') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') | (tabela_13['Liga'] == 'GEO')  
            | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'GER2') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
            | (tabela_13['Liga'] == 'IND') | (tabela_13['Liga'] == 'INDO') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'ITA2') 
            | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'KOR') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'MOR') 
            | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'PAR') | (tabela_13['Liga'] == 'PER') | (tabela_13['Liga'] == 'POL') 
            | (tabela_13['Liga'] == 'POR1') | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'QAT') | (tabela_13['Liga'] == 'ROM') 
            | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') 
            | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'SPA2') | (tabela_13['Liga'] == 'SWE') | (tabela_13['Liga'] == 'SWZ') 
            | (tabela_13['Liga'] == 'TUR') | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'UKR')  | (tabela_13['Liga'] == 'URU')
            | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'UZB') | (tabela_13['Liga'] == 'VEN')]

        tabela_14 = pd.read_csv("PlayerAnalysis_Role_8_Full.csv")
        tabela_14 = tabela_14.loc[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Fim_Contrato']<=contrato)&(tabela_14['Versão_Temporada']==temporada)]
        tabela_14 = tabela_14.iloc[:, np.r_[15, 32, 36:40]]
        tabela_14 = tabela_14[(tabela_14['Liga'] == 'ARG1') | (tabela_14['Liga'] == 'AUS') | (tabela_14['Liga'] == 'AUT') 
            | (tabela_14['Liga'] == 'BEL1') | (tabela_14['Liga'] == 'BEL2') | (tabela_14['Liga'] == 'BOL') 
            | (tabela_14['Liga'] == 'BRA1') | (tabela_14['Liga'] == 'BRA2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'CHI')
            | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'COL') | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH')
            | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'ECU') | (tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') 
            | (tabela_14['Liga'] == 'FIN') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') | (tabela_14['Liga'] == 'GEO')  
            | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'GER2') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
            | (tabela_14['Liga'] == 'IND') | (tabela_14['Liga'] == 'INDO') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'ITA2') 
            | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'KOR') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'MOR') 
            | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'PAR') | (tabela_14['Liga'] == 'PER') | (tabela_14['Liga'] == 'POL') 
            | (tabela_14['Liga'] == 'POR1') | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'QAT') | (tabela_14['Liga'] == 'ROM') 
            | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') 
            | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'SPA2') | (tabela_14['Liga'] == 'SWE') | (tabela_14['Liga'] == 'SWZ') 
            | (tabela_14['Liga'] == 'TUR') | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'UKR')  | (tabela_14['Liga'] == 'URU')
            | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'UZB') | (tabela_14['Liga'] == 'VEN')]

        tabela_13 = pd.merge(tabela_13, tabela_14[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Zagueiros Equilibrados </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################

    elif posição == ("Primeiro Volante"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Primeiros Volantes </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("9_Role_Volante_Defensivo_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 22]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_9_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[6, 23, 27:31]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Primeiros Volantes Defensivos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("10_Role_Volante_Construtor_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 27]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_10_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[11, 28, 32:36]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]

        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})

        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Primeiros Volantes Construtores </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_13 = pd.read_csv("11_Role_Volante_Equilibrado_Full.csv")
        tabela_13 = tabela_13.loc[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Fim_Contrato']<=contrato)&(tabela_13['Versão_Temporada']==temporada)]   
        tabela_13 = tabela_13.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 29]]
        tabela_13 = tabela_13[(tabela_13['Liga'] == 'ARG1') | (tabela_13['Liga'] == 'AUS') | (tabela_13['Liga'] == 'AUT') 
            | (tabela_13['Liga'] == 'BEL1') | (tabela_13['Liga'] == 'BEL2') | (tabela_13['Liga'] == 'BOL') 
            | (tabela_13['Liga'] == 'BRA1') | (tabela_13['Liga'] == 'BRA2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'CHI')
            | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'COL') | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH')
            | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'ECU') | (tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') 
            | (tabela_13['Liga'] == 'FIN') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') | (tabela_13['Liga'] == 'GEO')  
            | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'GER2') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
            | (tabela_13['Liga'] == 'IND') | (tabela_13['Liga'] == 'INDO') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'ITA2') 
            | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'KOR') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'MOR') 
            | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'PAR') | (tabela_13['Liga'] == 'PER') | (tabela_13['Liga'] == 'POL') 
            | (tabela_13['Liga'] == 'POR1') | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'QAT') | (tabela_13['Liga'] == 'ROM') 
            | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') 
            | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'SPA2') | (tabela_13['Liga'] == 'SWE') | (tabela_13['Liga'] == 'SWZ') 
            | (tabela_13['Liga'] == 'TUR') | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'UKR')  | (tabela_13['Liga'] == 'URU')
            | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'UZB') | (tabela_13['Liga'] == 'VEN')]

        tabela_14 = pd.read_csv("PlayerAnalysis_Role_11_Full.csv")
        tabela_14 = tabela_14.loc[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Fim_Contrato']<=contrato)&(tabela_14['Versão_Temporada']==temporada)]
        tabela_14 = tabela_14.iloc[:, np.r_[13, 30, 34:38]]
        tabela_14 = tabela_14[(tabela_14['Liga'] == 'ARG1') | (tabela_14['Liga'] == 'AUS') | (tabela_14['Liga'] == 'AUT') 
            | (tabela_14['Liga'] == 'BEL1') | (tabela_14['Liga'] == 'BEL2') | (tabela_14['Liga'] == 'BOL') 
            | (tabela_14['Liga'] == 'BRA1') | (tabela_14['Liga'] == 'BRA2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'CHI')
            | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'COL') | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH')
            | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'ECU') | (tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') 
            | (tabela_14['Liga'] == 'FIN') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') | (tabela_14['Liga'] == 'GEO')  
            | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'GER2') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
            | (tabela_14['Liga'] == 'IND') | (tabela_14['Liga'] == 'INDO') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'ITA2') 
            | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'KOR') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'MOR') 
            | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'PAR') | (tabela_14['Liga'] == 'PER') | (tabela_14['Liga'] == 'POL') 
            | (tabela_14['Liga'] == 'POR1') | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'QAT') | (tabela_14['Liga'] == 'ROM') 
            | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') 
            | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'SPA2') | (tabela_14['Liga'] == 'SWE') | (tabela_14['Liga'] == 'SWZ') 
            | (tabela_14['Liga'] == 'TUR') | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'UKR')  | (tabela_14['Liga'] == 'URU')
            | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'UZB') | (tabela_14['Liga'] == 'VEN')]

        tabela_13 = pd.merge(tabela_13, tabela_14[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Primeiros Volantes Equilibrados </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################

    elif posição == ("Segundo Volante"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br><br>Segundos Volantes </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("12_Role_Segundo_Volante_Box_to_Box_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 31]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_12_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[15, 32, 36:40]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Segundos Volantes Box-to-Box </b></h4>", unsafe_allow_html=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("13_Role_Segundo_Volante_Organizador_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 28]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_13_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[12, 29, 33:37]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]

        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})

        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Segundos Volantes Organizadores </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_13 = pd.read_csv("14_Role_Segundo_Volante_Equilibrado_Full.csv")
        tabela_13 = tabela_13.loc[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Fim_Contrato']<=contrato)&(tabela_13['Versão_Temporada']==temporada)]   
        tabela_13 = tabela_13.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 31]]
        tabela_13 = tabela_13[(tabela_13['Liga'] == 'ARG1') | (tabela_13['Liga'] == 'AUS') | (tabela_13['Liga'] == 'AUT') 
            | (tabela_13['Liga'] == 'BEL1') | (tabela_13['Liga'] == 'BEL2') | (tabela_13['Liga'] == 'BOL') 
            | (tabela_13['Liga'] == 'BRA1') | (tabela_13['Liga'] == 'BRA2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'CHI')
            | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'COL') | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH')
            | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'ECU') | (tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') 
            | (tabela_13['Liga'] == 'FIN') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') | (tabela_13['Liga'] == 'GEO')  
            | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'GER2') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
            | (tabela_13['Liga'] == 'IND') | (tabela_13['Liga'] == 'INDO') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'ITA2') 
            | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'KOR') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'MOR') 
            | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'PAR') | (tabela_13['Liga'] == 'PER') | (tabela_13['Liga'] == 'POL') 
            | (tabela_13['Liga'] == 'POR1') | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'QAT') | (tabela_13['Liga'] == 'ROM') 
            | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') 
            | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'SPA2') | (tabela_13['Liga'] == 'SWE') | (tabela_13['Liga'] == 'SWZ') 
            | (tabela_13['Liga'] == 'TUR') | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'UKR')  | (tabela_13['Liga'] == 'URU')
            | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'UZB') | (tabela_13['Liga'] == 'VEN')]

        tabela_14 = pd.read_csv("PlayerAnalysis_Role_14_Full.csv")
        tabela_14 = tabela_14.loc[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Fim_Contrato']<=contrato)&(tabela_14['Versão_Temporada']==temporada)]
        tabela_14 = tabela_14.iloc[:, np.r_[15, 32, 36:40]]
        tabela_14 = tabela_14[(tabela_14['Liga'] == 'ARG1') | (tabela_14['Liga'] == 'AUS') | (tabela_14['Liga'] == 'AUT') 
            | (tabela_14['Liga'] == 'BEL1') | (tabela_14['Liga'] == 'BEL2') | (tabela_14['Liga'] == 'BOL') 
            | (tabela_14['Liga'] == 'BRA1') | (tabela_14['Liga'] == 'BRA2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'CHI')
            | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'COL') | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH')
            | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'ECU') | (tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') 
            | (tabela_14['Liga'] == 'FIN') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') | (tabela_14['Liga'] == 'GEO')  
            | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'GER2') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
            | (tabela_14['Liga'] == 'IND') | (tabela_14['Liga'] == 'INDO') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'ITA2') 
            | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'KOR') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'MOR') 
            | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'PAR') | (tabela_14['Liga'] == 'PER') | (tabela_14['Liga'] == 'POL') 
            | (tabela_14['Liga'] == 'POR1') | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'QAT') | (tabela_14['Liga'] == 'ROM') 
            | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') 
            | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'SPA2') | (tabela_14['Liga'] == 'SWE') | (tabela_14['Liga'] == 'SWZ') 
            | (tabela_14['Liga'] == 'TUR') | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'UKR')  | (tabela_14['Liga'] == 'URU')
            | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'UZB') | (tabela_14['Liga'] == 'VEN')]

        tabela_13 = pd.merge(tabela_13, tabela_14[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Segundos Volantes Equilibrados </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################

    elif posição == ("Meia"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Meias </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("15_Role_Meia_Organizador_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 28]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_15_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[12, 29, 33:37]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Meias Organizadores </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("16_Role_Meia_Atacante_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 35]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_16_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[19, 36, 40:44]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]

        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})

        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Meias Atacantes </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################

    elif posição == ("Extremo"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Extremos </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("17_Role_Extremo_Organizador_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 31]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_17_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[15, 32, 36:40]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><b>Extremos Organizadores </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("18_Role_Extremo_Tático_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 25]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_18_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[9, 26, 30:34]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]


        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})

        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Extremos Táticos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

        tabela_13 = pd.read_csv("19_Role_Extremo_Agudo_Full.csv")
        tabela_13 = tabela_13.loc[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Fim_Contrato']<=contrato)&(tabela_13['Versão_Temporada']==temporada)]   
        tabela_13 = tabela_13.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 31]]
        tabela_13 = tabela_13[(tabela_13['Liga'] == 'ARG1') | (tabela_13['Liga'] == 'AUS') | (tabela_13['Liga'] == 'AUT') 
            | (tabela_13['Liga'] == 'BEL1') | (tabela_13['Liga'] == 'BEL2') | (tabela_13['Liga'] == 'BOL') 
            | (tabela_13['Liga'] == 'BRA1') | (tabela_13['Liga'] == 'BRA2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'CHI')
            | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'COL') | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH')
            | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'ECU') | (tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') 
            | (tabela_13['Liga'] == 'FIN') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') | (tabela_13['Liga'] == 'GEO')  
            | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'GER2') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
            | (tabela_13['Liga'] == 'IND') | (tabela_13['Liga'] == 'INDO') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'ITA2') 
            | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'KOR') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'MOR') 
            | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'PAR') | (tabela_13['Liga'] == 'PER') | (tabela_13['Liga'] == 'POL') 
            | (tabela_13['Liga'] == 'POR1') | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'QAT') | (tabela_13['Liga'] == 'ROM') 
            | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') 
            | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'SPA2') | (tabela_13['Liga'] == 'SWE') | (tabela_13['Liga'] == 'SWZ') 
            | (tabela_13['Liga'] == 'TUR') | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'UKR')  | (tabela_13['Liga'] == 'URU')
            | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'UZB') | (tabela_13['Liga'] == 'VEN')]

        tabela_14 = pd.read_csv("PlayerAnalysis_Role_19_Full.csv")
        tabela_14 = tabela_14.loc[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Fim_Contrato']<=contrato)&(tabela_14['Versão_Temporada']==temporada)]
        tabela_14 = tabela_14.iloc[:, np.r_[15, 32, 36:40]]
        tabela_14 = tabela_14[(tabela_14['Liga'] == 'ARG1') | (tabela_14['Liga'] == 'AUS') | (tabela_14['Liga'] == 'AUT') 
            | (tabela_14['Liga'] == 'BEL1') | (tabela_14['Liga'] == 'BEL2') | (tabela_14['Liga'] == 'BOL') 
            | (tabela_14['Liga'] == 'BRA1') | (tabela_14['Liga'] == 'BRA2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'CHI')
            | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'COL') | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH')
            | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'ECU') | (tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') 
            | (tabela_14['Liga'] == 'FIN') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') | (tabela_14['Liga'] == 'GEO')  
            | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'GER2') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
            | (tabela_14['Liga'] == 'IND') | (tabela_14['Liga'] == 'INDO') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'ITA2') 
            | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'KOR') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'MOR') 
            | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'PAR') | (tabela_14['Liga'] == 'PER') | (tabela_14['Liga'] == 'POL') 
            | (tabela_14['Liga'] == 'POR1') | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'QAT') | (tabela_14['Liga'] == 'ROM') 
            | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') 
            | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'SPA2') | (tabela_14['Liga'] == 'SWE') | (tabela_14['Liga'] == 'SWZ') 
            | (tabela_14['Liga'] == 'TUR') | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'UKR')  | (tabela_14['Liga'] == 'URU')
            | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'UZB') | (tabela_14['Liga'] == 'VEN')]

        tabela_13 = pd.merge(tabela_13, tabela_14[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Extremos Agudos </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################

    elif posição == ("Atacante"):
        st.markdown("<h4 style='text-align: center;'>Free Agents Nacionais Mais Bem Ranqueados<br>Atacantes </b></h4>", unsafe_allow_html=True)
        tabela_9 = pd.read_csv("20_Role_Atacante_Referência_Full.csv")
        tabela_9 = tabela_9.loc[(tabela_9['Nacionalidade']==nacionalidade)&(tabela_9['Fim_Contrato']<=contrato)&(tabela_9['Versão_Temporada']==temporada)]   
        tabela_9 = tabela_9.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 28]]
        tabela_9 = tabela_9[(tabela_9['Liga'] == 'ARG1') | (tabela_9['Liga'] == 'AUS') | (tabela_9['Liga'] == 'AUT') 
            | (tabela_9['Liga'] == 'BEL1') | (tabela_9['Liga'] == 'BEL2') | (tabela_9['Liga'] == 'BOL') 
            | (tabela_9['Liga'] == 'BRA1') | (tabela_9['Liga'] == 'BRA2') | (tabela_9['Liga'] == 'BUL') | (tabela_9['Liga'] == 'CHI')
            | (tabela_9['Liga'] == 'CHN') | (tabela_9['Liga'] == 'COL') | (tabela_9['Liga'] == 'CRO') | (tabela_9['Liga'] == 'CZH')
            | (tabela_9['Liga'] == 'DEN') | (tabela_9['Liga'] == 'ECU') | (tabela_9['Liga'] == 'ENG1') | (tabela_9['Liga'] == 'ENG2') 
            | (tabela_9['Liga'] == 'FIN') | (tabela_9['Liga'] == 'FRA1') | (tabela_9['Liga'] == 'FRA2') | (tabela_9['Liga'] == 'GEO')  
            | (tabela_9['Liga'] == 'GER1') | (tabela_9['Liga'] == 'GER2') | (tabela_9['Liga'] == 'GRE') | (tabela_9['Liga'] == 'HOL') 
            | (tabela_9['Liga'] == 'IND') | (tabela_9['Liga'] == 'INDO') | (tabela_9['Liga'] == 'ITA1') | (tabela_9['Liga'] == 'ITA2') 
            | (tabela_9['Liga'] == 'JAP') | (tabela_9['Liga'] == 'KOR') | (tabela_9['Liga'] == 'MEX') | (tabela_9['Liga'] == 'MOR') 
            | (tabela_9['Liga'] == 'NOR') | (tabela_9['Liga'] == 'PAR') | (tabela_9['Liga'] == 'PER') | (tabela_9['Liga'] == 'POL') 
            | (tabela_9['Liga'] == 'POR1') | (tabela_9['Liga'] == 'POR2') | (tabela_9['Liga'] == 'QAT') | (tabela_9['Liga'] == 'ROM') 
            | (tabela_9['Liga'] == 'RUS') | (tabela_9['Liga'] == 'SAUD') | (tabela_9['Liga'] == 'SCT') | (tabela_9['Liga'] == 'SER') 
            | (tabela_9['Liga'] == 'SPA1') | (tabela_9['Liga'] == 'SPA2') | (tabela_9['Liga'] == 'SWE') | (tabela_9['Liga'] == 'SWZ') 
            | (tabela_9['Liga'] == 'TUR') | (tabela_9['Liga'] == 'UAE') | (tabela_9['Liga'] == 'UKR')  | (tabela_9['Liga'] == 'URU')
            | (tabela_9['Liga'] == 'USA') | (tabela_9['Liga'] == 'UZB') | (tabela_9['Liga'] == 'VEN')]

        tabela_10 = pd.read_csv("PlayerAnalysis_Role_20_Full.csv")
        tabela_10 = tabela_10.loc[(tabela_10['Nacionalidade']==nacionalidade)&(tabela_10['Fim_Contrato']<=contrato)&(tabela_10['Versão_Temporada']==temporada)]
        tabela_10 = tabela_10.iloc[:, np.r_[12, 29, 33:37]]
        tabela_10 = tabela_10[(tabela_10['Liga'] == 'ARG1') | (tabela_10['Liga'] == 'AUS') | (tabela_10['Liga'] == 'AUT') 
            | (tabela_10['Liga'] == 'BEL1') | (tabela_10['Liga'] == 'BEL2') | (tabela_10['Liga'] == 'BOL') 
            | (tabela_10['Liga'] == 'BRA1') | (tabela_10['Liga'] == 'BRA2') | (tabela_10['Liga'] == 'BUL') | (tabela_10['Liga'] == 'CHI')
            | (tabela_10['Liga'] == 'CHN') | (tabela_10['Liga'] == 'COL') | (tabela_10['Liga'] == 'CRO') | (tabela_10['Liga'] == 'CZH')
            | (tabela_10['Liga'] == 'DEN') | (tabela_10['Liga'] == 'ECU') | (tabela_10['Liga'] == 'ENG1') | (tabela_10['Liga'] == 'ENG2') 
            | (tabela_10['Liga'] == 'FIN') | (tabela_10['Liga'] == 'FRA1') | (tabela_10['Liga'] == 'FRA2') | (tabela_10['Liga'] == 'GEO')  
            | (tabela_10['Liga'] == 'GER1') | (tabela_10['Liga'] == 'GER2') | (tabela_10['Liga'] == 'GRE') | (tabela_10['Liga'] == 'HOL') 
            | (tabela_10['Liga'] == 'IND') | (tabela_10['Liga'] == 'INDO') | (tabela_10['Liga'] == 'ITA1') | (tabela_10['Liga'] == 'ITA2') 
            | (tabela_10['Liga'] == 'JAP') | (tabela_10['Liga'] == 'KOR') | (tabela_10['Liga'] == 'MEX') | (tabela_10['Liga'] == 'MOR') 
            | (tabela_10['Liga'] == 'NOR') | (tabela_10['Liga'] == 'PAR') | (tabela_10['Liga'] == 'PER') | (tabela_10['Liga'] == 'POL') 
            | (tabela_10['Liga'] == 'POR1') | (tabela_10['Liga'] == 'POR2') | (tabela_10['Liga'] == 'QAT') | (tabela_10['Liga'] == 'ROM') 
            | (tabela_10['Liga'] == 'RUS') | (tabela_10['Liga'] == 'SAUD') | (tabela_10['Liga'] == 'SCT') | (tabela_10['Liga'] == 'SER') 
            | (tabela_10['Liga'] == 'SPA1') | (tabela_10['Liga'] == 'SPA2') | (tabela_10['Liga'] == 'SWE') | (tabela_10['Liga'] == 'SWZ') 
            | (tabela_10['Liga'] == 'TUR') | (tabela_10['Liga'] == 'UAE') | (tabela_10['Liga'] == 'UKR')  | (tabela_10['Liga'] == 'URU')
            | (tabela_10['Liga'] == 'USA') | (tabela_10['Liga'] == 'UZB') | (tabela_10['Liga'] == 'VEN')]

        tabela_9 = pd.merge(tabela_9, tabela_10[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_9 = tabela_9.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_9 = tabela_9.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'>Atacantes Referência </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_9, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_9).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_11 = pd.read_csv("21_Role_Atacante_Móvel_Full.csv")
        tabela_11 = tabela_11.loc[(tabela_11['Nacionalidade']==nacionalidade)&(tabela_11['Fim_Contrato']<=contrato)&(tabela_11['Versão_Temporada']==temporada)]   
        tabela_11 = tabela_11.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 27]]
        tabela_11 = tabela_11[(tabela_11['Liga'] == 'ARG1') | (tabela_11['Liga'] == 'AUS') | (tabela_11['Liga'] == 'AUT') 
            | (tabela_11['Liga'] == 'BEL1') | (tabela_11['Liga'] == 'BEL2') | (tabela_11['Liga'] == 'BOL') 
            | (tabela_11['Liga'] == 'BRA1') | (tabela_11['Liga'] == 'BRA2') | (tabela_11['Liga'] == 'BUL') | (tabela_11['Liga'] == 'CHI')
            | (tabela_11['Liga'] == 'CHN') | (tabela_11['Liga'] == 'COL') | (tabela_11['Liga'] == 'CRO') | (tabela_11['Liga'] == 'CZH')
            | (tabela_11['Liga'] == 'DEN') | (tabela_11['Liga'] == 'ECU') | (tabela_11['Liga'] == 'ENG1') | (tabela_11['Liga'] == 'ENG2') 
            | (tabela_11['Liga'] == 'FIN') | (tabela_11['Liga'] == 'FRA1') | (tabela_11['Liga'] == 'FRA2') | (tabela_11['Liga'] == 'GEO')  
            | (tabela_11['Liga'] == 'GER1') | (tabela_11['Liga'] == 'GER2') | (tabela_11['Liga'] == 'GRE') | (tabela_11['Liga'] == 'HOL') 
            | (tabela_11['Liga'] == 'IND') | (tabela_11['Liga'] == 'INDO') | (tabela_11['Liga'] == 'ITA1') | (tabela_11['Liga'] == 'ITA2') 
            | (tabela_11['Liga'] == 'JAP') | (tabela_11['Liga'] == 'KOR') | (tabela_11['Liga'] == 'MEX') | (tabela_11['Liga'] == 'MOR') 
            | (tabela_11['Liga'] == 'NOR') | (tabela_11['Liga'] == 'PAR') | (tabela_11['Liga'] == 'PER') | (tabela_11['Liga'] == 'POL') 
            | (tabela_11['Liga'] == 'POR1') | (tabela_11['Liga'] == 'POR2') | (tabela_11['Liga'] == 'QAT') | (tabela_11['Liga'] == 'ROM') 
            | (tabela_11['Liga'] == 'RUS') | (tabela_11['Liga'] == 'SAUD') | (tabela_11['Liga'] == 'SCT') | (tabela_11['Liga'] == 'SER') 
            | (tabela_11['Liga'] == 'SPA1') | (tabela_11['Liga'] == 'SPA2') | (tabela_11['Liga'] == 'SWE') | (tabela_11['Liga'] == 'SWZ') 
            | (tabela_11['Liga'] == 'TUR') | (tabela_11['Liga'] == 'UAE') | (tabela_11['Liga'] == 'UKR')  | (tabela_11['Liga'] == 'URU')
            | (tabela_11['Liga'] == 'USA') | (tabela_11['Liga'] == 'UZB') | (tabela_11['Liga'] == 'VEN')]

        tabela_12 = pd.read_csv("PlayerAnalysis_Role_21_Full.csv")
        tabela_12 = tabela_12.loc[(tabela_12['Nacionalidade']==nacionalidade)&(tabela_12['Fim_Contrato']<=contrato)&(tabela_12['Versão_Temporada']==temporada)]
        tabela_12 = tabela_12.iloc[:, np.r_[11, 28, 32:36]]
        tabela_12 = tabela_12[(tabela_12['Liga'] == 'ARG1') | (tabela_12['Liga'] == 'AUS') | (tabela_12['Liga'] == 'AUT') 
            | (tabela_12['Liga'] == 'BEL1') | (tabela_12['Liga'] == 'BEL2') | (tabela_12['Liga'] == 'BOL') 
            | (tabela_12['Liga'] == 'BRA1') | (tabela_12['Liga'] == 'BRA2') | (tabela_12['Liga'] == 'BUL') | (tabela_12['Liga'] == 'CHI')
            | (tabela_12['Liga'] == 'CHN') | (tabela_12['Liga'] == 'COL') | (tabela_12['Liga'] == 'CRO') | (tabela_12['Liga'] == 'CZH')
            | (tabela_12['Liga'] == 'DEN') | (tabela_12['Liga'] == 'ECU') | (tabela_12['Liga'] == 'ENG1') | (tabela_12['Liga'] == 'ENG2') 
            | (tabela_12['Liga'] == 'FIN') | (tabela_12['Liga'] == 'FRA1') | (tabela_12['Liga'] == 'FRA2') | (tabela_12['Liga'] == 'GEO')  
            | (tabela_12['Liga'] == 'GER1') | (tabela_12['Liga'] == 'GER2') | (tabela_12['Liga'] == 'GRE') | (tabela_12['Liga'] == 'HOL') 
            | (tabela_12['Liga'] == 'IND') | (tabela_12['Liga'] == 'INDO') | (tabela_12['Liga'] == 'ITA1') | (tabela_12['Liga'] == 'ITA2') 
            | (tabela_12['Liga'] == 'JAP') | (tabela_12['Liga'] == 'KOR') | (tabela_12['Liga'] == 'MEX') | (tabela_12['Liga'] == 'MOR') 
            | (tabela_12['Liga'] == 'NOR') | (tabela_12['Liga'] == 'PAR') | (tabela_12['Liga'] == 'PER') | (tabela_12['Liga'] == 'POL') 
            | (tabela_12['Liga'] == 'POR1') | (tabela_12['Liga'] == 'POR2') | (tabela_12['Liga'] == 'QAT') | (tabela_12['Liga'] == 'ROM') 
            | (tabela_12['Liga'] == 'RUS') | (tabela_12['Liga'] == 'SAUD') | (tabela_12['Liga'] == 'SCT') | (tabela_12['Liga'] == 'SER') 
            | (tabela_12['Liga'] == 'SPA1') | (tabela_12['Liga'] == 'SPA2') | (tabela_12['Liga'] == 'SWE') | (tabela_12['Liga'] == 'SWZ') 
            | (tabela_12['Liga'] == 'TUR') | (tabela_12['Liga'] == 'UAE') | (tabela_12['Liga'] == 'UKR')  | (tabela_12['Liga'] == 'URU')
            | (tabela_12['Liga'] == 'USA') | (tabela_12['Liga'] == 'UZB') | (tabela_12['Liga'] == 'VEN')]


        tabela_11 = pd.merge(tabela_11, tabela_12[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_11 = tabela_11.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})

        tabela_11 = tabela_11.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Atacantes Móveis </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_11, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_11).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()


        tabela_13 = pd.read_csv("22_Role_Segundo_Atacante_Full.csv")
        tabela_13 = tabela_13.loc[(tabela_13['Nacionalidade']==nacionalidade)&(tabela_13['Fim_Contrato']<=contrato)&(tabela_13['Versão_Temporada']==temporada)]   
        tabela_13 = tabela_13.iloc[:, np.r_[1, 3, 4, 7, 15, 9:12, 31]]
        tabela_13 = tabela_13[(tabela_13['Liga'] == 'ARG1') | (tabela_13['Liga'] == 'AUS') | (tabela_13['Liga'] == 'AUT') 
            | (tabela_13['Liga'] == 'BEL1') | (tabela_13['Liga'] == 'BEL2') | (tabela_13['Liga'] == 'BOL') 
            | (tabela_13['Liga'] == 'BRA1') | (tabela_13['Liga'] == 'BRA2') | (tabela_13['Liga'] == 'BUL') | (tabela_13['Liga'] == 'CHI')
            | (tabela_13['Liga'] == 'CHN') | (tabela_13['Liga'] == 'COL') | (tabela_13['Liga'] == 'CRO') | (tabela_13['Liga'] == 'CZH')
            | (tabela_13['Liga'] == 'DEN') | (tabela_13['Liga'] == 'ECU') | (tabela_13['Liga'] == 'ENG1') | (tabela_13['Liga'] == 'ENG2') 
            | (tabela_13['Liga'] == 'FIN') | (tabela_13['Liga'] == 'FRA1') | (tabela_13['Liga'] == 'FRA2') | (tabela_13['Liga'] == 'GEO')  
            | (tabela_13['Liga'] == 'GER1') | (tabela_13['Liga'] == 'GER2') | (tabela_13['Liga'] == 'GRE') | (tabela_13['Liga'] == 'HOL') 
            | (tabela_13['Liga'] == 'IND') | (tabela_13['Liga'] == 'INDO') | (tabela_13['Liga'] == 'ITA1') | (tabela_13['Liga'] == 'ITA2') 
            | (tabela_13['Liga'] == 'JAP') | (tabela_13['Liga'] == 'KOR') | (tabela_13['Liga'] == 'MEX') | (tabela_13['Liga'] == 'MOR') 
            | (tabela_13['Liga'] == 'NOR') | (tabela_13['Liga'] == 'PAR') | (tabela_13['Liga'] == 'PER') | (tabela_13['Liga'] == 'POL') 
            | (tabela_13['Liga'] == 'POR1') | (tabela_13['Liga'] == 'POR2') | (tabela_13['Liga'] == 'QAT') | (tabela_13['Liga'] == 'ROM') 
            | (tabela_13['Liga'] == 'RUS') | (tabela_13['Liga'] == 'SAUD') | (tabela_13['Liga'] == 'SCT') | (tabela_13['Liga'] == 'SER') 
            | (tabela_13['Liga'] == 'SPA1') | (tabela_13['Liga'] == 'SPA2') | (tabela_13['Liga'] == 'SWE') | (tabela_13['Liga'] == 'SWZ') 
            | (tabela_13['Liga'] == 'TUR') | (tabela_13['Liga'] == 'UAE') | (tabela_13['Liga'] == 'UKR')  | (tabela_13['Liga'] == 'URU')
            | (tabela_13['Liga'] == 'USA') | (tabela_13['Liga'] == 'UZB') | (tabela_13['Liga'] == 'VEN')]

        tabela_14 = pd.read_csv("PlayerAnalysis_Role_22_Full.csv")
        tabela_14 = tabela_14.loc[(tabela_14['Nacionalidade']==nacionalidade)&(tabela_14['Fim_Contrato']<=contrato)&(tabela_14['Versão_Temporada']==temporada)]
        tabela_14 = tabela_14.iloc[:, np.r_[15, 32, 36:40]]
        tabela_14 = tabela_14[(tabela_14['Liga'] == 'ARG1') | (tabela_14['Liga'] == 'AUS') | (tabela_14['Liga'] == 'AUT') 
            | (tabela_14['Liga'] == 'BEL1') | (tabela_14['Liga'] == 'BEL2') | (tabela_14['Liga'] == 'BOL') 
            | (tabela_14['Liga'] == 'BRA1') | (tabela_14['Liga'] == 'BRA2') | (tabela_14['Liga'] == 'BUL') | (tabela_14['Liga'] == 'CHI')
            | (tabela_14['Liga'] == 'CHN') | (tabela_14['Liga'] == 'COL') | (tabela_14['Liga'] == 'CRO') | (tabela_14['Liga'] == 'CZH')
            | (tabela_14['Liga'] == 'DEN') | (tabela_14['Liga'] == 'ECU') | (tabela_14['Liga'] == 'ENG1') | (tabela_14['Liga'] == 'ENG2') 
            | (tabela_14['Liga'] == 'FIN') | (tabela_14['Liga'] == 'FRA1') | (tabela_14['Liga'] == 'FRA2') | (tabela_14['Liga'] == 'GEO')  
            | (tabela_14['Liga'] == 'GER1') | (tabela_14['Liga'] == 'GER2') | (tabela_14['Liga'] == 'GRE') | (tabela_14['Liga'] == 'HOL') 
            | (tabela_14['Liga'] == 'IND') | (tabela_14['Liga'] == 'INDO') | (tabela_14['Liga'] == 'ITA1') | (tabela_14['Liga'] == 'ITA2') 
            | (tabela_14['Liga'] == 'JAP') | (tabela_14['Liga'] == 'KOR') | (tabela_14['Liga'] == 'MEX') | (tabela_14['Liga'] == 'MOR') 
            | (tabela_14['Liga'] == 'NOR') | (tabela_14['Liga'] == 'PAR') | (tabela_14['Liga'] == 'PER') | (tabela_14['Liga'] == 'POL') 
            | (tabela_14['Liga'] == 'POR1') | (tabela_14['Liga'] == 'POR2') | (tabela_14['Liga'] == 'QAT') | (tabela_14['Liga'] == 'ROM') 
            | (tabela_14['Liga'] == 'RUS') | (tabela_14['Liga'] == 'SAUD') | (tabela_14['Liga'] == 'SCT') | (tabela_14['Liga'] == 'SER') 
            | (tabela_14['Liga'] == 'SPA1') | (tabela_14['Liga'] == 'SPA2') | (tabela_14['Liga'] == 'SWE') | (tabela_14['Liga'] == 'SWZ') 
            | (tabela_14['Liga'] == 'TUR') | (tabela_14['Liga'] == 'UAE') | (tabela_14['Liga'] == 'UKR')  | (tabela_14['Liga'] == 'URU')
            | (tabela_14['Liga'] == 'USA') | (tabela_14['Liga'] == 'UZB') | (tabela_14['Liga'] == 'VEN')]

        tabela_13 = pd.merge(tabela_13, tabela_14[['Atleta', 'L_Rating', 'L_Ranking', 'L_Percentil', 'Size']], on="Atleta", how="left")
        tabela_13 = tabela_13.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Versão_Temporada':'Janela de Análise', 
                                            'L_Rating':'Rating', 'L_Ranking':'Ranking', 'L_Percentil':'Percentil', 'Size':'Qtde Atletas',
                                            'Valor_Mercado': 'Valor'})
        tabela_13 = tabela_13.sort_values(by='Rating', ascending=False)
        st.markdown("<h4 style='text-align: center;'><br><b>Segundos Atacantes </b></h4>", unsafe_allow_html=True)
        #st.dataframe(tabela_13, use_container_width=True, hide_index=True)

        # Styling DataFrame using Pandas
        def style_table(df):
            df = df.reset_index(drop=True)
            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
            formatter = {"Rating": "{:.3f}", "Idade": "{:.0f}"}  # Format the 'Rating' column to 3 decimal places
            #formatter = {"Idade": "{:.0f}"}
            return df.style.format(formatter).set_table_styles(
                [{
                    'selector': 'thead th',
                    'props': [('font-weight', 'bold'),
                            ('border-style', 'solid'),
                            ('border-width', '0px 0px 2px 0px'),
                            ('border-color', 'black')]
                }, {
                    'selector': 'thead th:not(:first-child)',
                    'props': [('text-align', 'center')]  # Centering all headers except the first
                }, {
                    'selector': 'thead th:last-child',
                    'props': [('color', 'black')]  # Make last column header black
                }, {
                    'selector': 'td',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'center')]
                }, {
                    'selector': 'th',
                    'props': [('border-style', 'solid'),
                            ('border-width', '0px 0px 1px 0px'),
                            ('border-color', 'black'),
                            ('text-align', 'left')]
                }]
            ).set_properties(**{'padding': '2px',
                                'font-size': '15px'})

        # Displaying in Streamlit
        def main():
            #st.title("Your DataFrame")

            # Convert the styled DataFrame to HTML without the index and display it
            styled_html = style_table(tabela_13).to_html(escape=False, index=False, hide_index=True)
            st.markdown(styled_html, unsafe_allow_html=True)

        if __name__ == '__main__':
            main()

###############################################################################################################################
###############################################################################################################################
###############################################################################################################################
###############################################################################################################################

if st.session_state.selected_option == "Sobre o APP":

    st.markdown("<h4 style='text-align: center;  color: black;'>Ligas cobertas pelo Aplicativo</b></h4>", unsafe_allow_html=True)
    st.markdown("---")

    st.set_page_config(layout="wide")
    #st.title("Ligas cobertas pelo Aplicativo")

    # ── 1. Carregar dados ────────────────────────────────────────────────
    df = pd.read_csv("cobertura_ligas.csv")

    # Agrupar Escócia junto com Inglaterra (ambos = GBR no mapa)
    df.loc[df["País"] == "Escócia", "País"] = "Inglaterra"    

    # ── 2. Mapeamento País → código ISO-3 (alpha-3) para o Plotly ───────
    PAIS_PARA_ISO3 = {
        "Argentina": "ARG",
        "Austrália": "AUS",
        "Áustria": "AUT",
        "Bélgica": "BEL",
        "Bolívia": "BOL",
        "Brasil": "BRA",
        "Bulgária": "BGR",
        "Canada": "CAN",
        "Chile": "CHL",
        "China": "CHN",
        "Colômbia": "COL",
        "Costa Rica": "CRI",
        "Croácia": "HRV",
        "Rep Tcheca": "CZE",
        "Dinamarca": "DNK",
        "Equador": "ECU",
        "Inglaterra": "GBR",
        "Finlândia": "FIN",
        "França": "FRA",
        "Georgia": "GEO",
        "Alemanha": "DEU",
        "Grécia": "GRC",
        "Holanda": "NLD",
        "Índia": "IND",
        "Indonésia": "IDN",
        "Itália": "ITA",
        "Japão": "JPN",
        "Coréia": "KOR",
        "México": "MEX",
        "Marrocos": "MAR",
        "Noruega": "NOR",
        "Paraguay": "PRY",
        "Peru": "PER",
        "Polônia": "POL",
        "Portugal": "PRT",
        "Qatar": "QAT",
        "Romênia": "ROU",
        "Rússia": "RUS",
        "Arábia Saudita": "SAU",
        "Escócia": "GBR",
        "Sérvia": "SRB",
        "Espanha": "ESP",
        "Suécia": "SWE",
        "Suiça": "CHE",
        "Turquia": "TUR",
        "Emirados Árabes Unidos": "ARE",
        "Ucrânia": "UKR",
        "Uruguay": "URY",
        "EUA": "USA",
        "Uzbequistão": "UZB",
        "Venezuela": "VEN",
    }

    df["iso_alpha3"] = df["País"].map(PAIS_PARA_ISO3)

    sem_mapa = df[df["iso_alpha3"].isna()]["País"].unique()
    if len(sem_mapa) > 0:
        st.warning(f"Países sem código ISO-3: {', '.join(sem_mapa)}")

    df = df.dropna(subset=["iso_alpha3"])

    # ── 3. Agrupar países com múltiplas ligas ────────────────────────────
    # Usa MAX para pegar a MENOR divisão (3 > 2 > 1), diferenciando cores
    df_agrupado = (
        df.groupby(["País", "iso_alpha3"])
        .agg(
            Divisão_max=("Divisão", "max"),
            Códigos=("Código", lambda x: ", ".join(sorted(x.unique()))),
            Ligas=("Liga", lambda x: " | ".join(x)),
            Divisões=("Divisão", lambda x: ", ".join(str(d) for d in sorted(x.unique()))),
        )
        .reset_index()
    )

    LABEL_DIVISAO = {1: "1ª Divisão", 2: "2ª Divisão", 3: "3ª Divisão"}
    df_agrupado["Divisão"] = df_agrupado["Divisão_max"].map(LABEL_DIVISAO)

    # ── 4. Plotar mapa ──────────────────────────────────────────────────
    cores = {
        "1ª Divisão": "#1a9641",   # verde
        "2ª Divisão": "#fdae61",   # laranja
        "3ª Divisão": "#d7191c",   # vermelho
    }

    fig = px.choropleth(
        df_agrupado,
        locations="iso_alpha3",
        color="Divisão",
        color_discrete_map=cores,
        category_orders={"Divisão": ["1ª Divisão", "2ª Divisão", "3ª Divisão"]},
        hover_name="País",
        hover_data={
            "Códigos": True,
            "Ligas": True,
            "Divisões": True,
            "iso_alpha3": False,
            "Divisão": False,
            "Divisão_max": False,
        },
        labels={
            "Códigos": "Código(s) no App",
            "Ligas": "Liga(s)",
            "Divisões": "Divisão(ões)",
        }
    )

    fig.update_layout(
        geo=dict(
            showframe=False,
            showcoastlines=True,
            coastlinecolor="gray",
            projection_type="natural earth",
            bgcolor="#f0f0f0",
        ),
        legend_title_text="Menor divisão coberta",
        #title_font_size=20,
        margin=dict(l=0, r=0, t=50, b=0),
        height=600,
    )

    # ── 5. Exibir no Streamlit (na própria tela) ────────────────────────
    st.plotly_chart(fig, use_container_width=True)

    st.markdown("---")
    st.markdown("<h4 style='text-align: center;  color: black;'>Sobre o APP</b></h4>", unsafe_allow_html=True)
    st.markdown("---")

    #Downloading Transparency Index Methodology
    button = st.link_button("Ranking de Jogadores", 'https://github.com/JAmerico1898/SoftPlayerz/blob/bf20a140c76a6bb59926e0e479262e87b246352a/Manuscrito%20-%20FAME.pdf', 
                              type="primary", use_container_width=True)
    def main2():

        # URL of the PDF document
        # Make sure to use a raw string for the file path
        pdf_url = 'https://github.com/JAmerico1898/SoftPlayerz/blob/bf20a140c76a6bb59926e0e479262e87b246352a/Manuscrito%20-%20FAME.pdf'

        # Button to open PDF in a new tab
        if st.link_button('Resumo da Metodologia'):
            # Open URL in a new tab using JavaScript
            js = f"window.open('{pdf_url}')"  # JavaScript to open a new window/tab
            st.markdown(f'<img src onerror="{js}">', unsafe_allow_html=True)

    if __name__ == '__main2__':
        main2()    

#####################################################################################################################
#####################################################################################################################
#####################################################################################################################
#####################################################################################################################


if st.session_state.selected_option == "Histórico de Performance":
    st.markdown("<h2 style='text-align: center;'>Histórico de Performance de Jogadores</h2>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center;'>2022-2025</h3>", unsafe_allow_html=True)
    jogadores = st.selectbox("Digite o nome do seu jogador. A grafia deve ser exata!", options=jogadores, index=None, placeholder="Jogador")
    if jogadores:
        #Determinar a Equipe
        df50 = df14.loc[(df14['Atleta']==jogadores)]
        equipes = df50['Equipe atual'].unique()
        equipe_atual = st.selectbox("Equipe em que o Jogador atua (Dezembro/2025)", options=equipes)
        if equipe_atual:
            performance_historica = df14.loc[(df14['Atleta']==jogadores) & (df14['Equipe atual']==equipe_atual)]
            unique_ids = performance_historica['ID'].unique()
            if len(unique_ids) != 1:
                ids = st.selectbox("Escolha o ID do Jogador.", options=unique_ids)
                if ids:
                    performance_historica = df14.loc[(df14['Atleta']==jogadores) & (df14['Equipe atual']==equipe_atual) & (df14['ID']==ids)]
                    st.markdown("<h4 style='text-align: center;'>Performance do Jogador</b></h4>", unsafe_allow_html=True)
                    st.markdown("<h5 style='text-align: center;'>Temporadas 2022-2025</b></h5>", unsafe_allow_html=True)
                    fontsize=25
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px; font-weight:bold'>{jogadores}</div>"
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    def plot_percentil_for_atleta(df, atleta_name):
                        # Filter the dataframe for the given Atleta
                        atleta_df = df[df['Atleta'] == atleta_name].copy()

                        # Replace 'nihil' in 'Percentil' with 0 and convert to numeric
                        atleta_df['Percentil'] = atleta_df['Percentil'].replace('nihil', 0).astype(float).astype(int)
                        atleta_df['Minutagem'] = atleta_df['Minutagem'].replace('nihil', 0).astype(float).astype(int)

                        # Group by Temporada to get the highest Percentil for each combination
                        atleta_df = atleta_df.groupby(['Temporada', 'Equipe', 'Liga', 'Perfil']).agg({
                            'Percentil': 'max',
                            'Ranking': 'max',  # Assuming the highest ranking is preferred
                            'Size': 'max',     # Assuming the highest size is preferred
                            'Minutagem': 'max',  # Keep max for calculating Minutagem
                        }).reset_index()

                        # Ensure Temporada is treated as an integer
                        atleta_df['Temporada'] = atleta_df['Temporada'].astype(int)
                        
                        # Sort the data by Temporada and Percentil (descending)
                        atleta_df_sorted = atleta_df.sort_values(by=['Temporada', 'Percentil', 'Equipe'], ascending=[True, False, True]).drop_duplicates(subset=['Temporada', 'Equipe'])

                        #First Club Detection
                        first_club = atleta_df_sorted.sort_values(by=['Temporada', 'Percentil'], ascending=[True, False]).drop_duplicates(subset=['Temporada'])

                        #Second Club Detection
                        # Convert DataFrames to sets of tuples
                        set_1 = set(atleta_df_sorted.itertuples(index=False, name=None))
                        set_2 = set(first_club.itertuples(index=False, name=None))

                        # Get the difference between the first set and the second set
                        difference_set = set_1 - set_2

                        # Convert the result back to a DataFrame
                        second_club = pd.DataFrame(list(difference_set), columns=atleta_df_sorted.columns)

                        # Plotting
                        fig, ax = plt.subplots(figsize=(10, 6))

                        prev_equipe = None
                        prev_temporada = None
                        prev_percentil = None

                        colors = ['blue', 'red', 'green', 'purple', 'orange']  # List of colors to alternate
                        color_index = 0

                        for i, row in first_club.iterrows():
                            temporada = row['Temporada']
                            equipe = row['Equipe']
                            percentil = row['Percentil']
                            ranking = row['Ranking']
                            size = row['Size']
                            minutagem = row['Minutagem']
                            liga = row['Liga']
                            perfil = row['Perfil']

                            # Change color based on team switch
                            if equipe != prev_equipe and prev_equipe is not None:
                                color_index = (color_index + 1) % len(colors)
                            color = colors[color_index]

                            # Plot the current point
                            ax.plot(temporada, percentil, 'o', color=color)
                            
                            # Annotate the current point
                            if perfil == 'nihil':
                                annotation = ""
                            else:
                                annotation = f"Percentil: {percentil}\nRanking: {ranking}/{size}\n{minutagem} min/jogo"
                            
                            ax.annotate(annotation, (temporada, percentil), textcoords="offset points", xytext=(0,15), ha='center', fontsize=11, color=color)

                            # Annotate Liga below the x-ticks based on Perfil
                            if perfil == 'nihil':
                                below_annotation = "<900min\n jogados"
                            else:
                                below_annotation = f"{liga}\n{equipe}\n{perfil}"
                            
                            ax.annotate(below_annotation, (temporada, 0), textcoords="offset points", xytext=(0,-55), ha='center', fontsize=11, color=color)

                            # Connect the current point with the previous point, if exists
                            if prev_temporada is not None:
                                ax.plot([prev_temporada, temporada], [prev_percentil, percentil], color=color)

                            # Update previous values
                            prev_equipe = equipe
                            prev_temporada = temporada
                            prev_percentil = percentil

                        # Add the second club's data points (loose points)
                        for i, row in second_club.iterrows():
                            temporada = row['Temporada']
                            equipe = row['Equipe']
                            percentil = row['Percentil']
                            ranking = row['Ranking']
                            size = row['Size']
                            minutagem = row['Minutagem']
                            liga = row['Liga']
                            perfil = row['Perfil']

                            if temporada in first_club['Temporada'].values and equipe != first_club[first_club['Temporada'] == temporada]['Equipe'].values[0]:
                                # Plot the second club's data point
                                ax.plot(temporada, percentil, 'o', color='black')  # Use a different color for the second club's data point
                                
                                # Annotate the second club's data point
                                annotation = f"Percentil: {percentil}\n{equipe}\n{perfil}\n{minutagem} min/jogo"
                                ax.annotate(annotation, (temporada, percentil), textcoords="offset points", xytext=(0,-50), ha='center', fontsize=11, color='black')

                        # Add labels and title
                        ax.set_ylabel('Percentil', fontsize=14, fontweight='bold')
                        ax.set_title(f'', pad=70)  # Increase the pad value to increase the distance
                        ax.set_ylim(0, 100)  # Set y-axis range from 0 to 100

                        # Adjust the left spine to create padding
                        ax.spines['left'].set_position(('outward', 18))  # Adjust this value as needed
                        ax.spines['left'].set_visible(False)
                        ax.set_xticks([2021, 2022, 2023, 2024])  # Set x-ticks to the desired years
                        ax.tick_params(axis='x', labelsize=12)
                        plt.setp(ax.get_xticklabels(), fontweight='bold')
                        ax.tick_params(axis='y', labelsize=12, length=0)
                        plt.setp(ax.get_yticklabels(), fontweight='bold')
                        ax.spines['top'].set_visible(False)
                        ax.spines['right'].set_visible(False)
                        st.pyplot(fig)

                    # Assuming performance_historica is already loaded and processed
                    # Replace 'ATLETA_NAME' with the actual name of the Atleta you want to plot
                    plot_percentil_for_atleta(performance_historica, jogadores)
            else:
                performance_historica = df14.loc[(df14['Atleta']==jogadores) & (df14['Equipe atual']==equipe_atual)]
                st.markdown("<h4 style='text-align: center;'>Performance do Jogador</b></h4>", unsafe_allow_html=True)
                st.markdown("<h5 style='text-align: center;'>Temporadas 2022-2025</b></h5>", unsafe_allow_html=True)
                fontsize=25
                markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px; font-weight:bold'>{jogadores}</div>"
                st.markdown(markdown_amount_1, unsafe_allow_html=True)
                st.markdown("---")

                def plot_percentil_for_atleta(df, atleta_name):
                    # Filter the dataframe for the given Atleta
                    atleta_df = df[df['Atleta'] == atleta_name].copy()

                    # Replace 'nihil' in 'Percentil' with 0 and convert to numeric
                    atleta_df['Percentil'] = atleta_df['Percentil'].replace('nihil', 0).astype(float).astype(int)
                    atleta_df['Minutagem'] = atleta_df['Minutagem'].replace('nihil', 0).astype(float).astype(int)

                    # Group by Temporada to get the highest Percentil for each combination
                    atleta_df = atleta_df.groupby(['Temporada', 'Equipe', 'Liga', 'Perfil']).agg({
                        'Percentil': 'max',
                        'Ranking': 'max',  # Assuming the highest ranking is preferred
                        'Size': 'max',     # Assuming the highest size is preferred
                        'Minutagem': 'max',  # Keep max for calculating Minutagem
                    }).reset_index()

                    # Ensure Temporada is treated as an integer
                    atleta_df['Temporada'] = atleta_df['Temporada'].astype(int)
                    
                    # Sort the data by Temporada and Percentil (descending)
                    atleta_df_sorted = atleta_df.sort_values(by=['Temporada', 'Percentil', 'Equipe'], ascending=[True, False, True]).drop_duplicates(subset=['Temporada', 'Equipe'])

                    #First Club Detection
                    first_club = atleta_df_sorted.sort_values(by=['Temporada', 'Percentil'], ascending=[True, False]).drop_duplicates(subset=['Temporada'])

                    #Second Club Detection
                    # Convert DataFrames to sets of tuples
                    set_1 = set(atleta_df_sorted.itertuples(index=False, name=None))
                    set_2 = set(first_club.itertuples(index=False, name=None))

                    # Get the difference between the first set and the second set
                    difference_set = set_1 - set_2

                    # Convert the result back to a DataFrame
                    second_club = pd.DataFrame(list(difference_set), columns=atleta_df_sorted.columns)

                    # Plotting
                    fig, ax = plt.subplots(figsize=(10, 6))

                    prev_equipe = None
                    prev_temporada = None
                    prev_percentil = None

                    colors = ['blue', 'red', 'green', 'purple', 'orange']  # List of colors to alternate
                    color_index = 0

                    for i, row in first_club.iterrows():
                        temporada = row['Temporada']
                        equipe = row['Equipe']
                        percentil = row['Percentil']
                        ranking = row['Ranking']
                        size = row['Size']
                        minutagem = row['Minutagem']
                        liga = row['Liga']
                        perfil = row['Perfil']

                        # Change color based on team switch
                        if equipe != prev_equipe and prev_equipe is not None:
                            color_index = (color_index + 1) % len(colors)
                        color = colors[color_index]

                        # Plot the current point
                        ax.plot(temporada, percentil, 'o', color=color)
                        
                        # Annotate the current point
                        if perfil == 'nihil':
                            annotation = ""
                        else:
                            annotation = f"Percentil: {percentil}\nRanking: {ranking}/{size}\n{minutagem} min/jogo"
                        
                        ax.annotate(annotation, (temporada, percentil), textcoords="offset points", xytext=(0,15), ha='center', fontsize=11, color=color)

                        # Annotate Liga below the x-ticks based on Perfil
                        if perfil == 'nihil':
                            below_annotation = "<900min\n jogados"
                        else:
                            below_annotation = f"{liga}\n{equipe}\n{perfil}"
                        
                        ax.annotate(below_annotation, (temporada, 0), textcoords="offset points", xytext=(0,-55), ha='center', fontsize=11, color=color)

                        # Connect the current point with the previous point, if exists
                        if prev_temporada is not None:
                            ax.plot([prev_temporada, temporada], [prev_percentil, percentil], color=color)

                        # Update previous values
                        prev_equipe = equipe
                        prev_temporada = temporada
                        prev_percentil = percentil

                    # Add the second club's data points (loose points)
                    for i, row in second_club.iterrows():
                        temporada = row['Temporada']
                        equipe = row['Equipe']
                        percentil = row['Percentil']
                        ranking = row['Ranking']
                        size = row['Size']
                        minutagem = row['Minutagem']
                        liga = row['Liga']
                        perfil = row['Perfil']

                        if temporada in first_club['Temporada'].values and equipe != first_club[first_club['Temporada'] == temporada]['Equipe'].values[0]:
                            # Plot the second club's data point
                            ax.plot(temporada, percentil, 'o', color='black')  # Use a different color for the second club's data point
                            
                            # Annotate the second club's data point
                            annotation = f"Percentil: {percentil}\n{equipe}\n{perfil}\n{minutagem} min/jogo"
                            ax.annotate(annotation, (temporada, percentil), textcoords="offset points", xytext=(0,-50), ha='center', fontsize=11, color='black')

                    # Add labels and title
                    ax.set_ylabel('Percentil', fontsize=14, fontweight='bold')
                    ax.set_title(f'', pad=70)  # Increase the pad value to increase the distance
                    ax.set_ylim(0, 100)  # Set y-axis range from 0 to 100

                    # Adjust the left spine to create padding
                    ax.spines['left'].set_position(('outward', 18))  # Adjust this value as needed
                    ax.spines['left'].set_visible(False)
                    ax.set_xticks([2022, 2023, 2024, 2025])  # Set x-ticks to the desired years
                    ax.tick_params(axis='x', labelsize=12)
                    plt.setp(ax.get_xticklabels(), fontweight='bold')
                    ax.tick_params(axis='y', labelsize=12, length=0)
                    plt.setp(ax.get_yticklabels(), fontweight='bold')
                    ax.spines['top'].set_visible(False)
                    ax.spines['right'].set_visible(False)
                    st.pyplot(fig)

                # Assuming performance_historica is already loaded and processed
                # Replace 'ATLETA_NAME' with the actual name of the Atleta you want to plot
                plot_percentil_for_atleta(performance_historica, jogadores)

###############################################################################################################################
###############################################################################################################################
###############################################################################################################################
###############################################################################################################################

if st.session_state.selected_option == "Ranking de Jogadores ":
    st.markdown("<h2 style='text-align: center;'>Ranking de Jogadores <span style='font-size: 0.7em; color: gold; font-weight: bold'>(Wyscout)</span></h2>", unsafe_allow_html=True)
    st.markdown("---")

    jogadores = st.selectbox("Digite o nome de seu jogador. A grafia deve ser exata!", options=jogadores, index=None, placeholder="Jogador")
    if jogadores:
        #Determinar Temporada
        df3 = df.loc[(df['Atleta']==jogadores)]
        temporadas = df3['Versão_Temporada'].unique()
        temporada = st.selectbox("Escolha a Temporada", options=temporadas)
        if temporada:
            #Determinar a Liga
            dfa = df3.loc[(df3['Versão_Temporada']==temporada)]
            ligas = dfa['Liga'].unique()
            liga = st.selectbox("Escolha a Liga", options=ligas)
            if liga:
                #Determinar a Equipe
                df4 = dfa.loc[(dfa['Liga']==liga)]
                equipes = df4['Equipe_Janela_Análise'].unique()
                equipe = st.selectbox("Escolha a Equipe", options=equipes)
                if equipe:
                    df5 = df4.loc[(df4['Equipe_Janela_Análise']==equipe)]
                    posição = df5['Posição'].unique()
                    posição = st.selectbox("Escolha a Posição", options=posição)
                    if posição == ("Goleiro"):
                        #####################################################################################################################
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # GOLEIRO CLÁSSICO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_1.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[9, 14, 26, 30:34, 28, 32, 11]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==0)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 9]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        #####################################################################################################################
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_1.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[9, 11, 15:21, 22:25, 14, 26, 28]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&(tabela_a['Código_Posição_Wyscout']==0)&
                                            (tabela_a['Versão_Temporada']==temporada)&
                                            (tabela_a['Liga']==liga)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            df = df.reset_index(drop=True)
                            
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(index=False, escape=False)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        #####################################################################################################################
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'><br>GOLEIRO CLÁSSICO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('1_Role_Goleiro.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:25, 6, 25, 27, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==0)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2  = tabela_2.iloc[:, np.r_[0:8]]
                        tabela_2 = tabela_2.rename(columns={'Interceptações.1':'Interceptações'})
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('1_Role_Goleiro.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:25, 6, 25, 27, 3]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==0)&(tabela_b['Versão_Temporada']==temporada)&
                                            (tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:8, 9]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_b = tabela_b.rename(columns={'Interceptações.1':'Interceptações'})
                        tabela_c = (tabela_b.groupby('Liga')[['Duelos_Aéreos_Ganhos', 'Defesas', 'Gols_Evitados', 'Saídas', 'Interceptações', 'xG_Evitado', 'Finalizações_por_Gol_Sofrido']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_1.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[48:55, 9, 14, 26, 28, 11]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&(tabela_d['Código_Posição_Wyscout']==0)&(tabela_d['Versão_Temporada']==temporada)&(tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:7]]
                        tabela_d = tabela_d.rename(columns={'Duelos_Aéreos_Ganhos_Percentil':'Duelos_Aéreos_Ganhos', 'Defesas_Percentil': 'Defesas', 
                                                            'Gols_Evitados_Percentil':'Gols_Evitados', 'Saídas_Percentil': 'Saídas', 
                                                            'Interceptações.1_Percentil': 'Interceptações', 'xG_Evitado_Percentil': 'xG_Evitado', 
                                                            'Finalizações_por_Gol_Sofrido_Percentil': 'Finalizações_por_Gol_Sofrido'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()
                        
                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada<br></h4>", unsafe_allow_html=True)


                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'


                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}

                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(

                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df
                        
                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)
                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']
                            
                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)



                        #####################################################################################################################
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_1_Mean_Charts = pd.read_csv('1_Role_Goleiro.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_1_Mean_Charts.iloc[:, np.r_[1, 3, 25, 27, 18:25]]
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Duelos_Aéreos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Aéreos_Ganhos'].mean()
                        Role_x_Mean_Charts['Defesas_LM'] = Role_x_Mean_Charts['Defesas'].mean()
                        Role_x_Mean_Charts['Gols_Evitados_LM'] = Role_x_Mean_Charts['Gols_Evitados'].mean()
                        Role_x_Mean_Charts['Saídas_LM'] = Role_x_Mean_Charts['Saídas'].mean()
                        Role_x_Mean_Charts['Interceptações_LM'] = Role_x_Mean_Charts['Interceptações.1'].mean()
                        Role_x_Mean_Charts['xG_Evitado_LM'] = Role_x_Mean_Charts['xG_Evitado'].mean()
                        Role_x_Mean_Charts['Finalizações_por_Gol_Sofrido_LM'] = Role_x_Mean_Charts['Finalizações_por_Gol_Sofrido'].mean()
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts = Role_y_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})

                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_1_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:11]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[11:18]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Duelos_Aéreos_Ganhos_LM':'Duelos_Aéreos_Ganhos', 'Defesas_LM': 'Defesas', 
                                                                    'Gols_Evitados_LM':'Gols_Evitados', 'Saídas_LM': 'Saídas',  
                                                                    'Interceptações_LM': 'Interceptações', 'xG_Evitado_LM': 'xG_Evitado', 
                                                                    'Finalizações_por_Gol_Sofrido_LM': 'Finalizações_por_Gol_Sofrido'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        Role_1_Mean_Charts = Role_1_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    
                        #Concatenating Dataframes
                        Role_1_Mean_Charts = pd.concat([Role_1_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_1_Mean_Charts = Role_1_Mean_Charts.append(League_Mean).reset_index()
                        Role_1_Mean_Charts = Role_1_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    
                        # Preparing the Graph
                        params = list(Role_1_Mean_Charts.columns)
                        params = params[1:]

                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_1_Mean_Charts['Atleta'])):
                            if Role_1_Mean_Charts['Atleta'][x] == jogadores:
                                a_values = Role_1_Mean_Charts.iloc[x].values.tolist()
                            if Role_1_Mean_Charts['Atleta'][x] == 'Média da Liga':
                                b_values = Role_1_Mean_Charts.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'
                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison.png', dpi=600, bbox_inches="tight")

                        #####################################################################################################################
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # GOLEIRO LÍBERO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_2.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[12, 17, 29, 33:37, 31, 35, 14]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==0)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 9]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'>GOLEIRO LÍBERO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_2_Mean_Charts = pd.read_csv('2_Role_Goleiro_Líbero.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_2_Mean_Charts.iloc[:, np.r_[1, 3, 28, 30, 18:28]]
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]
                        
                        Role_x_Mean_Charts['Duelos_Aéreos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Aéreos_Ganhos'].mean()
                        Role_x_Mean_Charts['Passes_Curtos_Médios_Certos_LM'] = Role_x_Mean_Charts['Passes_Curtos_Médios_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Defesas_LM'] = Role_x_Mean_Charts['Defesas'].mean()
                        Role_x_Mean_Charts['Gols_Evitados_LM'] = Role_x_Mean_Charts['Gols_Evitados'].mean()
                        Role_x_Mean_Charts['Saídas_LM'] = Role_x_Mean_Charts['Saídas'].mean()
                        Role_x_Mean_Charts['Interceptações_LM'] = Role_x_Mean_Charts['Interceptações.1'].mean()
                        Role_x_Mean_Charts['xG_Evitado_LM'] = Role_x_Mean_Charts['xG_Evitado'].mean()
                        Role_x_Mean_Charts['Finalizações_por_Gol_Sofrido_LM'] = Role_x_Mean_Charts['Finalizações_por_Gol_Sofrido'].mean()

                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts = Role_y_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})

                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_2_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:14]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[14:24]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Duelos_Aéreos_Ganhos_LM':'Duelos_Aéreos_Ganhos', 'Passes_Curtos_Médios_Certos_LM':'Passes_Curtos_Médios_Certos', 
                                                                'Passes_Longos_Certos_LM': 'Passes_Longos_Certos', 'Passes_Progressivos_Certos_LM': 'Passes_Progressivos_Certos',
                                                                'Defesas_LM': 'Defesas', 'Gols_Evitados_LM':'Gols_Evitados', 'Saídas_LM': 'Saídas',  
                                                                'Interceptações_LM': 'Interceptações', 'xG_Evitado_LM': 'xG_Evitado', 
                                                                'Finalizações_por_Gol_Sofrido_LM': 'Finalizações_por_Gol_Sofrido'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        Role_2_Mean_Charts = Role_2_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    
                        #Concatenating Dataframes
                        Role_2_Mean_Charts = pd.concat([Role_2_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_2_Mean_Charts = Role_2_Mean_Charts.append(League_Mean).reset_index()
                        
                        # Preparing the Graph
                        params = list(Role_2_Mean_Charts.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_2_Mean_Charts['Atleta'])):
                            if Role_2_Mean_Charts['Atleta'][x] == jogadores:
                                a_values = Role_2_Mean_Charts.iloc[x].values.tolist()
                            if Role_2_Mean_Charts['Atleta'][x] == 'Média da Liga':
                                b_values = Role_2_Mean_Charts.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison.png', dpi=600, bbox_inches="tight")
    #################################################################################################################################
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:14]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                            ###############################################################################################################################
                            ###############################################################################################################################
                            ###############################################################################################################################
                            ###############################################################################################################################

                    elif posição == ("Lateral"):
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # LATERAL DEFENSIVO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_3.csv')
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==1)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 9]
                        rating = tabela_1.iat[0, 28]
                        ranking = tabela_1.iat[0,29]
                        percentil = tabela_1.iat[0,31]
                        size = tabela_1.iat[0,30]
                        fontsize = 20
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_3.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[7, 9, 12, 13, 15:19, 20, 21, 24, 26]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&(tabela_a['Código_Posição_Wyscout']==1)&
                                            (tabela_a['Versão_Temporada']==temporada)&(tabela_a['Liga']==liga)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:2, 3:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)
                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format().set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        ##################################################################################################################### 
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'><br>LATERAL DEFENSIVO</b></h3>", unsafe_allow_html=True)
                        st.markdown("<h6 style='text-align: center;'>(Laterais D/E são ranqueados em conjunto)</b></h6>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # LATERAL OFENSIVO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_4.csv')
                        #tabela_1  = tabela_1.iloc[:, np.r_[17, 22, 34, 38:42, 36, 19]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==1)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 14]
                        rating = tabela_1.iat[0, 33]
                        ranking = tabela_1.iat[0,34]
                        percentil = tabela_1.iat[0,36]
                        size = tabela_1.iat[0,35]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>LATERAL OFENSIVO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # LATERAL EQUILIBRADO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_5.csv')
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==1)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 17]
                        rating = tabela_1.iat[0, 36]
                        ranking = tabela_1.iat[0,37]
                        percentil = tabela_1.iat[0,39]
                        size = tabela_1.iat[0,38]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>LATERAL EQUILIBRADO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('5_Role_Lateral_Equilibrado.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:31, 6, 31, 33, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&(tabela_2['Código_Posição_Wyscout']==1)&
                                            (tabela_2['Versão_Temporada']==temporada)&(tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2  = tabela_2.iloc[:, np.r_[0:14]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('5_Role_Lateral_Equilibrado.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:31, 6, 31, 33]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==1)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:14, 15]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos', 
                                                                'Ações_Ofensivas_BemSucedidas', 'Duelos_Ofensivos_Ganhos', 'Cruzamentos_Certos',
                                                                'Pisadas_Área', 'Dribles_BemSucedidos', 'Corridas_Progressivas', 
                                                                'Acelerações', 'xA', 'Passes_Inteligentes_Certos',  
                                                                'Deep_Completed_Crosses']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_5.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[66:79, 15, 20, 32, 34, 17]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            (tabela_d['Código_Posição_Wyscout']==1)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:14]]
                        tabela_d = tabela_d.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos_Percentil':'Duelos_Aéreos_Ganhos',
                                                                'Ações_Ofensivas_BemSucedidas_Percentil':'Ações_Ofensivas_BemSucedidas', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 'Cruzamentos_Certos_Percentil':'Cruzamentos_Certos',
                                                                'Pisadas_Área_Percentil':'Pisadas_Área', 'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 'Corridas_Progressivas_Percentil':'Corridas_Progressivas', 'Acelerações_Percentil':'Acelerações', 
                                                                'xA_Percentil':'xA', 'Passes_Inteligentes_Certos_Percentil':'Passes_Inteligentes_Certos', 
                                                                'Deep_Completed_Crosses_Percentil':'Deep_Completed_Crosses'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'


                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)


                        ##################################################################################################################### 
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################

                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_5_Mean_Charts = pd.read_csv('5_Role_Lateral_Equilibrado.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_5_Mean_Charts.iloc[:, np.r_[1, 3, 31, 33, 18:31]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]
                        
                        Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Defensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Defensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Duelos_Aéreos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Aéreos_Ganhos'].mean()
                        Role_x_Mean_Charts['Ações_Ofensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Ofensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Cruzamentos_Certos_LM'] = Role_x_Mean_Charts['Cruzamentos_Certos'].mean()
                        Role_x_Mean_Charts['Pisadas_Área_LM'] = Role_x_Mean_Charts['Pisadas_Área'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Corridas_Progressivas_LM'] = Role_x_Mean_Charts['Corridas_Progressivas'].mean()
                        Role_x_Mean_Charts['Acelerações_LM'] = Role_x_Mean_Charts['Acelerações'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Passes_Inteligentes_Certos_LM'] = Role_x_Mean_Charts['Passes_Inteligentes_Certos'].mean()
                        Role_x_Mean_Charts['Deep_Completed_Crosses_LM'] = Role_x_Mean_Charts['Deep_Completed_Crosses'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_5_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:17]]
                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[17:30]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Ações_Defensivas_BemSucedidas_LM':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_LM':'Duelos_Defensivos_Ganhos', 
                                                                'Duelos_Aéreos_Ganhos_LM':'Duelos_Aéreos_Ganhos',
                                                                'Ações_Ofensivas_BemSucedidas_LM':'Ações_Ofensivas_BemSucedidas', 
                                                                'Duelos_Ofensivos_Ganhos_LM': 'Duelos_Ofensivos_Ganhos', 'Cruzamentos_Certos_LM': 'Cruzamentos_Certos',
                                                                'Pisadas_Área_LM':'Pisadas_Área', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos',  
                                                                'Corridas_Progressivas_LM':'Corridas_Progressivas', 'Acelerações_LM': 'Acelerações', 'xA_LM':'xA',
                                                                'Passes_Inteligentes_Certos_LM': 'Passes_Inteligentes_Certos', 'Deep_Completed_Crosses_LM':'Deep_Completed_Crosses'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_5_Mean_Charts = pd.concat([Role_5_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_5_Mean_Charts = Role_5_Mean_Charts.append(League_Mean).reset_index()
                        #Splitting Columns
                        Role_5_Mean_Charts_1 = Role_5_Mean_Charts.iloc[:, np.r_[0, 1:7]]
                        Role_5_Mean_Charts_2 = Role_5_Mean_Charts.iloc[:, np.r_[0, 7:14]]
                        # Preparing Graph 1
                        # Get Parameters
                        params = list(Role_5_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_5_Mean_Charts_1['Atleta'])):
                            if Role_5_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_5_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_5_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_5_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_5_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_5_Mean_Charts_2['Atleta'])):
                            if Role_5_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_5_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_5_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_5_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        ##########################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:17]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                            #####################################################################################################################
                            #####################################################################################################################
                            ##################################################################################################################### 
                            #####################################################################################################################

                    elif posição == ("Zagueiro"):
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # ZAGUEIRO CLÁSSICO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_6.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[8, 13, 25, 29:33, 27, 10]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==4)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_6.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[8, 10, 14:20, 21:24, 13, 25, 27]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&(tabela_a['Código_Posição_Wyscout']==4)&
                                            (tabela_a['Versão_Temporada']==temporada)&(tabela_a['Liga']==liga)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            formatter = {"Idade": "{:.0f}"}
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format(formatter).set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        ##################################################################################################################### 
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'><br>ZAGUEIRO CLÁSSICO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # ZAGUEIRO CONSTRUTOR
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_7.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[12, 17, 29, 33:37, 31, 14]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==4)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>ZAGUEIRO CONSTRUTOR</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # ZAGUEIRO EQUILIBRADO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_8.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[15, 20, 32, 36:40, 34, 17]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==4)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>ZAGUEIRO EQUILIBRADO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('8_Role_Zagueiro_Equilibrado.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:31, 6, 31, 33, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==4)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2  = tabela_2.iloc[:, np.r_[0:14]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('8_Role_Zagueiro_Equilibrado.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:31, 6, 31, 33]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==4)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:14, 15]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos', 
                                                                'Finalizações_Bloqueadas', 'Interceptações_Ajustadas_a_Posse', 'Passes_Longos_Certos', 
                                                                'Passes_Frontais_Certos', 'Passes_Progressivos_Certos', 'Passes_Laterais_Certos', 'Duelos_Ofensivos_Ganhos', 
                                                                'Dribles_BemSucedidos', 'Corridas_Progressivas', 'Passes_TerçoFinal_Certos']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_8.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[66:79, 15, 20, 32, 34, 17]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Código_Posição_Wyscout']==4)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:13]]
                        tabela_d = tabela_d.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos_Percentil':'Duelos_Aéreos_Ganhos',
                                                            'Finalizações_Bloqueadas_Percentil':'Finalizações_Bloqueadas', 'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações_Ajustadas_a_Posse', 'Passes_Longos_Certos_Percentil':'Passes_Longos_Certos', 
                                                            'Passes_Frontais_Certos_Percentil':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_Percentil':'Passes_Progressivos_Certos', 'Passes_Laterais_Certos_Percentil':'Passes_Laterais_Certos', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 'Corridas_Progressivas_Percentil':'Corridas_Progressivas', 'Passes_TerçoFinal_Certos_Percentil':'Passes_TerçoFinal_Certos'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'


                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################

                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_8_Mean_Charts = pd.read_csv('8_Role_Zagueiro_Equilibrado.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_8_Mean_Charts.iloc[:, np.r_[1, 3, 31, 33, 18:31]]
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Defensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Defensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Duelos_Aéreos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Aéreos_Ganhos'].mean()
                        Role_x_Mean_Charts['Finalizações_Bloqueadas_LM'] = Role_x_Mean_Charts['Finalizações_Bloqueadas'].mean()
                        Role_x_Mean_Charts['Interceptações_Ajustadas_a_Posse_LM'] = Role_x_Mean_Charts['Interceptações_Ajustadas_a_Posse'].mean()
                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Frontais_Certos_LM'] = Role_x_Mean_Charts['Passes_Frontais_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Laterais_Certos_LM'] = Role_x_Mean_Charts['Passes_Laterais_Certos'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Corridas_Progressivas_LM'] = Role_x_Mean_Charts['Corridas_Progressivas'].mean()
                        Role_x_Mean_Charts['Passes_TerçoFinal_Certos_LM'] = Role_x_Mean_Charts['Passes_TerçoFinal_Certos'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)

                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_8_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:17]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[17:30]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Ações_Defensivas_BemSucedidas_LM':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_LM':'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos_LM':'Duelos_Aéreos_Ganhos',
                                                            'Finalizações_Bloqueadas_LM':'Finalizações_Bloqueadas', 'Interceptações_Ajustadas_a_Posse_LM':'Interceptações_Ajustadas_a_Posse', 'Passes_Longos_Certos_LM':'Passes_Longos_Certos', 
                                                            'Passes_Frontais_Certos_LM':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 'Passes_Laterais_Certos_LM':'Passes_Laterais_Certos', 'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 
                                                            'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 'Corridas_Progressivas_LM':'Corridas_Progressivas', 'Passes_TerçoFinal_Certos_LM':'Passes_TerçoFinal_Certos'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_8_Mean_Charts = pd.concat([Role_8_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_8_Mean_Charts = Role_8_Mean_Charts.append(League_Mean).reset_index()

                        #Splitting Columns
                        Role_8_Mean_Charts_1 = Role_8_Mean_Charts.iloc[:, np.r_[0, 1:8]]
    #                        st.dataframe(Role_8_Mean_Charts_1)
                        Role_8_Mean_Charts_2 = Role_8_Mean_Charts.iloc[:, np.r_[0, 8:14]]
    #                        st.dataframe(Role_8_Mean_Charts_2)

                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_8_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_8_Mean_Charts_1['Atleta'])):
                            if Role_8_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_8_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_8_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_8_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_8_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_8_Mean_Charts_2['Atleta'])):
                            if Role_8_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_8_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_8_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_8_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        ##########################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:17]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                            #####################################################################################################################
                            #####################################################################################################################
                            ##################################################################################################################### 
                            #####################################################################################################################
                    elif posição == ("Primeiro Volante"):
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # PRIMEIRO VOLANTE DEFENSIVO
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_9.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[6, 11, 23, 27:31, 25, 8]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==7)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_9.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[6, 8, 12:18, 19:22, 11, 23, 25]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&(tabela_a['Código_Posição_Wyscout']==7)&
                                            (tabela_a['Versão_Temporada']==temporada)&(tabela_a['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            formatter = {"Idade": "{:.0f}"}
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format(formatter).set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        ##################################################################################################################### 
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'><br>PRIMEIRO VOLANTE DEFENSIVO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        #####################################################################################################################
                        #####################################################################################################################
                        #####################################################################################################################
                        #####################################################################################################################

                        # PRIMEIRO VOLANTE CONSTRUTOR
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_10.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[11, 16, 28, 32:36, 30, 13]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==7)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>PRIMEIRO VOLANTE CONSTRUTOR</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # PRIMEIRO VOLANTE EQUILIBRADO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_11.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[13, 18, 30, 34:38, 32, 15]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==7)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>PRIMEIRO VOLANTE EQUILIBRADO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('11_Role_Volante_Equilibrado.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:29, 6, 29, 31, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==7)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2  = tabela_2.iloc[:, np.r_[0:12]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('11_Role_Volante_Equilibrado.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:29, 6, 29, 31]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==7)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:12, 13]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos', 
                                                                'Passes_Longos_Certos', 'Passes_Frontais_Certos', 'Passes_Progressivos_Certos', 
                                                                'Ações_Ofensivas_BemSucedidas', 'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos', 
                                                                'Corridas_Progressivas', 'Passes_TerçoFinal_Certos']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_11.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[60:71, 13, 18, 30, 32, 15]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            (tabela_d['Código_Posição_Wyscout']==7)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:12]]
                        tabela_d = tabela_d.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos_Percentil':'Duelos_Aéreos_Ganhos',
                                                            'Passes_Longos_Certos_Percentil':'Passes_Longos_Certos', 'Passes_Frontais_Certos_Percentil':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_Percentil':'Passes_Progressivos_Certos',
                                                            'Ações_Ofensivas_BemSucedidas_Percentil':'Ações_Ofensivas_BemSucedidas', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos',
                                                            'Corridas_Progressivas_Percentil':'Corridas_Progressivas', 'Passes_TerçoFinal_Certos_Percentil':'Passes_TerçoFinal_Certos'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2 = tabela_2.transpose()
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################

                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_11_Mean_Charts = pd.read_csv('11_Role_Volante_Equilibrado.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_11_Mean_Charts.iloc[:, np.r_[1, 3, 29, 31, 18:29]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Defensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Defensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Duelos_Aéreos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Aéreos_Ganhos'].mean()
                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Frontais_Certos_LM'] = Role_x_Mean_Charts['Passes_Frontais_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Ações_Ofensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Ofensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Corridas_Progressivas_LM'] = Role_x_Mean_Charts['Corridas_Progressivas'].mean()
                        Role_x_Mean_Charts['Passes_TerçoFinal_Certos_LM'] = Role_x_Mean_Charts['Passes_TerçoFinal_Certos'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)

                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_11_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:15]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[15:26]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Ações_Defensivas_BemSucedidas_LM':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_LM':'Duelos_Defensivos_Ganhos', 'Duelos_Aéreos_Ganhos_LM':'Duelos_Aéreos_Ganhos',
                                                            'Passes_Longos_Certos_LM':'Passes_Longos_Certos', 'Passes_Frontais_Certos_LM':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 
                                                            'Ações_Ofensivas_BemSucedidas_LM':'Ações_Ofensivas_BemSucedidas', 'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 
                                                            'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 'Corridas_Progressivas_LM':'Corridas_Progressivas', 'Passes_TerçoFinal_Certos_LM':'Passes_TerçoFinal_Certos'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_11_Mean_Charts = pd.concat([Role_11_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_11_Mean_Charts = Role_11_Mean_Charts.append(League_Mean).reset_index()

                        #Splitting Columns
                        Role_11_Mean_Charts_1 = Role_11_Mean_Charts.iloc[:, np.r_[0, 1:7]]
                        Role_11_Mean_Charts_2 = Role_11_Mean_Charts.iloc[:, np.r_[0, 7:12]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_11_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_11_Mean_Charts_1['Atleta'])):
                            if Role_11_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_11_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_11_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_11_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_11_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_11_Mean_Charts_2['Atleta'])):
                            if Role_11_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_11_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_11_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_11_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        ##########################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:15]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                            #####################################################################################################################
                            #####################################################################################################################
                            ##################################################################################################################### 
                            #####################################################################################################################
                    elif posição == ("Segundo Volante"):
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # SEGUNDO VOLANTE BOX TO BOX
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_12.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[15, 20, 32, 36:40, 34, 17]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==8)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        #####################################################################################################################
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_12.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[15, 17, 21:27, 28:31, 20, 32, 34]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&(tabela_a['Código_Posição_Wyscout']==8)&
                                            (tabela_a['Versão_Temporada']==temporada)&(tabela_a['Liga']==liga)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            formatter = {"Idade": "{:.0f}"}
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format(formatter).set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        #####################################################################################################################
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'>SEGUNDO VOLANTE BOX TO BOX</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # SEGUNDO VOLANTE ORGANIZADOR
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_13.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[12, 17, 29, 33:37, 31, 14]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==8)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>SEGUNDO VOLANTE ORGANIZADOR</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # SEGUNDO VOLANTE EQUILIBRADO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_14.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[15, 20, 32, 36:40, 34, 17]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==8)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>SEGUNDO VOLANTE EQUILIBRADO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('14_Role_Segundo_Volante_Equilibrado.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:31, 6, 31, 33, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==8)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2  = tabela_2.iloc[:, np.r_[0:14]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('14_Role_Segundo_Volante_Equilibrado.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:31, 6, 31, 33]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==8)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:14, 15]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos', 'Passes_Longos_Certos', 'Passes_Progressivos_Certos', 'Pisadas_Área',
                                                                'Dribles_BemSucedidos', 'Corridas_Progressivas', 'xG', 'xA', 'Assistência_Finalização', 'Passes_TerçoFinal_Certos',
                                                                'Deep_Completions', 'Passes_ÁreaPênalti_Certos']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_14.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[66:79, 15, 20, 32, 34, 17]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            (tabela_d['Código_Posição_Wyscout']==8)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:13]]
                        tabela_d = tabela_d.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos_Defensivos_Ganhos', 
                                                            'Passes_Longos_Certos_Percentil':'Passes_Longos_Certos', 'Passes_Progressivos_Certos_Percentil':'Passes_Progressivos_Certos',
                                                            'Pisadas_Área_Percentil':'Pisadas_Área', 'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 
                                                            'Corridas_Progressivas_Percentil':'Corridas_Progressivas', 'xG_Percentil':'xG', 'xA_Percentil':'xA', 
                                                            'Assistência_Finalização_Percentil':'Assistência_Finalização', 'Passes_TerçoFinal_Certos_Percentil':'Passes_TerçoFinal_Certos',
                                                            'Deep_Completions_Percentil':'Deep_Completions', 'Passes_ÁreaPênalti_Certos_Percentil':'Passes_ÁreaPênalti_Certos'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()
                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering
                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_14_Mean_Charts = pd.read_csv('14_Role_Segundo_Volante_Equilibrado.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_14_Mean_Charts.iloc[:, np.r_[1, 3, 31, 33, 18:31]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Defensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Defensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Pisadas_Área_LM'] = Role_x_Mean_Charts['Pisadas_Área'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Corridas_Progressivas_LM'] = Role_x_Mean_Charts['Corridas_Progressivas'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        Role_x_Mean_Charts['Passes_TerçoFinal_Certos_LM'] = Role_x_Mean_Charts['Passes_TerçoFinal_Certos'].mean()
                        Role_x_Mean_Charts['Deep_Completions_LM'] = Role_x_Mean_Charts['Deep_Completions'].mean()
                        Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos_LM'] = Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)

                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_14_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:17]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[17:30]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Ações_Defensivas_BemSucedidas_LM':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_LM':'Duelos_Defensivos_Ganhos',
                                                            'Passes_Longos_Certos_LM':'Passes_Longos_Certos', 'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 
                                                            'Pisadas_Área_LM':'Pisadas_Área', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 'Corridas_Progressivas_LM':'Corridas_Progressivas', 
                                                            'xA_LM':'xA', 'xG_LM':'xG','Assistência_Finalização_LM':'Assistência_Finalização', 'Passes_TerçoFinal_Certos_LM':'Passes_TerçoFinal_Certos', 
                                                            'Deep_Completions_LM':'Deep_Completions', 'Passes_ÁreaPênalti_Certos_LM':'Passes_ÁreaPênalti_Certos'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_14_Mean_Charts = pd.concat([Role_14_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_14_Mean_Charts = Role_14_Mean_Charts.append(League_Mean).reset_index()

                        #Splitting Columns
                        Role_14_Mean_Charts_1 = Role_14_Mean_Charts.iloc[:, np.r_[0, 1:8]]
                        Role_14_Mean_Charts_2 = Role_14_Mean_Charts.iloc[:, np.r_[0, 8:14]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_14_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_14_Mean_Charts_1['Atleta'])):
                            if Role_14_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_14_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_14_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_14_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_14_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_14_Mean_Charts_2['Atleta'])):
                            if Role_14_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_14_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_14_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_14_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_2.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_2.png', dpi=600, bbox_inches="tight")

                        ##########################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:17]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                            #####################################################################################################################
                            #####################################################################################################################
                            ##################################################################################################################### 
                            #####################################################################################################################
                    elif posição == ("Meia"):
                        #####################################################################################################################
                        #####################################################################################################################
                        # MEIA ORGANIZADOR
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_15.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[12, 17, 29, 33:37, 31, 14]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==9)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        #####################################################################################################################
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_15.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[12, 14, 19:24, 25:28, 17, 29, 31]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&(tabela_a['Código_Posição_Wyscout']==9)&
                                            (tabela_a['Versão_Temporada']==temporada)&(tabela_a['Liga']==liga)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)
                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            formatter = {"Idade": "{:.0f}"}
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format(formatter).set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        #####################################################################################################################
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'>MEIA ORGANIZADOR</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('15_Role_Meia_Organizador.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:28, 6, 28, 30, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==9)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2  = tabela_2.iloc[:, np.r_[0:11]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('15_Role_Meia_Organizador.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:28, 6, 28, 30]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==9)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[0:11, 12]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Passes_Longos_Certos', 'Passes_Frontais_Certos', 'Passes_Progressivos_Certos',
                                                                'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos', 'xA', 'Assistência_Finalização',
                                                                'Passes_TerçoFinal_Certos', 'Passes_EntreLinhas_Certos', 'Passes_Chave',]].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_15.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[57:67, 12, 17, 29, 31, 14]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            (tabela_d['Código_Posição_Wyscout']==9)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:10]]
                        tabela_d = tabela_d.rename(columns={'Passes_Longos_Certos_Percentil':'Passes_Longos_Certos', 'Passes_Frontais_Certos_Percentil':'Passes_Frontais_Certos',
                                                            'Passes_Progressivos_Certos_Percentil': 'Passes_Progressivos_Certos', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 'xA_Percentil':'xA', 'Assistência_Finalização_Percentil':'Assistência_Finalização',
                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes_TerçoFinal_Certos', 'Passes_EntreLinhas_Certos_Percentil':'Passes_EntreLinhas_Certos',
                                                            'Passes_Chave_Percentil':'Passes_Chave'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'


                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}

                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_15_Mean_Charts = pd.read_csv('15_Role_Meia_Organizador.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_15_Mean_Charts.iloc[:, np.r_[1, 3, 28, 30, 18:28]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Frontais_Certos_LM'] = Role_x_Mean_Charts['Passes_Frontais_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        Role_x_Mean_Charts['Passes_TerçoFinal_Certos_LM'] = Role_x_Mean_Charts['Passes_TerçoFinal_Certos'].mean()
                        Role_x_Mean_Charts['Passes_EntreLinhas_Certos_LM'] = Role_x_Mean_Charts['Passes_EntreLinhas_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Chave_LM'] = Role_x_Mean_Charts['Passes_Chave'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)

                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_15_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:14]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[14:24]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Passes_Longos_Certos_LM':'Passes_Longos_Certos', 'Passes_Frontais_Certos_LM':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 
                                                            'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 'xA_LM':'xA', 
                                                            'Assistência_Finalização_LM':'Assistência_Finalização', 'Passes_TerçoFinal_Certos_LM':'Passes_TerçoFinal_Certos', 
                                                            'Passes_EntreLinhas_Certos_LM':'Passes_EntreLinhas_Certos', 'Passes_Chave_LM':'Passes_Chave'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_15_Mean_Charts = pd.concat([Role_15_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_15_Mean_Charts = Role_15_Mean_Charts.append(League_Mean).reset_index()

                        #Splitting Columns
                        Role_15_Mean_Charts_1 = Role_15_Mean_Charts.iloc[:, np.r_[0, 1:6]]
                        Role_15_Mean_Charts_2 = Role_15_Mean_Charts.iloc[:, np.r_[0, 6:11]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_15_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_15_Mean_Charts_1['Atleta'])):
                            if Role_15_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_15_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_15_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_15_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_15_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_15_Mean_Charts_2['Atleta'])):
                            if Role_15_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_15_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_15_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_15_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_2.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_2.png', dpi=600, bbox_inches="tight")

    ####################################################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:14]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                        #####################################################################################################################
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # MEIA ATACANTE
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_16.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[19, 24, 36, 40:44, 38, 21]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&(tabela_1['Código_Posição_Wyscout']==9)&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>MEIA ATACANTE</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('16_Role_Meia_Atacante.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:35, 6, 35, 37, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&(tabela_2['Código_Posição_Wyscout']==9)&
                                            (tabela_2['Versão_Temporada']==temporada)&(tabela_2['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        tabela_2 = tabela_2.iloc[:, np.r_[0:18]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('16_Role_Meia_Atacante.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:35, 6, 35, 37]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==9)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[0:18, 19]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Passes_Longos_Certos', 'Passes_Frontais_Certos', 'Passes_Progressivos_Certos',
                                                                'Duelos_Ofensivos_Ganhos', 'Pisadas_Área', 'Dribles_BemSucedidos', 'xG', 'Finalizações_NoAlvo',
                                                                'Ameaça_Ofensiva', 'xA', 'Assistência_Finalização', 'Passes_TerçoFinal_Certos', 
                                                                'Passes_Inteligentes_Certos', 'Passes_EntreLinhas_Certos', 'Deep_Completions', 'Passes_Chave',
                                                                'Passes_ÁreaPênalti_Certos']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_16.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[78:95, 19, 24, 36, 38]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&(tabela_d['Código_Posição_Wyscout']==9)&(tabela_d['Versão_Temporada']==temporada)&(tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:17]]
                        tabela_d = tabela_d.rename(columns={'Passes_Longos_Certos_Percentil':'Passes_Longos_Certos', 'Passes_Frontais_Certos_Percentil':'Passes_Frontais_Certos',
                                                            'Passes_Progressivos_Certos_Percentil': 'Passes_Progressivos_Certos', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 
                                                            'Pisadas_Área_Percentil':'Pisadas_Área', 'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 'xG_Percentil':'xG', 
                                                            'Finalizações_NoAlvo_Percentil':'Finalizações_NoAlvo', 'Ameaça_Ofensiva_Percentil':'Ameaça_Ofensiva', 'xA_Percentil':'xA',
                                                            'Assistência_Finalização_Percentil':'Assistência_Finalização', 'Passes_TerçoFinal_Certos_Percentil':'Passes_TerçoFinal_Certos', 
                                                            'Passes_Inteligentes_Certos_Percentil':'Passes_Inteligentes_Certos', 'Passes_EntreLinhas_Certos_Percentil':'Passes_EntreLinhas_Certos',
                                                            'Deep_Completions_Percentil':'Deep_Completions', 'Passes_Chave_Percentil':'Passes_Chave', 'Passes_ÁreaPênalti_Certos_Percentil':'Passes_ÁreaPênalti_Certos'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}

                
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering
                        
                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_16_Mean_Charts = pd.read_csv('16_Role_Meia_Atacante.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_16_Mean_Charts.iloc[:, np.r_[1, 3, 35, 37, 18:35]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Frontais_Certos_LM'] = Role_x_Mean_Charts['Passes_Frontais_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Pisadas_Área_LM'] = Role_x_Mean_Charts['Pisadas_Área'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['Finalizações_NoAlvo_LM'] = Role_x_Mean_Charts['Finalizações_NoAlvo'].mean()
                        Role_x_Mean_Charts['Ameaça_Ofensiva_LM'] = Role_x_Mean_Charts['Ameaça_Ofensiva'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        Role_x_Mean_Charts['Passes_TerçoFinal_Certos_LM'] = Role_x_Mean_Charts['Passes_TerçoFinal_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Inteligentes_Certos_LM'] = Role_x_Mean_Charts['Passes_Inteligentes_Certos'].mean()
                        Role_x_Mean_Charts['Passes_EntreLinhas_Certos_LM'] = Role_x_Mean_Charts['Passes_EntreLinhas_Certos'].mean()
                        Role_x_Mean_Charts['Deep_Completions_LM'] = Role_x_Mean_Charts['Deep_Completions'].mean()
                        Role_x_Mean_Charts['Passes_Chave_LM'] = Role_x_Mean_Charts['Passes_Chave'].mean()
                        Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos_LM'] = Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_16_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:21]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[21:38]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Passes_Longos_Certos_LM':'Passes_Longos_Certos', 'Passes_Frontais_Certos_LM':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 
                                                            'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'Pisadas_Área_LM':'Pisadas_Área', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 'xG_LM':'xG',  
                                                            'Finalizações_NoAlvo_LM':'Finalizações_NoAlvo', 'Ameaça_Ofensiva_LM':'Ameaça_Ofensiva', 'xA_LM':'xA', 'Assistência_Finalização_LM':'Assistência_Finalização', 'Passes_TerçoFinal_Certos_LM':'Passes_TerçoFinal_Certos', 
                                                            'Passes_Inteligentes_Certos_LM':'Passes_Inteligentes_Certos', 'Passes_EntreLinhas_Certos_LM':'Passes_EntreLinhas_Certos', 'Deep_Completions_LM':'Deep_Completions', 
                                                            'Passes_Chave_LM':'Passes_Chave', 'Passes_ÁreaPênalti_Certos_LM':'Passes_ÁreaPênalti_Certos'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_16_Mean_Charts = pd.concat([Role_16_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_16_Mean_Charts = Role_16_Mean_Charts.append(League_Mean).reset_index()
                        #Role_16_Mean_Charts = Role_16_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    

                        #Splitting Columns
                        Role_16_Mean_Charts_1 = Role_16_Mean_Charts.iloc[:, np.r_[0, 1:10]]
                        Role_16_Mean_Charts_2 = Role_16_Mean_Charts.iloc[:, np.r_[0, 10:18]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_16_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_16_Mean_Charts_1['Atleta'])):
                            if Role_16_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_16_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_16_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_16_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_16_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_16_Mean_Charts_2['Atleta'])):
                            if Role_16_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_16_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_16_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_16_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_2.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_2.png', dpi=600, bbox_inches="tight")

                        ##########################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique", key="mais_graficos_key")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:21]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)



                        #####################################################################################################################
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################
                    elif posição == ("Extremo"):
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # EXTREMO ORGANIZADOR
                        # Texto de Abertura
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_17.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[15, 20, 32, 36:40, 34, 17]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_1['Código_Posição_Wyscout']==10)|(tabela_1['Código_Posição_Wyscout']==11))&
                                            (tabela_1['Versão_Temporada']==temporada)&(tabela_1['Liga']==liga)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        ##################################################################################################################### 
                        #####################################################################################################################
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_17.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[15, 17, 21:27, 28:31, 20, 32, 34]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_a['Código_Posição_Wyscout']==10)|(tabela_a['Código_Posição_Wyscout']==11))&
                                            (tabela_a['Versão_Temporada']==temporada)&
                                            (tabela_a['Liga']==liga)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            formatter = {"Idade": "{:.0f}"}
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format(formatter).set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>EXTREMO ORGANIZADOR</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('17_Role_Extremo_Organizador.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:31, 6, 31, 33, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_2['Código_Posição_Wyscout']==10)|(tabela_2['Código_Posição_Wyscout']==11))&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)]
                        tabela_2 = tabela_2.iloc[:, np.r_[0:14]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('17_Role_Extremo_Organizador.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:31, 6, 31, 33]]
                        tabela_b = tabela_b[((tabela_b['Código_Posição_Wyscout']==10)|(tabela_b['Código_Posição_Wyscout']==11))&
                                            (tabela_b['Versão_Temporada']==temporada)&
                                            (tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:14, 15]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Passes_Longos_Certos', 'Passes_Frontais_Certos', 'Passes_Progressivos_Certos',
                                                                'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos', 'xG', 'Finalizações_NoAlvo',
                                                                'Conversão_Gols', 'xA', 'Assistência_Finalização', 'Passes_Inteligentes_Certos', 
                                                                'Passes_EntreLinhas_Certos', 'Passes_Chave']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_17.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[66:79, 15, 20, 32, 34, 17]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_d['Código_Posição_Wyscout']==10)|(tabela_d['Código_Posição_Wyscout']==11))&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:14]]
                        tabela_d = tabela_d.rename(columns={'Passes_Longos_Certos_Percentil':'Passes_Longos_Certos', 'Passes_Frontais_Certos_Percentil':'Passes_Frontais_Certos',
                                                            'Passes_Progressivos_Certos_Percentil': 'Passes_Progressivos_Certos', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 'xG_Percentil':'xG', 'Finalizações_NoAlvo_Percentil':'Finalizações_NoAlvo', 
                                                            'Conversão_Gols_Percentil':'Conversão_Gols', 'xA_Percentil':'xA', 'Assistência_Finalização_Percentil':'Assistência_Finalização', 
                                                            'Passes_Inteligentes_Certos_Percentil':'Passes_Inteligentes_Certos', 'Passes_EntreLinhas_Certos_Percentil':'Passes_EntreLinhas_Certos',
                                                            'Passes_Chave_Percentil':'Passes_Chave'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering
                            return styled_df
                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_17_Mean_Charts = pd.read_csv('17_Role_Extremo_Organizador.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_17_Mean_Charts.iloc[:, np.r_[1, 3, 31, 33, 18:31]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Passes_Longos_Certos_LM'] = Role_x_Mean_Charts['Passes_Longos_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Frontais_Certos_LM'] = Role_x_Mean_Charts['Passes_Frontais_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['Finalizações_NoAlvo_LM'] = Role_x_Mean_Charts['Finalizações_NoAlvo'].mean()
                        Role_x_Mean_Charts['Conversão_Gols_LM'] = Role_x_Mean_Charts['Conversão_Gols'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        Role_x_Mean_Charts['Passes_Inteligentes_Certos_LM'] = Role_x_Mean_Charts['Passes_Inteligentes_Certos'].mean()
                        Role_x_Mean_Charts['Passes_EntreLinhas_Certos_LM'] = Role_x_Mean_Charts['Passes_EntreLinhas_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Chave_LM'] = Role_x_Mean_Charts['Passes_Chave'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_17_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:17]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[17:30]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Passes_Longos_Certos_LM':'Passes_Longos_Certos', 'Passes_Frontais_Certos_LM':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 
                                                            'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 'xG_LM':'xG',  
                                                            'Finalizações_NoAlvo_LM':'Finalizações_NoAlvo', 'Conversão_Gols_LM':'Conversão_Gols', 'xA_LM':'xA', 'Assistência_Finalização_LM':'Assistência_Finalização', 
                                                            'Passes_Inteligentes_Certos_LM':'Passes_Inteligentes_Certos', 'Passes_EntreLinhas_Certos_LM':'Passes_EntreLinhas_Certos', 
                                                            'Passes_Chave_LM':'Passes_Chave'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_17_Mean_Charts = pd.concat([Role_17_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_17_Mean_Charts = Role_17_Mean_Charts.append(League_Mean).reset_index()
                        #Role_17_Mean_Charts = Role_17_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    

                        #Splitting Columns
                        Role_17_Mean_Charts_1 = Role_17_Mean_Charts.iloc[:, np.r_[0, 1:8]]
                        Role_17_Mean_Charts_2 = Role_17_Mean_Charts.iloc[:, np.r_[0, 8:14]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_17_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_17_Mean_Charts_1['Atleta'])):
                            if Role_17_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_17_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_17_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_17_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_17_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_17_Mean_Charts_2['Atleta'])):
                            if Role_17_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_17_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_17_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_17_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_2.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_2.png', dpi=600, bbox_inches="tight")

                        ######################################################################################################################################
                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:17]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                        ##################################################################################################################### 
                        #####################################################################################################################
                        # EXTREMO TÁTICO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_18.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[9, 14, 26, 30:34, 28, 11]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_1['Código_Posição_Wyscout']==10)|(tabela_1['Código_Posição_Wyscout']==11))&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>EXTREMO TÁTICO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('18_Role_Extremo_Tático.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:25, 6, 25, 27, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_2['Código_Posição_Wyscout']==10)|(tabela_2['Código_Posição_Wyscout']==11))&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)]
                        tabela_2 = tabela_2.iloc[:, np.r_[0:8]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('18_Role_Extremo_Tático.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:25, 6, 25, 27]]
                        tabela_b = tabela_b[((tabela_b['Código_Posição_Wyscout']==10)|(tabela_b['Código_Posição_Wyscout']==11))&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:8, 9]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos', 'Passes_Frontais_Certos',
                                                                'Passes_Progressivos_Certos', 'Duelos_Ofensivos_Ganhos', 'xG', 'xA']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_18.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[48:55, 9, 14, 26, 28, 11]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_d['Código_Posição_Wyscout']==10)|(tabela_d['Código_Posição_Wyscout']==11))&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:7]]
                        tabela_d = tabela_d.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos_Defensivos_Ganhos', 
                                                            'Passes_Frontais_Certos_Percentil':'Passes_Frontais_Certos', 'Passes_Progressivos_Certos_Percentil': 'Passes_Progressivos_Certos', 
                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 'xG_Percentil':'xG', 'xA_Percentil':'xA'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}

                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_18_Mean_Charts = pd.read_csv('18_Role_Extremo_Tático.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_18_Mean_Charts.iloc[:, np.r_[1, 3, 25, 27, 18:25]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas_LM'] = Role_x_Mean_Charts['Ações_Defensivas_BemSucedidas'].mean()
                        Role_x_Mean_Charts['Duelos_Defensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Defensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Passes_Frontais_Certos_LM'] = Role_x_Mean_Charts['Passes_Frontais_Certos'].mean()
                        Role_x_Mean_Charts['Passes_Progressivos_Certos_LM'] = Role_x_Mean_Charts['Passes_Progressivos_Certos'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_18_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:11]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[11:18]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Ações_Defensivas_BemSucedidas_LM':'Ações_Defensivas_BemSucedidas', 'Duelos_Defensivos_Ganhos_LM':'Duelos_Defensivos_Ganhos', 'Passes_Frontais_Certos_LM':'Passes_Frontais_Certos', 
                                                            'Passes_Progressivos_Certos_LM':'Passes_Progressivos_Certos', 'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'xG_LM':'xG', 'xA_LM':'xA'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_18_Mean_Charts = pd.concat([Role_18_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_18_Mean_Charts = Role_18_Mean_Charts.append(League_Mean).reset_index()

                        #Splitting Columns
                        Role_18_Mean_Charts_1 = Role_18_Mean_Charts.iloc[:, np.r_[0, 1:8]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_18_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_18_Mean_Charts_1['Atleta'])):
                            if Role_18_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_18_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_18_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_18_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            #subtitle_name = clube,
                            #subtitle_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            #subtitle_name_2 = liga,
                            #subtitle_color_2 = '#344D94',
                            title_fontsize = 18,
                            #subtitle_fontsize = 15,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        #####################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique", key="mais_graficos_key")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:11]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)


                        #####################################################################################################################
                        #####################################################################################################################
                        # EXTREMO AGUDO
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_19.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[15, 20, 32, 36:40, 34, 17]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_1['Código_Posição_Wyscout']==10)|(tabela_1['Código_Posição_Wyscout']==11))&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>EXTREMO AGUDO</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('19_Role_Extremo_Agudo.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:31, 6, 31, 33, 3, 17]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)
                                            &((tabela_2['Código_Posição_Wyscout']==10)|(tabela_2['Código_Posição_Wyscout']==11))&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)]
                        tabela_2 = tabela_2.iloc[:, np.r_[0:14]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('19_Role_Extremo_Agudo.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:31, 6, 31, 33]]
                        tabela_b = tabela_b[((tabela_b['Código_Posição_Wyscout']==10)|(tabela_b['Código_Posição_Wyscout']==11))&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[0:14, 15]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Duelos_Ofensivos_Ganhos', 'Pisadas_Área', 'Dribles_BemSucedidos', 'Acelerações', 
                                                                'Passes_Longos_Recebidos', 'xG', 'Finalizações_NoAlvo', 'Conversão_Gols', 'xA', 
                                                                'Assistência_Finalização', 'Deep_Completions', 'Deep_Completed_Crosses', 'Passes_Chave']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_19.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[66:79, 15, 20, 32, 34, 17]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            ((tabela_d['Código_Posição_Wyscout']==10)|(tabela_d['Código_Posição_Wyscout']==11))&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:13]]
                        tabela_d = tabela_d.rename(columns={'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 'Pisadas_Área_Percentil':'Pisadas_Área', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 'Acelerações_Percentil':'Acelerações', 
                                                            'Passes_Longos_Recebidos_Percentil':'Passes_Longos_Recebidos', 'xG_Percentil':'xG', 'Finalizações_NoAlvo_Percentil':'Finalizações_NoAlvo', 
                                                            'Conversão_Gols_Percentil':'Conversão_Gols', 'xA_Percentil':'xA', 'Assistência_Finalização_Percentil':'Assistência_Finalização', 
                                                            'Deep_Completions_Percentil':'Deep_Completions', 'Deep_Completed_Crosses_Percentil':'Deep_Completed_Crosses', 
                                                            'Passes_Chave_Percentil':'Passes_Chave'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering

                            return styled_df
                    
                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        #####################################################################################################################
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_19_Mean_Charts = pd.read_csv('19_Role_Extremo_Agudo.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_19_Mean_Charts.iloc[:, np.r_[1, 3, 31, 33, 18:31]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Pisadas_Área_LM'] = Role_x_Mean_Charts['Pisadas_Área'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Acelerações_LM'] = Role_x_Mean_Charts['Acelerações'].mean()
                        Role_x_Mean_Charts['Passes_Longos_Recebidos_LM'] = Role_x_Mean_Charts['Passes_Longos_Recebidos'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['Finalizações_NoAlvo_LM'] = Role_x_Mean_Charts['Finalizações_NoAlvo'].mean()
                        Role_x_Mean_Charts['Conversão_Gols_LM'] = Role_x_Mean_Charts['Conversão_Gols'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        Role_x_Mean_Charts['Deep_Completions_LM'] = Role_x_Mean_Charts['Deep_Completions'].mean()
                        Role_x_Mean_Charts['Deep_Completed_Crosses_LM'] = Role_x_Mean_Charts['Deep_Completed_Crosses'].mean()
                        Role_x_Mean_Charts['Passes_Chave_LM'] = Role_x_Mean_Charts['Passes_Chave'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_19_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:17]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[17:30]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'Pisadas_Área_LM':'Pisadas_Área', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 
                                                                'Acelerações_LM':'Acelerações', 'Passes_Longos_Recebidos_LM':'Passes_Longos_Recebidos', 'xG_LM':'xG', 'Finalizações_NoAlvo_LM':'Finalizações_NoAlvo', 'Conversão_Gols_LM':'Conversão_Gols', 
                                                                'xA_LM':'xA', 'Assistência_Finalização_LM':'Assistência_Finalização', 'Deep_Completions_LM':'Deep_Completions', 'Deep_Completed_Crosses_LM':'Deep_Completed_Crosses', 
                                                                'Passes_Chave_LM':'Passes_Chave'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_19_Mean_Charts = pd.concat([Role_19_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_19_Mean_Charts = Role_19_Mean_Charts.append(League_Mean).reset_index()
                        #Role_19_Mean_Charts = Role_19_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    

                        #Splitting Columns
                        Role_19_Mean_Charts_1 = Role_19_Mean_Charts.iloc[:, np.r_[0, 1:8]]
                        Role_19_Mean_Charts_2 = Role_19_Mean_Charts.iloc[:, np.r_[0, 8:14]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_19_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_19_Mean_Charts_1['Atleta'])):
                            if Role_19_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_19_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_19_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_19_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_19_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_19_Mean_Charts_2['Atleta'])):
                            if Role_19_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_19_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_19_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_19_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_2.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_2.png', dpi=600, bbox_inches="tight")

                        ##########################################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique", key="2_mais_graficos_key")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:17]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)



                            #####################################################################################################################
                            #####################################################################################################################
                            #####################################################################################################################
                            ##################################################################################################################### 
                    elif posição == ("Atacante"):
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # ATACANTE REFERÊNCIA
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_20.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[12, 17, 29, 33:37, 31, 14]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==12)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Texto de Abertura
                        markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogadores:}</div>"
                        markdown_amount_2 = f"<div style='text-align:center; font-size:{fontsize}px'>{clube:}</div>"
                        st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_1, unsafe_allow_html=True)
                        st.markdown(markdown_amount_2, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # Dados Básicos do Jogador
                        tabela_a  = pd.read_csv("PlayerAnalysis_Role_20.csv")
                        tabela_a = tabela_a.iloc[:, np.r_[12, 14, 19:24, 25:28, 17, 29, 31]]
                        tabela_a = tabela_a[(tabela_a['Atleta']==jogadores)&
                                            (tabela_a['Código_Posição_Wyscout']==12)&
                                            (tabela_a['Versão_Temporada']==temporada)&
                                            (tabela_a['Liga']==liga)&
                                            (tabela_a['Equipe_Janela_Análise']==equipe)]
                        tabela_a  = tabela_a.iloc[:, np.r_[0:3, 4:10]]
                        st.markdown("<h4 style='text-align: center;'>Dados Básicos</b></h4>", unsafe_allow_html=True)
                        #st.dataframe(tabela_a, use_container_width=True, hide_index=True)

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index(drop=True)
                            df = df.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Valor_Mercado': 'Valor', 'Nacionalidade': 'Nacional'})
                            formatter = {"Idade": "{:.0f}"}
                            # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                            return df.style.format(formatter).set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px',
                                                'font-size': '15px'})

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML without the index and display it
                            styled_html = style_table(tabela_a).to_html(escape=False, index=False, hide_index=True)
                            st.markdown(styled_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()

                        #####################################################################################################################
                        #####################################################################################################################
                        st.markdown("<h3 style='text-align: center;'><br>ATACANTE REFERÊNCIA</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_20_Mean_Charts = pd.read_csv('20_Role_Atacante_Referência.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_20_Mean_Charts.iloc[:, np.r_[1, 3, 28, 30, 18:28]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Duelos_Aéreos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Aéreos_Ganhos'].mean()
                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['Conversão_Gols_LM'] = Role_x_Mean_Charts['Conversão_Gols'].mean()
                        Role_x_Mean_Charts['Conversão_xG_LM'] = Role_x_Mean_Charts['Conversão_xG'].mean()
                        Role_x_Mean_Charts['Ameaça_Ofensiva_LM'] = Role_x_Mean_Charts['Ameaça_Ofensiva'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Deep_Completions_LM'] = Role_x_Mean_Charts['Deep_Completions'].mean()
                        Role_x_Mean_Charts['Passes_Chave_LM'] = Role_x_Mean_Charts['Passes_Chave'].mean()
                        Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos_LM'] = Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_20_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:14]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[14:24]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Duelos_Aéreos_Ganhos_LM':'Duelos_Aéreos_Ganhos', 'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'xG_LM':'xG', 'Conversão_Gols_LM':'Conversão_Gols', 
                                                                'Conversão_xG_LM':'Conversão_xG', 'Ameaça_Ofensiva_LM':'Ameaça_Ofensiva', 'xA_LM':'xA', 'Deep_Completions_LM':'Deep_Completions',  
                                                                'Passes_Chave_LM':'Passes_Chave', 'Passes_ÁreaPênalti_Certos_LM':'Passes_ÁreaPênalti_Certos'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_20_Mean_Charts = pd.concat([Role_20_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_20_Mean_Charts = Role_20_Mean_Charts.append(League_Mean).reset_index()
                        #Role_20_Mean_Charts = Role_20_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    

                        #Splitting Columns
                        Role_20_Mean_Charts_1 = Role_20_Mean_Charts.iloc[:, np.r_[0, 1:11]]
                        #Role_20_Mean_Charts_2 = Role_20_Mean_Charts.iloc[:, np.r_[1, 9:15]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_20_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_20_Mean_Charts_1['Atleta'])):
                            if Role_20_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_20_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_20_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_20_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        #####################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:14]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)

                        ##################################################################################################################### 
                        #####################################################################################################################
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # SEGUNDO ATACANTE
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_22.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[15, 20, 32, 36:40, 34, 17]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==12)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>SEGUNDO ATACANTE</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('22_Role_Segundo_Atacante.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:31, 6, 31, 33, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==12)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2 = tabela_2.iloc[:, np.r_[0:14]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('22_Role_Segundo_Atacante.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:31, 6, 31, 33]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==12)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:14, 15]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos', 'Acelerações', 'xG', 
                                                                'Finalizações_NoAlvo', 'Conversão_Gols', 'Conversão_xG', 'Ameaça_Ofensiva', 'xA', 
                                                                'Assistência_Finalização', 'Deep_Completions', 'Passes_Chave', 'Passes_ÁreaPênalti_Certos']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_22.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[66:79, 15, 20, 32, 34, 17]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            (tabela_d['Código_Posição_Wyscout']==12)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:13]]
                        tabela_d = tabela_d.rename(columns={'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 
                                                            'Acelerações_Percentil':'Acelerações', 'xG_Percentil':'xG', 'Finalizações_NoAlvo_Percentil':'Finalizações_NoAlvo', 
                                                            'Conversão_Gols_Percentil':'Conversão_Gols', 'Conversão_xG_Percentil':'Conversão_xG', 
                                                            'Ameaça_Ofensiva_Percentil':'Ameaça_Ofensiva', 'xA_Percentil':'xA', 'Assistência_Finalização_Percentil':'Assistência_Finalização', 
                                                            'Deep_Completions_Percentil':'Deep_Completions', 'Passes_Chave_Percentil':'Passes_Chave', 
                                                            'Passes_ÁreaPênalti_Certos_Percentil':'Passes_ÁreaPênalti_Certos'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering
                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False, hide_index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_22_Mean_Charts = pd.read_csv('22_Role_Segundo_Atacante.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_22_Mean_Charts.iloc[:, np.r_[1, 3, 31, 33, 18:31]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Acelerações_LM'] = Role_x_Mean_Charts['Acelerações'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['Finalizações_NoAlvo_LM'] = Role_x_Mean_Charts['Finalizações_NoAlvo'].mean()
                        Role_x_Mean_Charts['Conversão_Gols_LM'] = Role_x_Mean_Charts['Conversão_Gols'].mean()
                        Role_x_Mean_Charts['Conversão_xG_LM'] = Role_x_Mean_Charts['Conversão_xG'].mean()
                        Role_x_Mean_Charts['Ameaça_Ofensiva_LM'] = Role_x_Mean_Charts['Ameaça_Ofensiva'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        Role_x_Mean_Charts['Deep_Completions_LM'] = Role_x_Mean_Charts['Deep_Completions'].mean()
                        Role_x_Mean_Charts['Passes_Chave_LM'] = Role_x_Mean_Charts['Passes_Chave'].mean()
                        Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos_LM'] = Role_x_Mean_Charts['Passes_ÁreaPênalti_Certos'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_22_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:17]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[17:30]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 
                                                                'Acelerações_LM':'Acelerações', 'xG_LM':'xG', 'Finalizações_NoAlvo_LM':'Finalizações_NoAlvo', 'Conversão_Gols_LM':'Conversão_Gols', 
                                                                'Conversão_xG_LM':'Conversão_xG', 'Ameaça_Ofensiva_LM':'Ameaça_Ofensiva', 'xA_LM':'xA', 'Assistência_Finalização_LM':'Assistência_Finalização', 
                                                                'Deep_Completions_LM':'Deep_Completions', 'Passes_Chave_LM':'Passes_Chave', 'Passes_ÁreaPênalti_Certos_LM':'Passes_ÁreaPênalti_Certos'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_22_Mean_Charts = pd.concat([Role_22_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_22_Mean_Charts = Role_22_Mean_Charts.append(League_Mean).reset_index()
                        #Role_22_Mean_Charts = Role_22_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    

                        #Splitting Columns
                        Role_22_Mean_Charts_1 = Role_22_Mean_Charts.iloc[:, np.r_[0, 1:8]]
                        Role_22_Mean_Charts_2 = Role_22_Mean_Charts.iloc[:, np.r_[0, 8:14]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_22_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_22_Mean_Charts_1['Atleta'])):
                            if Role_22_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_22_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_22_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_22_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        # Preparing Graph 2
                        # Get Parameters

                        params = list(Role_22_Mean_Charts_2.columns)
                        params = params[1:]
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_22_Mean_Charts_2['Atleta'])):
                            if Role_22_Mean_Charts_2['Atleta'][x] == jogadores:
                                a_values = Role_22_Mean_Charts_2.iloc[x].values.tolist()
                            if Role_22_Mean_Charts_2['Atleta'][x] == 'Média da Liga':
                                b_values = Role_22_Mean_Charts_2.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_2.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_2.png', dpi=600, bbox_inches="tight")

                        #####################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique", key="mais_graficos_key")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:17]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)


                        ##################################################################################################################### 
                        #####################################################################################################################

                        # ATACANTE MÓVEL
                        # Elaborar Tabela de Abertura com Rating, Ranking, Percentil
                        tabela_1 = pd.read_csv('PlayerAnalysis_Role_21.csv')
                        tabela_1  = tabela_1.iloc[:, np.r_[11, 16, 28, 32:36, 30, 13]]
                        tabela_1 = tabela_1[(tabela_1['Atleta']==jogadores)&
                                            (tabela_1['Código_Posição_Wyscout']==12)&
                                            (tabela_1['Versão_Temporada']==temporada)&
                                            (tabela_1['Liga']==liga)&
                                            (tabela_1['Equipe_Janela_Análise']==equipe)]
                        clube = tabela_1.iat[0, 8]
                        rating = tabela_1.iat[0, 3]
                        ranking = tabela_1.iat[0,4]
                        percentil = tabela_1.iat[0,6]
                        size = tabela_1.iat[0,5]
                        fontsize = 20
                        # Texto de Abertura
                        st.markdown("<h3 style='text-align: center;'>ATACANTE MÓVEL</b></h3>", unsafe_allow_html=True)
                        # Rating/Ranking/Percentil
                        markdown_amount_3 = f"<div style='text-align:center; font-size:{fontsize}px'>{rating:}</div>"
                        markdown_amount_4 = f"<div style='text-align:center; font-size:{fontsize}px'>{ranking:}</div>"
                        markdown_amount_5 = f"<div style='text-align:center; font-size:{fontsize}px'>{percentil:}</div>"
                        markdown_amount_6 = f"<div style='text-align:center; font-size:{fontsize}px'>(Total de {size:} jogadores na Liga)</div>"
                        st.markdown("<h4 style='text-align: center;'>Rating/Ranking/Percentil do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)
                        st.markdown(markdown_amount_6, unsafe_allow_html=True)
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.markdown("<h4 style='text-align: center;'>Rating</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_3, unsafe_allow_html=True)
                        with col2:
                            st.markdown("<h4 style='text-align: center;'>Ranking</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_4, unsafe_allow_html=True)
                        with col3:
                            st.markdown("<h4 style='text-align: center;'>Percentil</b></h4>", unsafe_allow_html=True)
                            st.markdown(markdown_amount_5, unsafe_allow_html=True)
                        st.markdown("---")
                        ##################################################################################################################### 
                        #####################################################################################################################
                        # #Elaborar Tabela com Métricas do Atleta
                        tabela_2 = pd.read_csv('21_Role_Atacante_Móvel.csv')
                        tabela_2 = tabela_2.iloc[:, np.r_[1, 18:27, 6, 27, 29, 3]]
                        tabela_2 = tabela_2[(tabela_2['Atleta']==jogadores)&
                                            (tabela_2['Código_Posição_Wyscout']==12)&
                                            (tabela_2['Versão_Temporada']==temporada)&
                                            (tabela_2['Liga']==liga)&
                                            (tabela_2['Equipe_Janela_Análise']==equipe)]
                        tabela_2 = tabela_2.iloc[:, np.r_[0:10]]
                        tabela_2  = pd.DataFrame(tabela_2)
                        tabela_2 = tabela_2.round(decimals=2)
                        # Média da Liga
                        tabela_b = pd.read_csv('21_Role_Atacante_Móvel.csv')
                        tabela_b = tabela_b.iloc[:, np.r_[1, 18:27, 6, 27, 29, 3]]
                        tabela_b = tabela_b[(tabela_b['Código_Posição_Wyscout']==12)&(tabela_b['Versão_Temporada']==temporada)&(tabela_b['Liga']==liga)]
                        tabela_b = tabela_b.iloc[:, np.r_[1:10, 11]]
                        tabela_b = tabela_b.round(decimals=2)
                        tabela_c = (tabela_b.groupby('Liga')[['Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos', 'Acelerações', 'xG', 
                                                                'Conversão_Gols', 'Conversão_xG', 'Ameaça_Ofensiva', 'xA', 
                                                                'Assistência_Finalização']].mean())
                        tabela_c = tabela_c.round(decimals=2)
                        Atleta = ['Média da Liga']
                        tabela_c['Atleta'] = Atleta 
                        tabela_c.insert(0, 'Atleta', tabela_c.pop('Atleta'))
                        # Percentil na Liga
                        tabela_d = pd.read_csv('PlayerAnalysis_Role_21.csv')
                        tabela_d = tabela_d.iloc[:, np.r_[54:63, 11, 16, 28, 30, 13]]
                        tabela_d = tabela_d[(tabela_d['Atleta']==jogadores)&
                                            (tabela_d['Equipe_Janela_Análise']==equipe)&
                                            (tabela_d['Código_Posição_Wyscout']==12)&
                                            (tabela_d['Versão_Temporada']==temporada)&
                                            (tabela_d['Liga']==liga)]
                        tabela_d = tabela_d.iloc[:, np.r_[0:9]]
                        tabela_d = tabela_d.rename(columns={'Duelos_Ofensivos_Ganhos_Percentil':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_Percentil':'Dribles_BemSucedidos', 
                                                            'Acelerações_Percentil':'Acelerações', 'xG_Percentil':'xG', 'Conversão_Gols_Percentil':'Conversão_Gols', 
                                                            'Conversão_xG_Percentil':'Conversão_xG', 'Ameaça_Ofensiva_Percentil':'Ameaça_Ofensiva', 'xA_Percentil':'xA', 
                                                            'Assistência_Finalização_Percentil':'Assistência_Finalização'})
                        Atleta = ['Percentil na Liga']
                        tabela_d['Atleta'] = Atleta 
                        tabela_d.insert(0, 'Atleta', tabela_d.pop('Atleta'))
                        tabela_2 = pd.concat([tabela_2, tabela_c, tabela_d]).reset_index(drop=True)
                        tabela_2.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        tabela_2 = tabela_2.transpose()

                        st.markdown("<h4 style='text-align: center;'>Desempenho do Jogador na Liga/Temporada</h4>", unsafe_allow_html=True)

                        # Define function to color and label cells in the "Percentil na Liga" column
                        def color_percentil(val):
                            # Color map for "Blues" from Matplotlib
                            cmap = plt.get_cmap('Blues')
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            if pd.isna(val):
                                return ''  # No styling for NaN values
                            elif val >= 90:
                                color = cmap2(0.70)  # "Elite"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 75 <= val < 90:
                                color = cmap2(0.50)  # "Destaque"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 60 <= val < 75:
                                color = cmap(0.50)  # "Razoável"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 40 <= val < 60:
                                color = cmap(0.25)  # "Mediano"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            elif 20 <= val < 40:
                                color = cmap1(0.30)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                            else:
                                color = cmap1(0.50)  # Orange color for "Frágil"
                                return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'

                        # Styling DataFrame using Pandas
                        def style_table(df):
                            df = df.reset_index()  # If you want the index to be a visible column
                            new_header = df.iloc[0]  # Capture the first row to use as column headers
                            df = df[1:]  # Remove the first row from the data
                            df.columns = new_header  # Set the new column headers
                            first_column_name = df.columns[1]  # Adjusted for the added index column
                            # Ensure 'Rating' is rounded and formatted to 2 decimal places during styling
                            formatter = {first_column_name: "{:.2f}", "Média da Liga": "{:.2f}", "Percentil na Liga": "{:.0f}"}
                
                            # Apply the color formatting to "Percentil na Liga" column
                            styled_df = df.style.format(formatter).applymap(color_percentil, subset=["Percentil na Liga"])

                            # Additional table styles
                            styled_df = styled_df.set_table_styles(
                                [{
                                    'selector': 'thead th',
                                    'props': [('font-weight', 'bold'),
                                            ('border-style', 'solid'),
                                            ('border-width', '0px 0px 2px 0px'),
                                            ('border-color', 'black')]
                                }, {
                                    'selector': 'thead th:not(:first-child)',
                                    'props': [('text-align', 'center')]  # Centering all headers except the first
                                }, {
                                    'selector': 'thead th:last-child',
                                    'props': [('color', 'black')]  # Make last column header black
                                }, {
                                    'selector': 'td',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'center')]
                                }, {
                                    'selector': 'th',
                                    'props': [('border-style', 'solid'),
                                            ('border-width', '0px 0px 1px 0px'),
                                            ('border-color', 'black'),
                                            ('text-align', 'left')]
                                }, {
                                    'selector': '.index_name',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of the index
                                }, {
                                    'selector': '.row_heading',
                                    'props': [('font-size', '15px'), ('color', 'white')]  # Adjust font size of row headers
                                }]
                            ).set_properties(**{'padding': '2px', 'font-size': '15px', 'margin': 'auto'})  # Adjust this for centering
                            return styled_df

                        # Displaying in Streamlit
                        def main():
                            #st.title("Your DataFrame")

                            # Convert the styled DataFrame to HTML, ensure the index is shown and wrapped in a center-aligned div
                            styled_html = style_table(tabela_2).to_html(escape=False, index=False)
                            center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{styled_html}</div>"
                            st.markdown(center_html, unsafe_allow_html=True)

                        if __name__ == '__main__':
                            main()


                        # Function to plot the legend for the 5 colors from the Blues colormap
                        st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

                        def plot_color_legend():
                            # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                            cmap = plt.get_cmap("Blues")
                            cmap1 = plt.get_cmap("Reds")
                            cmap2 = plt.get_cmap("Greens")

                            # Assign colors using the same logic
                            colors = [
                                cmap2(0.70),   # "Elite"
                                cmap2(0.50),  # "Destaque"
                                cmap(0.50),   # "Razoável"
                                cmap(0.25),  # "Mediano"
                                cmap1(0.30), # "Frágil"
                                cmap1(0.50)  # "Péssimo"
                            ]
                            
                            # Labels for the legend (highest to lowest)
                            labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                            # Plot the legend horizontally with a smaller size
                            fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                            for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                                ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                                ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                            ax.set_xlim(0, 6)
                            ax.set_ylim(0, 1)
                            ax.axis('off')  # Remove axes

                            # Add an arrow pointing from "Highest" to "Lowest"
                            ax.annotate('', xy=(6, 1), xytext=(0, 1),
                                        arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                            return fig

                        # Call the function to plot the legend and display it in Streamlit
                        legend_fig = plot_color_legend()
                        st.pyplot(legend_fig)            

                        ##################################################################################################################### 
                        #####################################################################################################################
                        #Plotar Gráfico Alternativo
                        # Player Comparison Data
                        st.markdown("<h4 style='text-align: center;'><br>Comparativo do Jogador com a Média da Liga</h4>", unsafe_allow_html=True)
                        Role_21_Mean_Charts = pd.read_csv('21_Role_Atacante_Móvel.csv')
                        #PLOTTING COMPARISON BETWEEN 1 PLAYER AND LEAGUE MEAN
                        #Determining Club and League 
                        Role_x_Mean_Charts  = Role_21_Mean_Charts.iloc[:, np.r_[1, 3, 27, 29, 18:27]]
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Versão_Temporada']==temporada)&(Role_x_Mean_Charts['Liga']==liga)]

                        Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos_LM'] = Role_x_Mean_Charts['Duelos_Ofensivos_Ganhos'].mean()
                        Role_x_Mean_Charts['Dribles_BemSucedidos_LM'] = Role_x_Mean_Charts['Dribles_BemSucedidos'].mean()
                        Role_x_Mean_Charts['Acelerações_LM'] = Role_x_Mean_Charts['Acelerações'].mean()
                        Role_x_Mean_Charts['xG_LM'] = Role_x_Mean_Charts['xG'].mean()
                        Role_x_Mean_Charts['Conversão_Gols_LM'] = Role_x_Mean_Charts['Conversão_Gols'].mean()
                        Role_x_Mean_Charts['Conversão_xG_LM'] = Role_x_Mean_Charts['Conversão_xG'].mean()
                        Role_x_Mean_Charts['Ameaça_Ofensiva_LM'] = Role_x_Mean_Charts['Ameaça_Ofensiva'].mean()
                        Role_x_Mean_Charts['xA_LM'] = Role_x_Mean_Charts['xA'].mean()
                        Role_x_Mean_Charts['Assistência_Finalização_LM'] = Role_x_Mean_Charts['Assistência_Finalização'].mean()
                        
                        Role_x_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        Role_y_Mean_Charts  = pd.DataFrame(Role_x_Mean_Charts)
                        
                        Role_x_Mean_Charts = Role_x_Mean_Charts[(Role_x_Mean_Charts['Atleta']==jogadores)]
                        
                        #Selecting data to compare 1 player and league mean
                        Role_21_Mean_Charts  = Role_x_Mean_Charts.iloc[:, np.r_[0, 4:13]]

                        #Preparing League Mean Data
                        League_Mean = Role_x_Mean_Charts.iloc[:, np.r_[13:22]]
                        League_Mean['Atleta'] = 'Média da Liga' 
                        League_Mean.insert(0, 'Atleta', League_Mean.pop('Atleta'))
                        League_Mean = League_Mean.rename(columns={'Duelos_Ofensivos_Ganhos_LM':'Duelos_Ofensivos_Ganhos', 'Dribles_BemSucedidos_LM':'Dribles_BemSucedidos', 
                                                                'Acelerações_LM':'Acelerações', 'xG_LM':'xG', 'Conversão_Gols_LM':'Conversão_Gols', 
                                                                'Conversão_xG_LM':'Conversão_xG', 'Ameaça_Ofensiva_LM':'Ameaça_Ofensiva', 'xA_LM':'xA', 'Assistência_Finalização_LM':'Assistência_Finalização'})
                        #Merging Dataframes
                        #Adjusting Player Dataframe
                        #Concatenating Dataframes
                        Role_21_Mean_Charts = pd.concat([Role_21_Mean_Charts, League_Mean]).reset_index(drop=True)
                        #Role_21_Mean_Charts = Role_21_Mean_Charts.append(League_Mean).reset_index()
                        #Role_21_Mean_Charts = Role_21_Mean_Charts.rename(columns={'Interceptações.1': 'Interceptações'})    

                        #Splitting Columns
                        Role_21_Mean_Charts_1 = Role_21_Mean_Charts.iloc[:, np.r_[0, 1:10]]
                        #Role_21_Mean_Charts_2 = Role_21_Mean_Charts.iloc[:, np.r_[1, 9:15]]


                        # Preparing Graph 1
                        # Get Parameters

                        params = list(Role_21_Mean_Charts_1.columns)
                        params = params[1:]
                        
                        #Preparing Data
                        ranges = []
                        a_values = []
                        b_values = []

                        for x in params:
                            a = min(Role_y_Mean_Charts[params][x])
                            a = a
                            b = max(Role_y_Mean_Charts[params][x])
                            b = b
                            ranges.append((a, b))

                        for x in range(len(Role_21_Mean_Charts_1['Atleta'])):
                            if Role_21_Mean_Charts_1['Atleta'][x] == jogadores:
                                a_values = Role_21_Mean_Charts_1.iloc[x].values.tolist()
                            if Role_21_Mean_Charts_1['Atleta'][x] == 'Média da Liga':
                                b_values = Role_21_Mean_Charts_1.iloc[x].values.tolist()
                                    
                        a_values = a_values[1:]
                        b_values = b_values[1:]

                        values = [a_values, b_values]

                        #Plotting Data
                        title = dict(
                            title_name = jogadores,
                            title_color = '#B6282F',
                            title_name_2 = 'Média da Liga',
                            title_color_2 = '#344D94',
                            title_fontsize = 18,
                        ) 

                        endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll features are per90'

                        radar=Radar(fontfamily='Cursive', range_fontsize=8)
                        fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                        plt.savefig('Player&League_Comparison_1.png')
                        st.pyplot(fig)
                        fig.savefig('Player&League_Comparison_1.png', dpi=600, bbox_inches="tight")

                        #####################################################################################################################

                        # Plotting KDE Comparison Graphs
                        mais_gráficos = st.button("Para gráficos adicionais por métrica, clique", key="2_mais_graficos_key")
                        if mais_gráficos:
                            st.markdown("<h4 style='text-align: center;'><br>Posição Relativa do Jogador na Liga<br></h4>", unsafe_allow_html=True)
                            # Select columns from 4 to 10 (7 columns in total)
                            selected_columns = Role_y_Mean_Charts.iloc[:, 4:13]

                            # Plot KDE for each selected column in pairs
                            for i in range(0, len(selected_columns.columns), 2):
                                fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16, 4))  # Always create two subplots

                                # Plot first column in the pair
                                density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='blue', bw_adjust=0.5)
                                sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i], ax=ax1, color='red', height=0.05)  # Adding rug plot
                                x_vals = density.get_lines()[0].get_xdata()
                                y_vals = density.get_lines()[0].get_ydata()
                                ax1.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)
                                player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i]].values[0]
                                ax1.axvline(x=player_value, color='red', linewidth=2)
                                ax1.text(player_value + 0.01 * (ax1.get_xlim()[1] - ax1.get_xlim()[0]), ax1.get_ylim()[0] + (ax1.get_ylim()[1] - ax1.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                ax1.set_title(f'{selected_columns.columns[i]}', fontsize=18, fontweight='bold')
                                ax1.spines['top'].set_visible(False)
                                ax1.spines['right'].set_visible(False)
                                ax1.spines['left'].set_visible(False)
                                ax1.set_xlabel('')
                                ax1.set_ylabel('')
                                ax1.tick_params(axis='x', labelsize=14)
                                ax1.tick_params(axis='y', which='both', left=False, labelleft=False)


                                if i + 1 < len(selected_columns.columns):  # Check if there is a second plot to render
                                    # Plot second column in the pair
                                    density = sns.kdeplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='blue', bw_adjust=0.5)
                                    sns.rugplot(data=Role_y_Mean_Charts, x=selected_columns.columns[i+1], ax=ax2, color='red', height=0.05)  # Adding rug plot
                                    x_vals = density.get_lines()[0].get_xdata()
                                    y_vals = density.get_lines()[0].get_ydata()
                                    ax2.fill_between(x_vals, y_vals, color='lightblue', alpha=0.5)                                
                                    player_value = Role_y_Mean_Charts.loc[Role_y_Mean_Charts['Atleta'] == jogadores, selected_columns.columns[i+1]].values[0]
                                    ax2.axvline(x=player_value, color='red', linewidth=2)
                                    ax2.text(player_value + 0.01 * (ax2.get_xlim()[1] - ax2.get_xlim()[0]), ax2.get_ylim()[0] + (ax2.get_ylim()[1] - ax2.get_ylim()[0]) * 0.1, jogadores, color='red', fontsize=17, verticalalignment='bottom')
                                    ax2.set_title(f'{selected_columns.columns[i+1]}', fontsize=18, fontweight='bold')
                                    ax2.spines['top'].set_visible(False)
                                    ax2.spines['right'].set_visible(False)
                                    ax2.spines['left'].set_visible(False)
                                    ax2.set_xlabel('')
                                    ax2.set_ylabel('')
                                    ax2.tick_params(axis='x', labelsize=14)
                                    ax2.tick_params(axis='y', which='both', left=False, labelleft=False)

                                else:
                                    # Instead of hiding the second axis, we simply clear it
                                    ax2.clear()
                                    ax2.axis('off')  # Turn off the axis if not used

                                plt.tight_layout()  # Adjust layout to prevent overlap
                                st.pyplot(fig)



                            #####################################################################################################################
                            #####################################################################################################################
                            #####################################################################################################################
                            #####################################################################################################################

jogadores_similares = df10["Atleta"].unique()
fontsize = 20
if st.session_state.selected_option == "Jogadores Similares":
    st.markdown("<h2 style='text-align: center;'>Jogadores Similares</h2>", unsafe_allow_html=True)
    st.markdown("<h3 style='text-align: center;'>Ligas Selecionadas - 2025</h3>", unsafe_allow_html=True)
    jogador_similar = st.selectbox("Digite o nome de seu jogador. A grafia deve ser exata!", options=jogadores_similares, index=None, placeholder="Jogador")
    if jogador_similar:
        #Determinar a Liga (pode haver duplicidades)
        dfliga = df10.loc[(df10['Atleta'] == jogador_similar)]
        ligas = dfliga['Liga'].unique()
        liga_similar = st.selectbox("Escolha a Liga", options=ligas)
        if liga_similar:
            #Determinar Posição
            df11 = df10.loc[(df10['Atleta']==jogador_similar) & (df10['Liga']==liga_similar)]
            posições = df11['Posição'].unique()
            posição_similar = st.selectbox("Escolha a Posição", options=posições)
            dfequipe = df11['Equipe_Janela_Análise']
            if posição_similar:
                #Determinar Perfil
                df12 = df2.loc[(df2["Posição"]==posição_similar)]
                perfis = df12["Função"].unique()
                perfil_similar = st.selectbox("Escolha o Perfil em Campo", options=perfis)
            
                if perfil_similar == ("Goleiro"):
                #####################################################################################################################
                #####################################################################################################################
                    # GOLEIRO CLÁSSICO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_1_data = pd.read_csv('1_Role_Goleiro_Similarity.csv')
                    Role_1_data = Role_1_data.drop(Role_1_data.columns[0:4], axis=1)
                    Role_1_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    target = Role_1_data.loc[(Role_1_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_1_data

                    # Step 9: Add columns "1", "2", "3" to Role_1_data
                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]

                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]

                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]

                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        Goleiro = selected.iloc[:, np.r_[-3:0]]

                        # Defining Columns
                        Goleiro_columns = Goleiro.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(Goleiro)

                        # Create a DataFrame with loadings
                        LoadingsGoleiro = pd.DataFrame(pca.components_.T**2, index=Goleiro_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(Goleiro, LoadingsGoleiro['loading factor 1']) + np.matmul(Goleiro, LoadingsGoleiro['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_1_data['Atleta'] == jogador_similar) & (Role_1_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 24, 29, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    st.markdown("---")    

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)
                    
                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_1_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 24, 30:37]]
                    target = target.iloc[:, np.r_[0, 2, 24, 30:37]]
                    # Renomeando Colunas
                    Role_1_Mean_Charts = Role_1_Mean_Charts.rename(columns={'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                                            'Defesas_Percentil': 'Defesas', 
                                                                            'Gols_Evitados_Percentil':'Gols Evitados', 
                                                                            'Saídas_Percentil': 'Saídas', 
                                                                            'Interceptações.1_Percentil': 'Interceptações', 
                                                                            'xG_Evitado_Percentil': 'xG Evitado', 
                                                                            'Finalizações_por_Gol_Sofrido_Percentil': 'Finalizações por Gol Sofrido'})
                    
                    target = target.rename(columns={'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                    'Defesas_Percentil': 'Defesas', 
                                                    'Gols_Evitados_Percentil':'Gols Evitados', 
                                                    'Saídas_Percentil': 'Saídas', 
                                                    'Interceptações.1_Percentil': 'Interceptações', 
                                                    'xG_Evitado_Percentil': 'xG Evitado', 
                                                    'Finalizações_por_Gol_Sofrido_Percentil': 'Finalizações por Gol Sofrido'})
                    
                    #Dropping Atleta-alvo
                    Role_1_Mean_Charts = Role_1_Mean_Charts[Role_1_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_1_Mean_Charts = Role_1_Mean_Charts.iloc[0:5, :]

                    #Primeiro Gráfico
                    Role_1_first = Role_1_Mean_Charts.iloc[0:1, :]
                    Role_1_first = pd.concat([Role_1_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_1_first.iat[0, 1]
                    jogadores_clube = Role_1_first.iat[0, 2]
                    jogadores_liga = Role_1_first.iat[0, 3]
                    alvo = Role_1_first.iat[1, 1]
                    alvo_clube = Role_1_first.iat[1, 2]
                    alvo_liga = Role_1_first.iat[1, 3]

                    # Preparing the Graph
                    params = list(Role_1_first.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_1_first[params][x])
                        a = 0
                        b = max(Role_1_first[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_1_first['Atleta'])):
                        if Role_1_first['Atleta'][x] == jogadores:
                            a_values = Role_1_first.iloc[x].values.tolist()
                        if Role_1_first['Atleta'][x] == alvo:
                            b_values = Role_1_first.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Segundo Gráfico
                    Role_1_second = Role_1_Mean_Charts.iloc[1:2, :]
                    Role_1_second = pd.concat([Role_1_second, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_1_second.iat[0, 1]
                    jogadores_clube = Role_1_second.iat[0, 2]
                    jogadores_liga = Role_1_second.iat[0, 3]
                    #alvo = Role_1_second.iat[1, 1]
                    #alvo_clube = Role_1_second.iat[1, 2]

                    # Preparing the Graph
                    params = list(Role_1_second.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_1_second[params][x])
                        a = 0
                        b = max(Role_1_second[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_1_second['Atleta'])):
                        if Role_1_second['Atleta'][x] == jogadores:
                            a_values = Role_1_second.iloc[x].values.tolist()
                        if Role_1_second['Atleta'][x] == alvo:
                            b_values = Role_1_second.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Terceiro Gráfico
                    Role_1_third = Role_1_Mean_Charts.iloc[2:3, :]
                    Role_1_third = pd.concat([Role_1_third, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_1_third.iat[0, 1]
                    jogadores_clube = Role_1_third.iat[0, 2]
                    jogadores_liga = Role_1_third.iat[0, 3]
                    #alvo = Role_1_fifth.iat[1, 1]
                    #alvo_clube = Role_1_fifth.iat[1, 2]

                    # Preparing the Graph
                    params = list(Role_1_third.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_1_third[params][x])
                        a = 0
                        b = max(Role_1_third[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_1_third['Atleta'])):
                        if Role_1_third['Atleta'][x] == jogadores:
                            a_values = Role_1_third.iloc[x].values.tolist()
                        if Role_1_third['Atleta'][x] == alvo:
                            b_values = Role_1_third.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Quarto Gráfico
                    Role_1_fourth = Role_1_Mean_Charts.iloc[3:4, :]
                    Role_1_fourth = pd.concat([Role_1_fourth, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_1_fourth.iat[0, 1]
                    jogadores_clube = Role_1_fourth.iat[0, 2]
                    jogadores_liga = Role_1_fourth.iat[0, 3]
                    #alvo = Role_1_fourth.iat[1, 1]
                    #alvo_clube = Role_1_fourth.iat[1, 2]

                    # Preparing the Graph
                    params = list(Role_1_fourth.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_1_fourth[params][x])
                        a = 0
                        b = max(Role_1_fourth[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_1_fourth['Atleta'])):
                        if Role_1_fourth['Atleta'][x] == jogadores:
                            a_values = Role_1_fourth.iloc[x].values.tolist()
                        if Role_1_fourth['Atleta'][x] == alvo:
                            b_values = Role_1_fourth.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Quinto Gráfico
                    Role_1_fifth = Role_1_Mean_Charts.iloc[4:5, :]
                    Role_1_fifth = pd.concat([Role_1_fifth, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_1_fifth.iat[0, 1]
                    jogadores_clube = Role_1_fifth.iat[0, 2]
                    jogadores_liga = Role_1_fifth.iat[0, 3]
                    #alvo = Role_1_fifth.iat[1, 1]
                    #alvo_clube = Role_1_fifth.iat[1, 2]

                    # Preparing the Graph
                    params = list(Role_1_fifth.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_1_fifth[params][x])
                        a = 0
                        b = max(Role_1_fifth[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_1_fifth['Atleta'])):
                        if Role_1_fifth['Atleta'][x] == jogadores:
                            a_values = Role_1_fifth.iloc[x].values.tolist()
                        if Role_1_fifth['Atleta'][x] == alvo:
                            b_values = Role_1_fifth.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ####################################################################################################
                    ####################################################################################################
                    ####################################################################################################
                    ####################################################################################################
                elif perfil_similar == ("Goleiro-Líbero"):
                #####################################################################################################################
                #####################################################################################################################
                    # GOLEIRO LÍBERO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_2_data = pd.read_csv('2_Role_Goleiro_Líbero_Similarity.csv')
                    Role_2_data = Role_2_data.drop(Role_2_data.columns[0:4], axis=1)
                    Role_2_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_2_data.loc[(Role_2_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_2_data

                    # Step 9: Add columns "1", "2", "3" to Role_2_data
                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    

                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]

                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]

                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        GoleiroLíbero = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        GoleiroLíbero_columns = GoleiroLíbero.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(GoleiroLíbero)

                        # Create a DataFrame with loadings
                        LoadingsGoleiroLíbero = pd.DataFrame(pca.components_.T**2, index=GoleiroLíbero_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(GoleiroLíbero, LoadingsGoleiroLíbero['loading factor 1']) + np.matmul(GoleiroLíbero, LoadingsGoleiroLíbero['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_2_data['Atleta'] == jogador_similar) & (Role_2_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 27, 32, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})
                    

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")    

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)
                    
                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_2_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 27, 33:43]]
                    target = target.iloc[:, np.r_[0, 2, 27, 33:43]]
                    # Renomeando Colunas
                    Role_2_Mean_Charts = Role_2_Mean_Charts.rename(columns={'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                                            'Passes_Curtos_Médios_Certos_Percentil':'Passes Curtos Médios Certos',
                                                                            'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                                            'Defesas_Percentil': 'Defesas', 
                                                                            'Gols_Evitados_Percentil':'Gols Evitados', 
                                                                            'Saídas_Percentil':'Saídas',
                                                                            'Interceptações.1_Percentil': 'Interceptações', 
                                                                            'xG_Evitado_Percentil': 'xG Evitado', 
                                                                            'Finalizações_por_Gol_Sofrido_Percentil': 'Finalizações por Gol Sofrido'})
                    
                    target = target.rename(columns={'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                    'Passes_Curtos_Médios_Certos_Percentil':'Passes Curtos Médios Certos',
                                                    'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                    'Defesas_Percentil': 'Defesas', 
                                                    'Gols_Evitados_Percentil':'Gols Evitados', 
                                                    'Saídas_Percentil':'Saídas',
                                                    'Interceptações.1_Percentil': 'Interceptações', 
                                                    'xG_Evitado_Percentil': 'xG Evitado', 
                                                    'Finalizações_por_Gol_Sofrido_Percentil': 'Finalizações por Gol Sofrido'})
                    
                    #Dropping Atleta-alvo
                    Role_2_Mean_Charts = Role_2_Mean_Charts[Role_2_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_2_Mean_Charts = Role_2_Mean_Charts.iloc[0:5, :]

                    #Primeiro Gráfico
                    Role_2_first = Role_2_Mean_Charts.iloc[0:1, :]
                    Role_2_first = pd.concat([Role_2_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_2_first.iat[0, 1]
                    jogadores_clube = Role_2_first.iat[0, 2]
                    jogadores_liga = Role_2_first.iat[0, 3]
                    alvo = Role_2_first.iat[1, 1]
                    alvo_clube = Role_2_first.iat[1, 2]
                    alvo_liga = Role_2_first.iat[1, 3]

                    # Preparing the Graph
                    params = list(Role_2_first.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_2_first[params][x])
                        a = 0
                        b = max(Role_2_first[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_2_first['Atleta'])):
                        if Role_2_first['Atleta'][x] == jogadores:
                            a_values = Role_2_first.iloc[x].values.tolist()
                        if Role_2_first['Atleta'][x] == alvo:
                            b_values = Role_2_first.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Segundo Gráfico
                    Role_2_second = Role_2_Mean_Charts.iloc[1:2, :]
                    Role_2_second = pd.concat([Role_2_second, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_2_second.iat[0, 1]
                    jogadores_clube = Role_2_second.iat[0, 2]
                    jogadores_liga = Role_2_second.iat[0, 3]

                    # Preparing the Graph
                    params = list(Role_2_second.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_2_second[params][x])
                        a = 0
                        b = max(Role_2_second[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_2_second['Atleta'])):
                        if Role_2_second['Atleta'][x] == jogadores:
                            a_values = Role_2_second.iloc[x].values.tolist()
                        if Role_2_second['Atleta'][x] == alvo:
                            b_values = Role_2_second.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Terceiro Gráfico
                    Role_2_third = Role_2_Mean_Charts.iloc[2:3, :]
                    Role_2_third = pd.concat([Role_2_third, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_2_third.iat[0, 1]
                    jogadores_clube = Role_2_third.iat[0, 2]
                    jogadores_liga = Role_2_third.iat[0, 3]

                    # Preparing the Graph
                    params = list(Role_2_third.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_2_third[params][x])
                        a = 0
                        b = max(Role_2_third[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_2_third['Atleta'])):
                        if Role_2_third['Atleta'][x] == jogadores:
                            a_values = Role_2_third.iloc[x].values.tolist()
                        if Role_2_third['Atleta'][x] == alvo:
                            b_values = Role_2_third.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Quarto Gráfico
                    Role_2_fourth = Role_2_Mean_Charts.iloc[3:4, :]
                    Role_2_fourth = pd.concat([Role_2_fourth, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_2_fourth.iat[0, 1]
                    jogadores_clube = Role_2_fourth.iat[0, 2]
                    jogadores_liga = Role_2_fourth.iat[0, 3]
                    #alvo = Role_2_fourth.iat[1, 1]
                    #alvo_clube = Role_2_fourth.iat[1, 2]

                    # Preparing the Graph
                    params = list(Role_2_fourth.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_2_fourth[params][x])
                        a = 0
                        b = max(Role_2_fourth[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_2_fourth['Atleta'])):
                        if Role_2_fourth['Atleta'][x] == jogadores:
                            a_values = Role_2_fourth.iloc[x].values.tolist()
                        if Role_2_fourth['Atleta'][x] == alvo:
                            b_values = Role_2_fourth.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Quinto Gráfico
                    Role_2_fifth = Role_2_Mean_Charts.iloc[4:5, :]
                    Role_2_fifth = pd.concat([Role_2_fifth, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_2_fifth.iat[0, 1]
                    jogadores_clube = Role_2_fifth.iat[0, 2]
                    jogadores_liga = Role_2_fifth.iat[0, 3]
                    #alvo = Role_2_fifth.iat[1, 1]
                    #alvo_clube = Role_2_fifth.iat[1, 2]

                    # Preparing the Graph
                    params = list(Role_2_fifth.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_2_fifth[params][x])
                        a = 0
                        b = max(Role_2_fifth[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_2_fifth['Atleta'])):
                        if Role_2_fifth['Atleta'][x] == jogadores:
                            a_values = Role_2_fifth.iloc[x].values.tolist()
                        if Role_2_fifth['Atleta'][x] == alvo:
                            b_values = Role_2_fifth.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ####################################################################################################
                    ####################################################################################################
                    ####################################################################################################
                    ####################################################################################################

                elif perfil_similar == ("Lateral Defensivo"):
                    #####################################################################################################################
                    #####################################################################################################################
                    # LATERAL DEFENSIVO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_3_data = pd.read_csv('3_Role_Lateral_Defensivo_Similarity.csv')
                    Role_3_data = Role_3_data.drop(Role_3_data.columns[0:4], axis=1)
                    Role_3_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_3_data.loc[(Role_3_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_3_data

                    # Step 9: Add columns "1", "2", "3" to Role_3_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]

                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]

                    #############################################################
                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        LateralDefensivo = selected.iloc[:, np.r_[-3:0]]

                        # Defining Columns
                        LateralDefensivo_columns = LateralDefensivo.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(LateralDefensivo)

                        # Create a DataFrame with loadings
                        LoadingsLateralDefensivo = pd.DataFrame(pca.components_.T**2, index=LateralDefensivo_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(LateralDefensivo, LoadingsLateralDefensivo['loading factor 1']) + np.matmul(LateralDefensivo, LoadingsLateralDefensivo['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_3_data['Atleta'] == jogador_similar) & (Role_3_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 22, 27, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")    

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)
                    
                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    ########################################################################################################
                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_3_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 22, 28:33]]
                    target = target.iloc[:, np.r_[0, 2, 22, 28:33]]
                    # Renomeando Colunas
                    Role_3_Mean_Charts = Role_3_Mean_Charts.rename(columns={'Duelos_Ganhos_Percentil':'Duelos Ganhos', 
                                                                            'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                            'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                            'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                            'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse'})
                    
                    target = target.rename(columns={'Duelos_Ganhos_Percentil':'Duelos Ganhos', 
                                                    'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                    'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse'})
                                            
                    #Dropping Atleta-alvo
                    Role_3_Mean_Charts = Role_3_Mean_Charts[Role_3_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_3_Mean_Charts = Role_3_Mean_Charts.iloc[0:5, :]

                    ############################################################################################
                    #Primeiro Gráfico
                    Role_3_first = Role_3_Mean_Charts.iloc[0:1, :]
                    Role_3_first = pd.concat([Role_3_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_3_first.iat[0, 1]
                    jogadores_clube = Role_3_first.iat[0, 2]
                    jogadores_liga = Role_3_first.iat[0, 3]
                    alvo = Role_3_first.iat[1, 1]
                    alvo_clube = Role_3_first.iat[1, 2]
                    alvo_liga = Role_3_first.iat[1, 3]

                    #Splitting Data
                    Role_3_first_1 = Role_3_first.iloc[:, np.r_[0:3, 3:9]]

                    # Preparing Graph 1
                    params = list(Role_3_first_1.columns)
                    params = params[4:]


                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_3_first_1[params][x])
                        a = 0
                        b = max(Role_3_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_3_first_1['Atleta'])):
                        if Role_3_first_1['Atleta'][x] == jogadores:
                            a_values = Role_3_first_1.iloc[x].values.tolist()
                        if Role_3_first_1['Atleta'][x] == alvo:
                            b_values = Role_3_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################
                    #Segundo Gráfico
                    Role_3_first = Role_3_Mean_Charts.iloc[1:2, :]
                    Role_3_first = pd.concat([Role_3_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_3_first.iat[0, 1]
                    jogadores_clube = Role_3_first.iat[0, 2]
                    jogadores_liga = Role_3_first.iat[0, 3]
                    alvo = Role_3_first.iat[1, 1]
                    alvo_clube = Role_3_first.iat[1, 2]
                    alvo_liga = Role_3_first.iat[1, 3]

                    #Splitting Data
                    Role_3_first_1 = Role_3_first.iloc[:, np.r_[0:3, 3:9]]

                    # Preparing Graph 1
                    params = list(Role_3_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_3_first_1[params][x])
                        a = 0
                        b = max(Role_3_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_3_first_1['Atleta'])):
                        if Role_3_first_1['Atleta'][x] == jogadores:
                            a_values = Role_3_first_1.iloc[x].values.tolist()
                        if Role_3_first_1['Atleta'][x] == alvo:
                            b_values = Role_3_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_3_first = Role_3_Mean_Charts.iloc[2:3, :]
                    Role_3_first = pd.concat([Role_3_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_3_first.iat[0, 1]
                    jogadores_clube = Role_3_first.iat[0, 2]
                    jogadores_liga = Role_3_first.iat[0, 3]
                    #alvo = Role_3_first.iat[1, 1]
                    #alvo_clube = Role_3_first.iat[1, 2]
                    #alvo_liga = Role_3_first.iat[1, 3]

                    #Splitting Data
                    Role_3_first_1 = Role_3_first.iloc[:, np.r_[0:3, 3:9]]

                    # Preparing Graph 1
                    params = list(Role_3_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_3_first_1[params][x])
                        a = 0
                        b = max(Role_3_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_3_first_1['Atleta'])):
                        if Role_3_first_1['Atleta'][x] == jogadores:
                            a_values = Role_3_first_1.iloc[x].values.tolist()
                        if Role_3_first_1['Atleta'][x] == alvo:
                            b_values = Role_3_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_3_first = Role_3_Mean_Charts.iloc[3:4, :]
                    Role_3_first = pd.concat([Role_3_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_3_first.iat[0, 1]
                    jogadores_clube = Role_3_first.iat[0, 2]
                    jogadores_liga = Role_3_first.iat[0, 3]
                    #alvo = Role_3_first.iat[1, 1]
                    #alvo_clube = Role_3_first.iat[1, 2]
                    #alvo_liga = Role_3_first.iat[1, 3]

                    #Splitting Data
                    Role_3_first_1 = Role_3_first.iloc[:, np.r_[0:3, 3:9]]

                    # Preparing Graph 1
                    params = list(Role_3_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_3_first_1[params][x])
                        a = 0
                        b = max(Role_3_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_3_first_1['Atleta'])):
                        if Role_3_first_1['Atleta'][x] == jogadores:
                            a_values = Role_3_first_1.iloc[x].values.tolist()
                        if Role_3_first_1['Atleta'][x] == alvo:
                            b_values = Role_3_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_3_first = Role_3_Mean_Charts.iloc[4:5, :]
                    Role_3_first = pd.concat([Role_3_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_3_first.iat[0, 1]
                    jogadores_clube = Role_3_first.iat[0, 2]
                    jogadores_liga = Role_3_first.iat[0, 3]

                    #Splitting Data
                    Role_3_first_1 = Role_3_first.iloc[:, np.r_[0:3, 3:9]]

                    # Preparing Graph 1
                    params = list(Role_3_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_3_first_1[params][x])
                        a = 0
                        b = max(Role_3_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_3_first_1['Atleta'])):
                        if Role_3_first_1['Atleta'][x] == jogadores:
                            a_values = Role_3_first_1.iloc[x].values.tolist()
                        if Role_3_first_1['Atleta'][x] == alvo:
                            b_values = Role_3_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                elif perfil_similar == ("Lateral Ofensivo"):
                    #####################################################################################################################
                    #####################################################################################################################
                    # LATERAL OFENSIVO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_4_data = pd.read_csv('4_Role_Lateral_Ofensivo_Similarity.csv')
                    Role_4_data = Role_4_data.drop(Role_4_data.columns[0:4], axis=1)
                    Role_4_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    target = Role_4_data.loc[(Role_4_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_4_data

                    # Step 9: Add columns "1", "2", "3", "4" to Role_4_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
 

                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]

                    #############################################################
                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        LateralOfensivo = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        LateralOfensivo_columns = LateralOfensivo.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(LateralOfensivo)

                        # Create a DataFrame with loadings
                        LoadingsLateralOfensivo = pd.DataFrame(pca.components_.T**2, index=LateralOfensivo_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(LateralOfensivo, LoadingsLateralOfensivo['loading factor 1']) + np.matmul(LateralOfensivo, LoadingsLateralOfensivo['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_4_data['Atleta'] == jogador_similar) & (Role_4_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 27, 32, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")    

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    ########################################################################################################
                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_4_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 27, 33:43]]
                    target = target.iloc[:, np.r_[0, 2, 27, 33:43]]
                    # Renomeando Colunas
                    Role_4_Mean_Charts = Role_4_Mean_Charts.rename(columns={'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                            'Pisadas_Área_Percentil':'Pisadas na Área', 
                                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                            'Cruzamentos_Certos_Percentil':'Cruzamentos Certos', 
                                                                            'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                            'Acelerações_Percentil':'Acelerações', 
                                                                            'xA_Percentil':'xA', 
                                                                            'Passes_Inteligentes_Certos_Percentil':'Passes Inteligentes Certos', 
                                                                            'Deep_Completed_Crosses_Percentil':'Deep Completed Crosses'})
                    
                    target = target.rename(columns={'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                    'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                    'Pisadas_Área_Percentil':'Pisadas na Área', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                    'Cruzamentos_Certos_Percentil':'Cruzamentos Certos', 
                                                    'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                    'Acelerações_Percentil':'Acelerações', 
                                                    'xA_Percentil':'xA', 
                                                    'Passes_Inteligentes_Certos_Percentil':'Passes Inteligentes Certos', 
                                                    'Deep_Completed_Crosses_Percentil':'Deep Completed Crosses'})
                                            
                    #Dropping Atleta-alvo
                    Role_4_Mean_Charts = Role_4_Mean_Charts[Role_4_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_4_Mean_Charts = Role_4_Mean_Charts.iloc[0:5, :]

                    ############################################################################################
                    #Primeiro Gráfico
                    Role_4_first = Role_4_Mean_Charts.iloc[0:1, :]
                    Role_4_first = pd.concat([Role_4_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_4_first.iat[0, 1]
                    jogadores_clube = Role_4_first.iat[0, 2]
                    jogadores_liga = Role_4_first.iat[0, 3]
                    alvo = Role_4_first.iat[1, 1]
                    alvo_clube = Role_4_first.iat[1, 2]
                    alvo_liga = Role_4_first.iat[1, 3]

                    #Splitting Data
                    Role_4_first_1 = Role_4_first.iloc[:, np.r_[0:3, 3:14]]

                    # Preparing Graph 1
                    params = list(Role_4_first_1.columns)
                    params = params[4:]


                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_4_first_1[params][x])
                        a = 0
                        b = max(Role_4_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_4_first_1['Atleta'])):
                        if Role_4_first_1['Atleta'][x] == jogadores:
                            a_values = Role_4_first_1.iloc[x].values.tolist()
                        if Role_4_first_1['Atleta'][x] == alvo:
                            b_values = Role_4_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Segundo Gráfico
                    Role_4_first = Role_4_Mean_Charts.iloc[1:2, :]
                    Role_4_first = pd.concat([Role_4_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_4_first.iat[0, 1]
                    jogadores_clube = Role_4_first.iat[0, 2]
                    jogadores_liga = Role_4_first.iat[0, 3]
                    alvo = Role_4_first.iat[1, 1]
                    alvo_clube = Role_4_first.iat[1, 2]
                    alvo_liga = Role_4_first.iat[1, 3]

                    #Splitting Data
                    Role_4_first_1 = Role_4_first.iloc[:, np.r_[0:3, 3:14]]

                    # Preparing Graph 1
                    params = list(Role_4_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_4_first_1[params][x])
                        a = 0
                        b = max(Role_4_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_4_first_1['Atleta'])):
                        if Role_4_first_1['Atleta'][x] == jogadores:
                            a_values = Role_4_first_1.iloc[x].values.tolist()
                        if Role_4_first_1['Atleta'][x] == alvo:
                            b_values = Role_4_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_4_first = Role_4_Mean_Charts.iloc[2:3, :]
                    Role_4_first = pd.concat([Role_4_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_4_first.iat[0, 1]
                    jogadores_clube = Role_4_first.iat[0, 2]
                    jogadores_liga = Role_4_first.iat[0, 3]
                    #alvo = Role_4_first.iat[1, 1]
                    #alvo_clube = Role_4_first.iat[1, 2]
                    #alvo_liga = Role_4_first.iat[1, 3]

                    #Splitting Data
                    Role_4_first_1 = Role_4_first.iloc[:, np.r_[0:3, 3:14]]

                    # Preparing Graph 1
                    params = list(Role_4_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_4_first_1[params][x])
                        a = 0
                        b = max(Role_4_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_4_first_1['Atleta'])):
                        if Role_4_first_1['Atleta'][x] == jogadores:
                            a_values = Role_4_first_1.iloc[x].values.tolist()
                        if Role_4_first_1['Atleta'][x] == alvo:
                            b_values = Role_4_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_4_first = Role_4_Mean_Charts.iloc[3:4, :]
                    Role_4_first = pd.concat([Role_4_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_4_first.iat[0, 1]
                    jogadores_clube = Role_4_first.iat[0, 2]
                    jogadores_liga = Role_4_first.iat[0, 3]
                    #alvo = Role_4_first.iat[1, 1]
                    #alvo_clube = Role_4_first.iat[1, 2]
                    #alvo_liga = Role_4_first.iat[1, 3]

                    #Splitting Data
                    Role_4_first_1 = Role_4_first.iloc[:, np.r_[0:3, 3:14]]

                    # Preparing Graph 1
                    params = list(Role_4_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_4_first_1[params][x])
                        a = 0
                        b = max(Role_4_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_4_first_1['Atleta'])):
                        if Role_4_first_1['Atleta'][x] == jogadores:
                            a_values = Role_4_first_1.iloc[x].values.tolist()
                        if Role_4_first_1['Atleta'][x] == alvo:
                            b_values = Role_4_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_4_first = Role_4_Mean_Charts.iloc[4:5, :]
                    Role_4_first = pd.concat([Role_4_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_4_first.iat[0, 1]
                    jogadores_clube = Role_4_first.iat[0, 2]
                    jogadores_liga = Role_4_first.iat[0, 3]
                    #alvo = Role_4_first.iat[1, 1]
                    #alvo_clube = Role_4_first.iat[1, 2]
                    #alvo_liga = Role_4_first.iat[1, 3]

                    #Splitting Data
                    Role_4_first_1 = Role_4_first.iloc[:, np.r_[0:3, 3:14]]

                    # Preparing Graph 1
                    params = list(Role_4_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_4_first_1[params][x])
                        a = 0
                        b = max(Role_4_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_4_first_1['Atleta'])):
                        if Role_4_first_1['Atleta'][x] == jogadores:
                            a_values = Role_4_first_1.iloc[x].values.tolist()
                        if Role_4_first_1['Atleta'][x] == alvo:
                            b_values = Role_4_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                elif perfil_similar == ("Lateral Equilibrado"):
                    #####################################################################################################################
                    #####################################################################################################################
                    # LATERAL EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_5_data = pd.read_csv('5_Role_Lateral_Equilibrado_Similarity.csv')
                    Role_5_data = Role_5_data.drop(Role_5_data.columns[0:4], axis=1)
                    Role_5_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    target = Role_5_data.loc[(Role_5_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_5_data

                    # Step 9: Add columns "1", "2", "3", "4", "5" to Role_5_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]
                    selected['5'] = given_ID[4]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]


                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]


                    if given_ID[4] == "A":
                        selected['5'] = selected["A1"]
                    elif given_ID[4] == "B":
                        selected['5'] = selected["B1"]
                    elif given_ID[4] == "C":
                        selected['5'] = selected["C1"]
                    elif given_ID[4] == "D":
                        selected['5'] = selected["D1"]
                    elif given_ID[4] == "E":
                        selected['5'] = selected["E1"]
                    elif given_ID[4] == "F":
                        selected['5'] = selected["F1"]
                    elif given_ID[4] == "G":
                        selected['5'] = selected["G1"]
                    elif given_ID[4] == "H":
                        selected['5'] = selected["H1"]
                    elif given_ID[4] == "I":
                        selected['5'] = selected["I1"]
                    elif given_ID[4] == "J":
                        selected['5'] = selected["J1"]
                    elif given_ID[4] == "K":
                        selected['5'] = selected["K1"]
                    elif given_ID[4] == "L":
                        selected['5'] = selected["L1"]
                    elif given_ID[4] == "M":
                        selected['5'] = selected["M1"]

                    #############################################################
                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        Lateral = selected.iloc[:, np.r_[-5:0]]

                        # Defining Columns
                        Lateral_columns = Lateral.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(Lateral)

                        # Create a DataFrame with loadings
                        LoadingsLateral = pd.DataFrame(pca.components_.T**2, index=Lateral_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(Lateral, LoadingsLateral['loading factor 1']) + np.matmul(Lateral, LoadingsLateral['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_5_data['Atleta'] == jogador_similar) & (Role_5_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    ########################################################################################################
                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_5_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_5_Mean_Charts = Role_5_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                            'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                            'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                                            'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                            'Cruzamentos_Certos_Percentil':'Cruzamentos Certos',
                                                                            'Pisadas_Área_Percentil':'Pisadas na Área', 
                                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                            'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                            'Acelerações_Percentil':'Acelerações', 
                                                                            'xA_Percentil':'xA', 
                                                                            'Passes_Inteligentes_Certos_Percentil':'Passes Inteligentes Certos', 
                                                                            'Deep_Completed_Crosses_Percentil':'Deep Completed Crosses'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                    'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                    'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                    'Cruzamentos_Certos_Percentil':'Cruzamentos Certos',
                                                    'Pisadas_Área_Percentil':'Pisadas na Área', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                    'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                    'Acelerações_Percentil':'Acelerações', 
                                                    'xA_Percentil':'xA', 
                                                    'Passes_Inteligentes_Certos_Percentil':'Passes Inteligentes Certos', 
                                                    'Deep_Completed_Crosses_Percentil':'Deep Completed Crosses'})
                                            
                    #Dropping Atleta-alvo
                    Role_5_Mean_Charts = Role_5_Mean_Charts[Role_5_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_5_Mean_Charts = Role_5_Mean_Charts.iloc[0:5, :]

                    ############################################################################################
                    #Primeiro Gráfico
                    Role_5_first = Role_5_Mean_Charts.iloc[0:1, :]
                    Role_5_first = pd.concat([Role_5_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_5_first.iat[0, 1]
                    jogadores_clube = Role_5_first.iat[0, 2]
                    jogadores_liga = Role_5_first.iat[0, 3]
                    alvo = Role_5_first.iat[1, 1]
                    alvo_clube = Role_5_first.iat[1, 2]
                    alvo_liga = Role_5_first.iat[1, 3]

                    #Splitting Data
                    Role_5_first_1 = Role_5_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_5_first_2 = Role_5_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_5_first_1.columns)
                    params = params[4:]


                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_1[params][x])
                        a = 0
                        b = max(Role_5_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_1['Atleta'])):
                        if Role_5_first_1['Atleta'][x] == jogadores:
                            a_values = Role_5_first_1.iloc[x].values.tolist()
                        if Role_5_first_1['Atleta'][x] == alvo:
                            b_values = Role_5_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_5_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_2[params][x])
                        a = 0
                        b = max(Role_5_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_2['Atleta'])):
                        if Role_5_first_2['Atleta'][x] == jogadores:
                            a_values = Role_5_first_2.iloc[x].values.tolist()
                        if Role_5_first_2['Atleta'][x] == alvo:
                            b_values = Role_5_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    ############################################################################

                    #Segundo Gráfico
                    Role_5_first = Role_5_Mean_Charts.iloc[1:2, :]
                    Role_5_first = pd.concat([Role_5_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_5_first.iat[0, 1]
                    jogadores_clube = Role_5_first.iat[0, 2]
                    jogadores_liga = Role_5_first.iat[0, 3]
                    alvo = Role_5_first.iat[1, 1]
                    alvo_clube = Role_5_first.iat[1, 2]
                    alvo_liga = Role_5_first.iat[1, 3]

                    #Splitting Data
                    Role_5_first_1 = Role_5_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_5_first_2 = Role_5_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_5_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_1[params][x])
                        a = 0
                        b = max(Role_5_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_1['Atleta'])):
                        if Role_5_first_1['Atleta'][x] == jogadores:
                            a_values = Role_5_first_1.iloc[x].values.tolist()
                        if Role_5_first_1['Atleta'][x] == alvo:
                            b_values = Role_5_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_5_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_2[params][x])
                        a = 0
                        b = max(Role_5_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_2['Atleta'])):
                        if Role_5_first_2['Atleta'][x] == jogadores:
                            a_values = Role_5_first_2.iloc[x].values.tolist()
                        if Role_5_first_2['Atleta'][x] == alvo:
                            b_values = Role_5_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_5_first = Role_5_Mean_Charts.iloc[2:3, :]
                    Role_5_first = pd.concat([Role_5_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_5_first.iat[0, 1]
                    jogadores_clube = Role_5_first.iat[0, 2]
                    jogadores_liga = Role_5_first.iat[0, 3]
                    #alvo = Role_5_first.iat[1, 1]
                    #alvo_clube = Role_5_first.iat[1, 2]
                    #alvo_liga = Role_5_first.iat[1, 3]

                    #Splitting Data
                    Role_5_first_1 = Role_5_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_5_first_2 = Role_5_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_5_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_1[params][x])
                        a = 0
                        b = max(Role_5_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_1['Atleta'])):
                        if Role_5_first_1['Atleta'][x] == jogadores:
                            a_values = Role_5_first_1.iloc[x].values.tolist()
                        if Role_5_first_1['Atleta'][x] == alvo:
                            b_values = Role_5_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_5_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_2[params][x])
                        a = 0
                        b = max(Role_5_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_2['Atleta'])):
                        if Role_5_first_2['Atleta'][x] == jogadores:
                            a_values = Role_5_first_2.iloc[x].values.tolist()
                        if Role_5_first_2['Atleta'][x] == alvo:
                            b_values = Role_5_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_5_first = Role_5_Mean_Charts.iloc[3:4, :]
                    Role_5_first = pd.concat([Role_5_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_5_first.iat[0, 1]
                    jogadores_clube = Role_5_first.iat[0, 2]
                    jogadores_liga = Role_5_first.iat[0, 3]
                    #alvo = Role_5_first.iat[1, 1]
                    #alvo_clube = Role_5_first.iat[1, 2]
                    #alvo_liga = Role_5_first.iat[1, 3]

                    #Splitting Data
                    Role_5_first_1 = Role_5_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_5_first_2 = Role_5_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_5_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_1[params][x])
                        a = 0
                        b = max(Role_5_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_1['Atleta'])):
                        if Role_5_first_1['Atleta'][x] == jogadores:
                            a_values = Role_5_first_1.iloc[x].values.tolist()
                        if Role_5_first_1['Atleta'][x] == alvo:
                            b_values = Role_5_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_5_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_2[params][x])
                        a = 0
                        b = max(Role_5_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_2['Atleta'])):
                        if Role_5_first_2['Atleta'][x] == jogadores:
                            a_values = Role_5_first_2.iloc[x].values.tolist()
                        if Role_5_first_2['Atleta'][x] == alvo:
                            b_values = Role_5_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_5_first = Role_5_Mean_Charts.iloc[4:5, :]
                    Role_5_first = pd.concat([Role_5_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_5_first.iat[0, 1]
                    jogadores_clube = Role_5_first.iat[0, 2]
                    jogadores_liga = Role_5_first.iat[0, 3]
                    #alvo = Role_5_first.iat[1, 1]
                    #alvo_clube = Role_5_first.iat[1, 2]
                    #alvo_liga = Role_5_first.iat[1, 3]

                    #Splitting Data
                    Role_5_first_1 = Role_5_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_5_first_2 = Role_5_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_5_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_1[params][x])
                        a = 0
                        b = max(Role_5_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_1['Atleta'])):
                        if Role_5_first_1['Atleta'][x] == jogadores:
                            a_values = Role_5_first_1.iloc[x].values.tolist()
                        if Role_5_first_1['Atleta'][x] == alvo:
                            b_values = Role_5_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_5_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_5_first_2[params][x])
                        a = 0
                        b = max(Role_5_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_5_first_2['Atleta'])):
                        if Role_5_first_2['Atleta'][x] == jogadores:
                            a_values = Role_5_first_2.iloc[x].values.tolist()
                        if Role_5_first_2['Atleta'][x] == alvo:
                            b_values = Role_5_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                if perfil_similar == ("Zagueiro Defensivo"):
                ###############################################################################
                ###########################################################################
                    # ZAGUEIRO EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_6_data = pd.read_csv('6_Role_Zagueiro_Defensivo_Similarity.csv')
                    Role_6_data = Role_6_data.drop(Role_6_data.columns[0:4], axis=1)
                    Role_6_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_6_data.loc[(Role_6_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_6_data

                    # Step 9: Add columns "1", "2", "3" to Role_6_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]

                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        ZagueiroDefensivo = selected.iloc[:, np.r_[-3:0]]

                        # Defining Columns
                        ZagueiroDefensivo_columns = ZagueiroDefensivo.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(ZagueiroDefensivo)

                        # Create a DataFrame with loadings
                        LoadingsZagueiroDefensivo = pd.DataFrame(pca.components_.T**2, index=ZagueiroDefensivo_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(ZagueiroDefensivo, LoadingsZagueiroDefensivo['loading factor 1']) + np.matmul(ZagueiroDefensivo, LoadingsZagueiroDefensivo['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_6_data['Atleta'] == jogador_similar) & (Role_6_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 23, 28, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_6_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 23, 29:35]]
                    target = target.iloc[:, np.r_[0, 2, 23, 29:35]]
                    # Renomeando Colunas
                    Role_6_Mean_Charts = Role_6_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                            'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                            'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                            'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                            'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                            'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                    'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                    'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                    'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos'})
                    
                    #Dropping Atleta-alvo
                    Role_6_Mean_Charts = Role_6_Mean_Charts[Role_6_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_6_Mean_Charts = Role_6_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_6_first = Role_6_Mean_Charts.iloc[0:1, :]
                    Role_6_first = pd.concat([Role_6_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_6_first.iat[0, 1]
                    jogadores_clube = Role_6_first.iat[0, 2]
                    jogadores_liga = Role_6_first.iat[0, 3]
                    alvo = Role_6_first.iat[1, 1]
                    alvo_clube = Role_6_first.iat[1, 2]
                    alvo_liga = Role_6_first.iat[1, 3]

                    #Splitting Data
                    Role_6_first_1 = Role_6_first.iloc[:, np.r_[0:3, 3:10]]

                    # Preparing Graph 1
                    params = list(Role_6_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_6_first_1[params][x])
                        a = 0
                        b = max(Role_6_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_6_first_1['Atleta'])):
                        if Role_6_first_1['Atleta'][x] == jogadores:
                            a_values = Role_6_first_1.iloc[x].values.tolist()
                        if Role_6_first_1['Atleta'][x] == alvo:
                            b_values = Role_6_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Segundo Gráfico
                    Role_6_first = Role_6_Mean_Charts.iloc[1:2, :]
                    Role_6_first = pd.concat([Role_6_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_6_first.iat[0, 1]
                    jogadores_clube = Role_6_first.iat[0, 2]
                    jogadores_liga = Role_6_first.iat[0, 3]

                    #Splitting Data
                    Role_6_first_1 = Role_6_first.iloc[:, np.r_[0:3, 3:10]]

                    # Preparing Graph 1
                    params = list(Role_6_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_6_first_1[params][x])
                        a = 0
                        b = max(Role_6_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_6_first_1['Atleta'])):
                        if Role_6_first_1['Atleta'][x] == jogadores:
                            a_values = Role_6_first_1.iloc[x].values.tolist()
                        if Role_6_first_1['Atleta'][x] == alvo:
                            b_values = Role_6_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_6_first = Role_6_Mean_Charts.iloc[2:3, :]
                    Role_6_first = pd.concat([Role_6_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_6_first.iat[0, 1]
                    jogadores_clube = Role_6_first.iat[0, 2]
                    jogadores_liga = Role_6_first.iat[0, 3]

                    #Splitting Data
                    Role_6_first_1 = Role_6_first.iloc[:, np.r_[0:3, 3:10]]

                    # Preparing Graph 1
                    params = list(Role_6_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_6_first_1[params][x])
                        a = 0
                        b = max(Role_6_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_6_first_1['Atleta'])):
                        if Role_6_first_1['Atleta'][x] == jogadores:
                            a_values = Role_6_first_1.iloc[x].values.tolist()
                        if Role_6_first_1['Atleta'][x] == alvo:
                            b_values = Role_6_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_6_first = Role_6_Mean_Charts.iloc[3:4, :]
                    Role_6_first = pd.concat([Role_6_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_6_first.iat[0, 1]
                    jogadores_clube = Role_6_first.iat[0, 2]
                    jogadores_liga = Role_6_first.iat[0, 3]

                    #Splitting Data
                    Role_6_first_1 = Role_6_first.iloc[:, np.r_[0:3, 3:10]]

                    # Preparing Graph 1
                    params = list(Role_6_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_6_first_1[params][x])
                        a = 0
                        b = max(Role_6_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_6_first_1['Atleta'])):
                        if Role_6_first_1['Atleta'][x] == jogadores:
                            a_values = Role_6_first_1.iloc[x].values.tolist()
                        if Role_6_first_1['Atleta'][x] == alvo:
                            b_values = Role_6_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_6_first = Role_6_Mean_Charts.iloc[4:5, :]
                    Role_6_first = pd.concat([Role_6_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_6_first.iat[0, 1]
                    jogadores_clube = Role_6_first.iat[0, 2]
                    jogadores_liga = Role_6_first.iat[0, 3]

                    #Splitting Data
                    Role_6_first_1 = Role_6_first.iloc[:, np.r_[0:3, 3:10]]

                    # Preparing Graph 1
                    params = list(Role_6_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_6_first_1[params][x])
                        a = 0
                        b = max(Role_6_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_6_first_1['Atleta'])):
                        if Role_6_first_1['Atleta'][x] == jogadores:
                            a_values = Role_6_first_1.iloc[x].values.tolist()
                        if Role_6_first_1['Atleta'][x] == alvo:
                            b_values = Role_6_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################

                if perfil_similar == ("Zagueiro Construtor"):
                ###############################################################################
                ###########################################################################
                    # ZAGUEIRO EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_7_data = pd.read_csv('7_Role_Zagueiro_Construtor_Similarity.csv')
                    Role_7_data = Role_7_data.drop(Role_7_data.columns[0:4], axis=1)
                    Role_7_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_7_data.loc[(Role_7_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_7_data

                    # Step 9: Add columns "1", "2", "3" to Role_7_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]

                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        ZagueiroConstrutor = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        ZagueiroConstrutor_columns = ZagueiroConstrutor.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(ZagueiroConstrutor)

                        # Create a DataFrame with loadings
                        LoadingsZagueiroConstrutor = pd.DataFrame(pca.components_.T**2, index=ZagueiroConstrutor_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(ZagueiroConstrutor, LoadingsZagueiroConstrutor['loading factor 1']) + np.matmul(ZagueiroConstrutor, LoadingsZagueiroConstrutor['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_7_data['Atleta'] == jogador_similar) & (Role_7_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 27, 32, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_7_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 27, 33:43]]
                    target = target.iloc[:, np.r_[0, 2, 27, 33:43]]
                    # Renomeando Colunas
                    Role_7_Mean_Charts = Role_7_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                            'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                            'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                            'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                            'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                            'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                    'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                    'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                    'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                    'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                    'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    #Dropping Atleta-alvo
                    Role_7_Mean_Charts = Role_7_Mean_Charts[Role_7_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_7_Mean_Charts = Role_7_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_7_first = Role_7_Mean_Charts.iloc[0:1, :]
                    Role_7_first = pd.concat([Role_7_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_7_first.iat[0, 1]
                    jogadores_clube = Role_7_first.iat[0, 2]
                    jogadores_liga = Role_7_first.iat[0, 3]
                    alvo = Role_7_first.iat[1, 1]
                    alvo_clube = Role_7_first.iat[1, 2]
                    alvo_liga = Role_7_first.iat[1, 3]

                    #Splitting Data
                    Role_7_first_1 = Role_7_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_7_first_2 = Role_7_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_7_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_1[params][x])
                        a = 0
                        b = max(Role_7_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_1['Atleta'])):
                        if Role_7_first_1['Atleta'][x] == jogadores:
                            a_values = Role_7_first_1.iloc[x].values.tolist()
                        if Role_7_first_1['Atleta'][x] == alvo:
                            b_values = Role_7_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_7_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_2[params][x])
                        a = 0
                        b = max(Role_7_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_2['Atleta'])):
                        if Role_7_first_2['Atleta'][x] == jogadores:
                            a_values = Role_7_first_2.iloc[x].values.tolist()
                        if Role_7_first_2['Atleta'][x] == alvo:
                            b_values = Role_7_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_7_first = Role_7_Mean_Charts.iloc[1:2, :]
                    Role_7_first = pd.concat([Role_7_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_7_first.iat[0, 1]
                    jogadores_clube = Role_7_first.iat[0, 2]
                    jogadores_liga = Role_7_first.iat[0, 3]

                    #Splitting Data
                    Role_7_first_1 = Role_7_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_7_first_2 = Role_7_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_7_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_1[params][x])
                        a = 0
                        b = max(Role_7_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_1['Atleta'])):
                        if Role_7_first_1['Atleta'][x] == jogadores:
                            a_values = Role_7_first_1.iloc[x].values.tolist()
                        if Role_7_first_1['Atleta'][x] == alvo:
                            b_values = Role_7_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_7_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_2[params][x])
                        a = 0
                        b = max(Role_7_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_2['Atleta'])):
                        if Role_7_first_2['Atleta'][x] == jogadores:
                            a_values = Role_7_first_2.iloc[x].values.tolist()
                        if Role_7_first_2['Atleta'][x] == alvo:
                            b_values = Role_7_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_7_first = Role_7_Mean_Charts.iloc[2:3, :]
                    Role_7_first = pd.concat([Role_7_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_7_first.iat[0, 1]
                    jogadores_clube = Role_7_first.iat[0, 2]
                    jogadores_liga = Role_7_first.iat[0, 3]

                    #Splitting Data
                    Role_7_first_1 = Role_7_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_7_first_2 = Role_7_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_7_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_1[params][x])
                        a = 0
                        b = max(Role_7_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_1['Atleta'])):
                        if Role_7_first_1['Atleta'][x] == jogadores:
                            a_values = Role_7_first_1.iloc[x].values.tolist()
                        if Role_7_first_1['Atleta'][x] == alvo:
                            b_values = Role_7_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_7_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_2[params][x])
                        a = 0
                        b = max(Role_7_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_2['Atleta'])):
                        if Role_7_first_2['Atleta'][x] == jogadores:
                            a_values = Role_7_first_2.iloc[x].values.tolist()
                        if Role_7_first_2['Atleta'][x] == alvo:
                            b_values = Role_7_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_7_first = Role_7_Mean_Charts.iloc[3:4, :]
                    Role_7_first = pd.concat([Role_7_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_7_first.iat[0, 1]
                    jogadores_clube = Role_7_first.iat[0, 2]
                    jogadores_liga = Role_7_first.iat[0, 3]

                    #Splitting Data
                    Role_7_first_1 = Role_7_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_7_first_2 = Role_7_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_7_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_1[params][x])
                        a = 0
                        b = max(Role_7_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_1['Atleta'])):
                        if Role_7_first_1['Atleta'][x] == jogadores:
                            a_values = Role_7_first_1.iloc[x].values.tolist()
                        if Role_7_first_1['Atleta'][x] == alvo:
                            b_values = Role_7_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_7_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_2[params][x])
                        a = 0
                        b = max(Role_7_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_2['Atleta'])):
                        if Role_7_first_2['Atleta'][x] == jogadores:
                            a_values = Role_7_first_2.iloc[x].values.tolist()
                        if Role_7_first_2['Atleta'][x] == alvo:
                            b_values = Role_7_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_7_first = Role_7_Mean_Charts.iloc[4:5, :]
                    Role_7_first = pd.concat([Role_7_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_7_first.iat[0, 1]
                    jogadores_clube = Role_7_first.iat[0, 2]
                    jogadores_liga = Role_7_first.iat[0, 3]

                    #Splitting Data
                    Role_7_first_1 = Role_7_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_7_first_2 = Role_7_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_7_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_1[params][x])
                        a = 0
                        b = max(Role_7_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_1['Atleta'])):
                        if Role_7_first_1['Atleta'][x] == jogadores:
                            a_values = Role_7_first_1.iloc[x].values.tolist()
                        if Role_7_first_1['Atleta'][x] == alvo:
                            b_values = Role_7_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_7_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_7_first_2[params][x])
                        a = 0
                        b = max(Role_7_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_7_first_2['Atleta'])):
                        if Role_7_first_2['Atleta'][x] == jogadores:
                            a_values = Role_7_first_2.iloc[x].values.tolist()
                        if Role_7_first_2['Atleta'][x] == alvo:
                            b_values = Role_7_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                if perfil_similar == ("Zagueiro Equilibrado"):
                ###############################################################################
                ###########################################################################
                    # ZAGUEIRO EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_8_data = pd.read_csv('8_Role_Zagueiro_Equilibrado_Similarity.csv')
                    Role_8_data = Role_8_data.drop(Role_8_data.columns[0:4], axis=1)
                    Role_8_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_8_data.loc[(Role_8_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_8_data

                    # Step 9: Add columns "1", "2", "3" to Role_8_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        Zagueiro = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        Zagueiro_columns = Zagueiro.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(Zagueiro)

                        # Create a DataFrame with loadings
                        LoadingsZagueiro = pd.DataFrame(pca.components_.T**2, index=Zagueiro_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(Zagueiro, LoadingsZagueiro['loading factor 1']) + np.matmul(Zagueiro, LoadingsZagueiro['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_8_data['Atleta'] == jogador_similar) & (Role_8_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_8_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_8_Mean_Charts = Role_8_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                            'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                            'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                            'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                            'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                            'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                            'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                            'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                            'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                    'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                    'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                    'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                    'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                    'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                    'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                    'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                    'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    #Dropping Atleta-alvo
                    Role_8_Mean_Charts = Role_8_Mean_Charts[Role_8_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_8_Mean_Charts = Role_8_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_8_first = Role_8_Mean_Charts.iloc[0:1, :]
                    Role_8_first = pd.concat([Role_8_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_8_first.iat[0, 1]
                    jogadores_clube = Role_8_first.iat[0, 2]
                    jogadores_liga = Role_8_first.iat[0, 3]
                    alvo = Role_8_first.iat[1, 1]
                    alvo_clube = Role_8_first.iat[1, 2]
                    alvo_liga = Role_8_first.iat[1, 3]

                    #Splitting Data
                    Role_8_first_1 = Role_8_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_8_first_2 = Role_8_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_8_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_1[params][x])
                        a = 0
                        b = max(Role_8_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_1['Atleta'])):
                        if Role_8_first_1['Atleta'][x] == jogadores:
                            a_values = Role_8_first_1.iloc[x].values.tolist()
                        if Role_8_first_1['Atleta'][x] == alvo:
                            b_values = Role_8_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_8_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_2[params][x])
                        a = 0
                        b = max(Role_8_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_2['Atleta'])):
                        if Role_8_first_2['Atleta'][x] == jogadores:
                            a_values = Role_8_first_2.iloc[x].values.tolist()
                        if Role_8_first_2['Atleta'][x] == alvo:
                            b_values = Role_8_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_8_first = Role_8_Mean_Charts.iloc[1:2, :]
                    Role_8_first = pd.concat([Role_8_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_8_first.iat[0, 1]
                    jogadores_clube = Role_8_first.iat[0, 2]
                    jogadores_liga = Role_8_first.iat[0, 3]
                    #alvo = Role_8_first.iat[1, 1]
                    #alvo_clube = Role_8_first.iat[1, 2]
                    #alvo_liga = Role_8_first.iat[1, 3]

                    #Splitting Data
                    Role_8_first_1 = Role_8_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_8_first_2 = Role_8_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_8_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_1[params][x])
                        a = 0
                        b = max(Role_8_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_1['Atleta'])):
                        if Role_8_first_1['Atleta'][x] == jogadores:
                            a_values = Role_8_first_1.iloc[x].values.tolist()
                        if Role_8_first_1['Atleta'][x] == alvo:
                            b_values = Role_8_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_8_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_2[params][x])
                        a = 0
                        b = max(Role_8_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_2['Atleta'])):
                        if Role_8_first_2['Atleta'][x] == jogadores:
                            a_values = Role_8_first_2.iloc[x].values.tolist()
                        if Role_8_first_2['Atleta'][x] == alvo:
                            b_values = Role_8_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_8_first = Role_8_Mean_Charts.iloc[2:3, :]
                    Role_8_first = pd.concat([Role_8_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_8_first.iat[0, 1]
                    jogadores_clube = Role_8_first.iat[0, 2]
                    jogadores_liga = Role_8_first.iat[0, 3]
                    #alvo = Role_8_first.iat[1, 1]
                    #alvo_clube = Role_8_first.iat[1, 2]
                    #alvo_liga = Role_8_first.iat[1, 3]

                    #Splitting Data
                    Role_8_first_1 = Role_8_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_8_first_2 = Role_8_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_8_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_1[params][x])
                        a = 0
                        b = max(Role_8_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_1['Atleta'])):
                        if Role_8_first_1['Atleta'][x] == jogadores:
                            a_values = Role_8_first_1.iloc[x].values.tolist()
                        if Role_8_first_1['Atleta'][x] == alvo:
                            b_values = Role_8_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_8_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_2[params][x])
                        a = 0
                        b = max(Role_8_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_2['Atleta'])):
                        if Role_8_first_2['Atleta'][x] == jogadores:
                            a_values = Role_8_first_2.iloc[x].values.tolist()
                        if Role_8_first_2['Atleta'][x] == alvo:
                            b_values = Role_8_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_8_first = Role_8_Mean_Charts.iloc[3:4, :]
                    Role_8_first = pd.concat([Role_8_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_8_first.iat[0, 1]
                    jogadores_clube = Role_8_first.iat[0, 2]
                    jogadores_liga = Role_8_first.iat[0, 3]
                    #alvo = Role_8_first.iat[1, 1]
                    #alvo_clube = Role_8_first.iat[1, 2]
                    #alvo_liga = Role_8_first.iat[1, 3]

                    #Splitting Data
                    Role_8_first_1 = Role_8_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_8_first_2 = Role_8_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_8_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_1[params][x])
                        a = 0
                        b = max(Role_8_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_1['Atleta'])):
                        if Role_8_first_1['Atleta'][x] == jogadores:
                            a_values = Role_8_first_1.iloc[x].values.tolist()
                        if Role_8_first_1['Atleta'][x] == alvo:
                            b_values = Role_8_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_8_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_2[params][x])
                        a = 0
                        b = max(Role_8_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_2['Atleta'])):
                        if Role_8_first_2['Atleta'][x] == jogadores:
                            a_values = Role_8_first_2.iloc[x].values.tolist()
                        if Role_8_first_2['Atleta'][x] == alvo:
                            b_values = Role_8_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_8_first = Role_8_Mean_Charts.iloc[4:5, :]
                    Role_8_first = pd.concat([Role_8_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_8_first.iat[0, 1]
                    jogadores_clube = Role_8_first.iat[0, 2]
                    jogadores_liga = Role_8_first.iat[0, 3]
                    #alvo = Role_8_first.iat[1, 1]
                    #alvo_clube = Role_8_first.iat[1, 2]
                    #alvo_liga = Role_8_first.iat[1, 3]

                    #Splitting Data
                    Role_8_first_1 = Role_8_first.iloc[:, np.r_[0:3, 3:10]]
                    Role_8_first_2 = Role_8_first.iloc[:, np.r_[0:3, 10:16]]

                    # Preparing Graph 1
                    params = list(Role_8_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_1[params][x])
                        a = 0
                        b = max(Role_8_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_1['Atleta'])):
                        if Role_8_first_1['Atleta'][x] == jogadores:
                            a_values = Role_8_first_1.iloc[x].values.tolist()
                        if Role_8_first_1['Atleta'][x] == alvo:
                            b_values = Role_8_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_8_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_8_first_2[params][x])
                        a = 0
                        b = max(Role_8_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_8_first_2['Atleta'])):
                        if Role_8_first_2['Atleta'][x] == jogadores:
                            a_values = Role_8_first_2.iloc[x].values.tolist()
                        if Role_8_first_2['Atleta'][x] == alvo:
                            b_values = Role_8_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                if perfil_similar == ("Primeiro Volante Defensivo"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE DEFENSIVO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_9_data = pd.read_csv('9_Role_Volante_Defensivo_Similarity.csv')
                    Role_9_data = Role_9_data.drop(Role_9_data.columns[0:4], axis=1)
                    Role_9_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_9_data.loc[(Role_9_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_9_data

                    # Step 9: Add columns "1", "2", "3" to Role_9_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]

                   # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        VolanteDefensivo = selected.iloc[:, np.r_[-3:0]]

                        # Defining Columns
                        VolanteDefensivo_columns = VolanteDefensivo.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(VolanteDefensivo)

                        # Create a DataFrame with loadings
                        LoadingsVolanteDefensivo = pd.DataFrame(pca.components_.T**2, index=VolanteDefensivo_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(VolanteDefensivo, LoadingsVolanteDefensivo['loading factor 1']) + np.matmul(VolanteDefensivo, LoadingsVolanteDefensivo['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_9_data['Atleta'] == jogador_similar) & (Role_9_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 21, 26, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_9_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 21, 27:31]]
                    target = target.iloc[:, np.r_[0, 2, 21, 27:31]]
                    # Renomeando Colunas
                    Role_9_Mean_Charts = Role_9_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                            'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                            'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos'})
                    
                    #Dropping Atleta-alvo
                    Role_9_Mean_Charts = Role_9_Mean_Charts[Role_9_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_9_Mean_Charts = Role_9_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_9_first = Role_9_Mean_Charts.iloc[0:1, :]
                    Role_9_first = pd.concat([Role_9_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_9_first.iat[0, 1]
                    jogadores_clube = Role_9_first.iat[0, 2]
                    jogadores_liga = Role_9_first.iat[0, 3]
                    alvo = Role_9_first.iat[1, 1]
                    alvo_clube = Role_9_first.iat[1, 2]
                    alvo_liga = Role_9_first.iat[1, 3]

                    #Splitting Data
                    Role_9_first_1 = Role_9_first.iloc[:, np.r_[0:3, 3:8]]

                    # Preparing Graph 1
                    params = list(Role_9_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_9_first_1[params][x])
                        a = 0
                        b = max(Role_9_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_9_first_1['Atleta'])):
                        if Role_9_first_1['Atleta'][x] == jogadores:
                            a_values = Role_9_first_1.iloc[x].values.tolist()
                        if Role_9_first_1['Atleta'][x] == alvo:
                            b_values = Role_9_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Segundo Gráfico
                    Role_9_first = Role_9_Mean_Charts.iloc[1:2, :]
                    Role_9_first = pd.concat([Role_9_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_9_first.iat[0, 1]
                    jogadores_clube = Role_9_first.iat[0, 2]
                    jogadores_liga = Role_9_first.iat[0, 3]

                    #Splitting Data
                    Role_9_first_1 = Role_9_first.iloc[:, np.r_[0:3, 3:8]]

                    # Preparing Graph 1
                    params = list(Role_9_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_9_first_1[params][x])
                        a = 0
                        b = max(Role_9_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_9_first_1['Atleta'])):
                        if Role_9_first_1['Atleta'][x] == jogadores:
                            a_values = Role_9_first_1.iloc[x].values.tolist()
                        if Role_9_first_1['Atleta'][x] == alvo:
                            b_values = Role_9_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_9_first = Role_9_Mean_Charts.iloc[2:3, :]
                    Role_9_first = pd.concat([Role_9_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_9_first.iat[0, 1]
                    jogadores_clube = Role_9_first.iat[0, 2]
                    jogadores_liga = Role_9_first.iat[0, 3]

                    #Splitting Data
                    Role_9_first_1 = Role_9_first.iloc[:, np.r_[0:3, 3:8]]

                    # Preparing Graph 1
                    params = list(Role_9_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_9_first_1[params][x])
                        a = 0
                        b = max(Role_9_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_9_first_1['Atleta'])):
                        if Role_9_first_1['Atleta'][x] == jogadores:
                            a_values = Role_9_first_1.iloc[x].values.tolist()
                        if Role_9_first_1['Atleta'][x] == alvo:
                            b_values = Role_9_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_9_first = Role_9_Mean_Charts.iloc[3:4, :]
                    Role_9_first = pd.concat([Role_9_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_9_first.iat[0, 1]
                    jogadores_clube = Role_9_first.iat[0, 2]
                    jogadores_liga = Role_9_first.iat[0, 3]
 
                    #Splitting Data
                    Role_9_first_1 = Role_9_first.iloc[:, np.r_[0:3, 3:8]]

                    # Preparing Graph 1
                    params = list(Role_9_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_9_first_1[params][x])
                        a = 0
                        b = max(Role_9_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_9_first_1['Atleta'])):
                        if Role_9_first_1['Atleta'][x] == jogadores:
                            a_values = Role_9_first_1.iloc[x].values.tolist()
                        if Role_9_first_1['Atleta'][x] == alvo:
                            b_values = Role_9_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_9_first = Role_9_Mean_Charts.iloc[4:5, :]
                    Role_9_first = pd.concat([Role_9_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_9_first.iat[0, 1]
                    jogadores_clube = Role_9_first.iat[0, 2]
                    jogadores_liga = Role_9_first.iat[0, 3]

                    #Splitting Data
                    Role_9_first_1 = Role_9_first.iloc[:, np.r_[0:3, 3:8]]

                    # Preparing Graph 1
                    params = list(Role_9_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_9_first_1[params][x])
                        a = 0
                        b = max(Role_9_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_9_first_1['Atleta'])):
                        if Role_9_first_1['Atleta'][x] == jogadores:
                            a_values = Role_9_first_1.iloc[x].values.tolist()
                        if Role_9_first_1['Atleta'][x] == alvo:
                            b_values = Role_9_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################

                if perfil_similar == ("Primeiro Volante Construtor"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE CONSTRUTOR
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_10_data = pd.read_csv('10_Role_Volante_Construtor_Similarity.csv')
                    Role_10_data = Role_10_data.drop(Role_10_data.columns[0:4], axis=1)
                    Role_10_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_10_data.loc[(Role_10_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_10_data

                    # Step 9: Add columns "1", "2", "3" to Role_10_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        VolanteConstrutor = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        VolanteConstrutor_columns = VolanteConstrutor.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(VolanteConstrutor)

                        # Create a DataFrame with loadings
                        LoadingsVolanteConstrutor = pd.DataFrame(pca.components_.T**2, index=VolanteConstrutor_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(VolanteConstrutor, LoadingsVolanteConstrutor['loading factor 1']) + np.matmul(VolanteConstrutor, LoadingsVolanteConstrutor['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_10_data['Atleta'] == jogador_similar) & (Role_10_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 26, 31, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_10_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 26, 32:41]]
                    target = target.iloc[:, np.r_[0, 2, 26, 32:41]]
                    # Renomeando Colunas
                    Role_10_Mean_Charts = Role_10_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                            'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                            'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                            'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos',
                                                            'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                    'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                    'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                    'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos',
                                                    'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                    'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    #Dropping Atleta-alvo
                    Role_10_Mean_Charts = Role_10_Mean_Charts[Role_10_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_10_Mean_Charts = Role_10_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_10_first = Role_10_Mean_Charts.iloc[0:1, :]
                    Role_10_first = pd.concat([Role_10_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_10_first.iat[0, 1]
                    jogadores_clube = Role_10_first.iat[0, 2]
                    jogadores_liga = Role_10_first.iat[0, 3]
                    alvo = Role_10_first.iat[1, 1]
                    alvo_clube = Role_10_first.iat[1, 2]
                    alvo_liga = Role_10_first.iat[1, 3]

                    #Splitting Data
                    Role_10_first_1 = Role_10_first.iloc[:, np.r_[0:3, 3:13]]

                    # Preparing Graph 1
                    params = list(Role_10_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_10_first_1[params][x])
                        a = 0
                        b = max(Role_10_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_10_first_1['Atleta'])):
                        if Role_10_first_1['Atleta'][x] == jogadores:
                            a_values = Role_10_first_1.iloc[x].values.tolist()
                        if Role_10_first_1['Atleta'][x] == alvo:
                            b_values = Role_10_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Segundo Gráfico
                    Role_10_first = Role_10_Mean_Charts.iloc[1:2, :]
                    Role_10_first = pd.concat([Role_10_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_10_first.iat[0, 1]
                    jogadores_clube = Role_10_first.iat[0, 2]
                    jogadores_liga = Role_10_first.iat[0, 3]

                    #Splitting Data
                    Role_10_first_1 = Role_10_first.iloc[:, np.r_[0:3, 3:13]]

                    # Preparing Graph 1
                    params = list(Role_10_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_10_first_1[params][x])
                        a = 0
                        b = max(Role_10_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_10_first_1['Atleta'])):
                        if Role_10_first_1['Atleta'][x] == jogadores:
                            a_values = Role_10_first_1.iloc[x].values.tolist()
                        if Role_10_first_1['Atleta'][x] == alvo:
                            b_values = Role_10_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_10_first = Role_10_Mean_Charts.iloc[2:3, :]
                    Role_10_first = pd.concat([Role_10_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_10_first.iat[0, 1]
                    jogadores_clube = Role_10_first.iat[0, 2]
                    jogadores_liga = Role_10_first.iat[0, 3]

                    #Splitting Data
                    Role_10_first_1 = Role_10_first.iloc[:, np.r_[0:3, 3:13]]

                    # Preparing Graph 1
                    params = list(Role_10_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_10_first_1[params][x])
                        a = 0
                        b = max(Role_10_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_10_first_1['Atleta'])):
                        if Role_10_first_1['Atleta'][x] == jogadores:
                            a_values = Role_10_first_1.iloc[x].values.tolist()
                        if Role_10_first_1['Atleta'][x] == alvo:
                            b_values = Role_10_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_10_first = Role_10_Mean_Charts.iloc[3:4, :]
                    Role_10_first = pd.concat([Role_10_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_10_first.iat[0, 1]
                    jogadores_clube = Role_10_first.iat[0, 2]
                    jogadores_liga = Role_10_first.iat[0, 3]

                    #Splitting Data
                    Role_10_first_1 = Role_10_first.iloc[:, np.r_[0:3, 3:13]]

                    # Preparing Graph 1
                    params = list(Role_10_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_10_first_1[params][x])
                        a = 0
                        b = max(Role_10_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_10_first_1['Atleta'])):
                        if Role_10_first_1['Atleta'][x] == jogadores:
                            a_values = Role_10_first_1.iloc[x].values.tolist()
                        if Role_10_first_1['Atleta'][x] == alvo:
                            b_values = Role_10_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_10_first = Role_10_Mean_Charts.iloc[4:5, :]
                    Role_10_first = pd.concat([Role_10_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_10_first.iat[0, 1]
                    jogadores_clube = Role_10_first.iat[0, 2]
                    jogadores_liga = Role_10_first.iat[0, 3]

                    #Splitting Data
                    Role_10_first_1 = Role_10_first.iloc[:, np.r_[0:3, 3:13]]

                    # Preparing Graph 1
                    params = list(Role_10_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_10_first_1[params][x])
                        a = 0
                        b = max(Role_10_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_10_first_1['Atleta'])):
                        if Role_10_first_1['Atleta'][x] == jogadores:
                            a_values = Role_10_first_1.iloc[x].values.tolist()
                        if Role_10_first_1['Atleta'][x] == alvo:
                            b_values = Role_10_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################

                if perfil_similar == ("Primeiro Volante Equilibrado"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_11_data = pd.read_csv('11_Role_Volante_Equilibrado_Similarity.csv')
                    Role_11_data = Role_11_data.drop(Role_11_data.columns[0:4], axis=1)
                    Role_11_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_11_data.loc[(Role_11_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_11_data

                    # Step 9: Add columns "1", "2", "3" to Role_11_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]
                    selected['5'] = given_ID[4]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]


                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]


                    if given_ID[4] == "A":
                        selected['5'] = selected["A1"]
                    elif given_ID[4] == "B":
                        selected['5'] = selected["B1"]
                    elif given_ID[4] == "C":
                        selected['5'] = selected["C1"]
                    elif given_ID[4] == "D":
                        selected['5'] = selected["D1"]
                    elif given_ID[4] == "E":
                        selected['5'] = selected["E1"]
                    elif given_ID[4] == "F":
                        selected['5'] = selected["F1"]
                    elif given_ID[4] == "G":
                        selected['5'] = selected["G1"]
                    elif given_ID[4] == "H":
                        selected['5'] = selected["H1"]
                    elif given_ID[4] == "I":
                        selected['5'] = selected["I1"]
                    elif given_ID[4] == "J":
                        selected['5'] = selected["J1"]
                    elif given_ID[4] == "K":
                        selected['5'] = selected["K1"]


                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        Volante = selected.iloc[:, np.r_[-5:0]]

                        # Defining Columns
                        Volante_columns = Volante.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(Volante)

                        # Create a DataFrame with loadings
                        LoadingsVolante = pd.DataFrame(pca.components_.T**2, index=Volante_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(Volante, LoadingsVolante['loading factor 1']) + np.matmul(Volante, LoadingsVolante['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_11_data['Atleta'] == jogador_similar) & (Role_11_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 28, 33, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_11_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 28, 34:45]]
                    target = target.iloc[:, np.r_[0, 2, 28, 34:45]]
                    # Renomeando Colunas
                    Role_11_Mean_Charts = Role_11_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                            'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                            'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 'Corridas_Progressivas_Percentil':'Corridas Progressivas', 'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                    'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                    'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 'Corridas_Progressivas_Percentil':'Corridas Progressivas', 'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    #Dropping Atleta-alvo
                    Role_11_Mean_Charts = Role_11_Mean_Charts[Role_11_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_11_Mean_Charts = Role_11_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_11_first = Role_11_Mean_Charts.iloc[0:1, :]
                    Role_11_first = pd.concat([Role_11_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_11_first.iat[0, 1]
                    jogadores_clube = Role_11_first.iat[0, 2]
                    jogadores_liga = Role_11_first.iat[0, 3]
                    alvo = Role_11_first.iat[1, 1]
                    alvo_clube = Role_11_first.iat[1, 2]
                    alvo_liga = Role_11_first.iat[1, 3]

                    #Splitting Data
                    Role_11_first_1 = Role_11_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_11_first_2 = Role_11_first.iloc[:, np.r_[0:3, 9:15]]

                    # Preparing Graph 1
                    params = list(Role_11_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_1[params][x])
                        a = 0
                        b = max(Role_11_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_1['Atleta'])):
                        if Role_11_first_1['Atleta'][x] == jogadores:
                            a_values = Role_11_first_1.iloc[x].values.tolist()
                        if Role_11_first_1['Atleta'][x] == alvo:
                            b_values = Role_11_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_11_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_2[params][x])
                        a = 0
                        b = max(Role_11_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_2['Atleta'])):
                        if Role_11_first_2['Atleta'][x] == jogadores:
                            a_values = Role_11_first_2.iloc[x].values.tolist()
                        if Role_11_first_2['Atleta'][x] == alvo:
                            b_values = Role_11_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_11_first = Role_11_Mean_Charts.iloc[1:2, :]
                    Role_11_first = pd.concat([Role_11_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_11_first.iat[0, 1]
                    jogadores_clube = Role_11_first.iat[0, 2]
                    jogadores_liga = Role_11_first.iat[0, 3]
                    #alvo = Role_11_first.iat[1, 1]
                    #alvo_clube = Role_11_first.iat[1, 2]
                    #alvo_liga = Role_11_first.iat[1, 3]

                    #Splitting Data
                    Role_11_first_1 = Role_11_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_11_first_2 = Role_11_first.iloc[:, np.r_[0:3, 9:15]]

                    # Preparing Graph 1
                    params = list(Role_11_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_1[params][x])
                        a = 0
                        b = max(Role_11_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_1['Atleta'])):
                        if Role_11_first_1['Atleta'][x] == jogadores:
                            a_values = Role_11_first_1.iloc[x].values.tolist()
                        if Role_11_first_1['Atleta'][x] == alvo:
                            b_values = Role_11_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_11_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_2[params][x])
                        a = 0
                        b = max(Role_11_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_2['Atleta'])):
                        if Role_11_first_2['Atleta'][x] == jogadores:
                            a_values = Role_11_first_2.iloc[x].values.tolist()
                        if Role_11_first_2['Atleta'][x] == alvo:
                            b_values = Role_11_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_11_first = Role_11_Mean_Charts.iloc[2:3, :]
                    Role_11_first = pd.concat([Role_11_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_11_first.iat[0, 1]
                    jogadores_clube = Role_11_first.iat[0, 2]
                    jogadores_liga = Role_11_first.iat[0, 3]
                    #alvo = Role_11_first.iat[1, 1]
                    #alvo_clube = Role_11_first.iat[1, 2]
                    #alvo_liga = Role_11_first.iat[1, 3]

                    #Splitting Data
                    Role_11_first_1 = Role_11_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_11_first_2 = Role_11_first.iloc[:, np.r_[0:3, 9:15]]

                    # Preparing Graph 1
                    params = list(Role_11_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_1[params][x])
                        a = 0
                        b = max(Role_11_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_1['Atleta'])):
                        if Role_11_first_1['Atleta'][x] == jogadores:
                            a_values = Role_11_first_1.iloc[x].values.tolist()
                        if Role_11_first_1['Atleta'][x] == alvo:
                            b_values = Role_11_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_11_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_2[params][x])
                        a = 0
                        b = max(Role_11_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_2['Atleta'])):
                        if Role_11_first_2['Atleta'][x] == jogadores:
                            a_values = Role_11_first_2.iloc[x].values.tolist()
                        if Role_11_first_2['Atleta'][x] == alvo:
                            b_values = Role_11_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_11_first = Role_11_Mean_Charts.iloc[3:4, :]
                    Role_11_first = pd.concat([Role_11_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_11_first.iat[0, 1]
                    jogadores_clube = Role_11_first.iat[0, 2]
                    jogadores_liga = Role_11_first.iat[0, 3]
                    #alvo = Role_11_first.iat[1, 1]
                    #alvo_clube = Role_11_first.iat[1, 2]
                    #alvo_liga = Role_11_first.iat[1, 3]

                    #Splitting Data
                    Role_11_first_1 = Role_11_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_11_first_2 = Role_11_first.iloc[:, np.r_[0:3, 9:15]]

                    # Preparing Graph 1
                    params = list(Role_11_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_1[params][x])
                        a = 0
                        b = max(Role_11_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_1['Atleta'])):
                        if Role_11_first_1['Atleta'][x] == jogadores:
                            a_values = Role_11_first_1.iloc[x].values.tolist()
                        if Role_11_first_1['Atleta'][x] == alvo:
                            b_values = Role_11_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_11_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_2[params][x])
                        a = 0
                        b = max(Role_11_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_2['Atleta'])):
                        if Role_11_first_2['Atleta'][x] == jogadores:
                            a_values = Role_11_first_2.iloc[x].values.tolist()
                        if Role_11_first_2['Atleta'][x] == alvo:
                            b_values = Role_11_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_11_first = Role_11_Mean_Charts.iloc[4:5, :]
                    Role_11_first = pd.concat([Role_11_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_11_first.iat[0, 1]
                    jogadores_clube = Role_11_first.iat[0, 2]
                    jogadores_liga = Role_11_first.iat[0, 3]
                    #alvo = Role_11_first.iat[1, 1]
                    #alvo_clube = Role_11_first.iat[1, 2]
                    #alvo_liga = Role_11_first.iat[1, 3]

                    #Splitting Data
                    Role_11_first_1 = Role_11_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_11_first_2 = Role_11_first.iloc[:, np.r_[0:3, 9:15]]

                    # Preparing Graph 1
                    params = list(Role_11_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_1[params][x])
                        a = 0
                        b = max(Role_11_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_1['Atleta'])):
                        if Role_11_first_1['Atleta'][x] == jogadores:
                            a_values = Role_11_first_1.iloc[x].values.tolist()
                        if Role_11_first_1['Atleta'][x] == alvo:
                            b_values = Role_11_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_11_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_11_first_2[params][x])
                        a = 0
                        b = max(Role_11_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_11_first_2['Atleta'])):
                        if Role_11_first_2['Atleta'][x] == jogadores:
                            a_values = Role_11_first_2.iloc[x].values.tolist()
                        if Role_11_first_2['Atleta'][x] == alvo:
                            b_values = Role_11_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################
                    ########################################################################################################

                if perfil_similar == ("Segundo Volante Box to Box"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_12_data = pd.read_csv('12_Role_Segundo_Volante_Box_to_Box_Similarity.csv')
                    Role_12_data = Role_12_data.drop(Role_12_data.columns[0:4], axis=1)
                    Role_12_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_12_data.loc[(Role_12_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_12_data

                    # Step 9: Add columns "1", "2", "3" to Role_12_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]
                    selected['5'] = given_ID[4]
                    
                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    if given_ID[4] == "A":
                        selected['5'] = selected["A1"]
                    elif given_ID[4] == "B":
                        selected['5'] = selected["B1"]
                    elif given_ID[4] == "C":
                        selected['5'] = selected["C1"]
                    elif given_ID[4] == "D":
                        selected['5'] = selected["D1"]
                    elif given_ID[4] == "E":
                        selected['5'] = selected["E1"]
                    elif given_ID[4] == "F":
                        selected['5'] = selected["F1"]
                    elif given_ID[4] == "G":
                        selected['5'] = selected["G1"]
                    elif given_ID[4] == "H":
                        selected['5'] = selected["H1"]
                    elif given_ID[4] == "I":
                        selected['5'] = selected["I1"]
                    elif given_ID[4] == "J":
                        selected['5'] = selected["J1"]
                    elif given_ID[4] == "K":
                        selected['5'] = selected["K1"]
                    elif given_ID[4] == "L":
                        selected['5'] = selected["L1"]
                    elif given_ID[4] == "M":
                        selected['5'] = selected["M1"]


                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        SegundoVolanteBoxtoBox = selected.iloc[:, np.r_[-5:0]]

                        # Defining Columns
                        SegundoVolanteBoxtoBox_columns = SegundoVolanteBoxtoBox.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(SegundoVolanteBoxtoBox)

                        # Create a DataFrame with loadings
                        LoadingsSegundoVolanteBoxtoBox = pd.DataFrame(pca.components_.T**2, index=SegundoVolanteBoxtoBox_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(SegundoVolanteBoxtoBox, LoadingsSegundoVolanteBoxtoBox['loading factor 1']) + np.matmul(SegundoVolanteBoxtoBox, LoadingsSegundoVolanteBoxtoBox['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_12_data['Atleta'] == jogador_similar) & (Role_12_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_12_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_12_Mean_Charts = Role_12_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                                                'Pisadas_Área_Percentil':'Pisadas Área', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'xG_Percentil':'xG', 'xA_Percentil':'xA', 
                                                                                'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos',
                                                                                'Deep_Completions_Percentil':'Deep Completions', 
                                                                                'Passes_Chave_Percentil':'Passes Chave', 
                                                                                'Passes_ÁreaPênalti_Certos_Percentil':'Passes ÁreaPênalti Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                    'Pisadas_Área_Percentil':'Pisadas Área', 
                                                    'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                    'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                    'xG_Percentil':'xG', 'xA_Percentil':'xA', 
                                                    'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                    'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos',
                                                    'Deep_Completions_Percentil':'Deep Completions', 
                                                    'Passes_Chave_Percentil':'Passes Chave', 
                                                    'Passes_ÁreaPênalti_Certos_Percentil':'Passes ÁreaPênalti Certos'})
                    #Dropping Atleta-alvo
                    Role_12_Mean_Charts = Role_12_Mean_Charts[Role_12_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_12_Mean_Charts = Role_12_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_12_first = Role_12_Mean_Charts.iloc[0:1, :]
                    Role_12_first = pd.concat([Role_12_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_12_first.iat[0, 1]
                    jogadores_clube = Role_12_first.iat[0, 2]
                    jogadores_liga = Role_12_first.iat[0, 3]
                    alvo = Role_12_first.iat[1, 1]
                    alvo_clube = Role_12_first.iat[1, 2]
                    alvo_liga = Role_12_first.iat[1, 3]

                    #Splitting Data
                    Role_12_first_1 = Role_12_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_12_first_2 = Role_12_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_12_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_1[params][x])
                        a = 0
                        b = max(Role_12_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_1['Atleta'])):
                        if Role_12_first_1['Atleta'][x] == jogadores:
                            a_values = Role_12_first_1.iloc[x].values.tolist()
                        if Role_12_first_1['Atleta'][x] == alvo:
                            b_values = Role_12_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_12_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_2[params][x])
                        a = 0
                        b = max(Role_12_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_2['Atleta'])):
                        if Role_12_first_2['Atleta'][x] == jogadores:
                            a_values = Role_12_first_2.iloc[x].values.tolist()
                        if Role_12_first_2['Atleta'][x] == alvo:
                            b_values = Role_12_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_12_first = Role_12_Mean_Charts.iloc[1:2, :]
                    Role_12_first = pd.concat([Role_12_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_12_first.iat[0, 1]
                    jogadores_clube = Role_12_first.iat[0, 2]
                    jogadores_liga = Role_12_first.iat[0, 3]
                    #alvo = Role_12_first.iat[1, 1]
                    #alvo_clube = Role_12_first.iat[1, 2]
                    #alvo_liga = Role_12_first.iat[1, 3]

                    #Splitting Data
                    Role_12_first_1 = Role_12_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_12_first_2 = Role_12_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_12_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_1[params][x])
                        a = 0
                        b = max(Role_12_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_1['Atleta'])):
                        if Role_12_first_1['Atleta'][x] == jogadores:
                            a_values = Role_12_first_1.iloc[x].values.tolist()
                        if Role_12_first_1['Atleta'][x] == alvo:
                            b_values = Role_12_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_12_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_2[params][x])
                        a = 0
                        b = max(Role_12_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_2['Atleta'])):
                        if Role_12_first_2['Atleta'][x] == jogadores:
                            a_values = Role_12_first_2.iloc[x].values.tolist()
                        if Role_12_first_2['Atleta'][x] == alvo:
                            b_values = Role_12_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_12_first = Role_12_Mean_Charts.iloc[2:3, :]
                    Role_12_first = pd.concat([Role_12_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_12_first.iat[0, 1]
                    jogadores_clube = Role_12_first.iat[0, 2]
                    jogadores_liga = Role_12_first.iat[0, 3]
                    #alvo = Role_12_first.iat[1, 1]
                    #alvo_clube = Role_12_first.iat[1, 2]
                    #alvo_liga = Role_12_first.iat[1, 3]

                    #Splitting Data
                    Role_12_first_1 = Role_12_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_12_first_2 = Role_12_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_12_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_1[params][x])
                        a = 0
                        b = max(Role_12_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_1['Atleta'])):
                        if Role_12_first_1['Atleta'][x] == jogadores:
                            a_values = Role_12_first_1.iloc[x].values.tolist()
                        if Role_12_first_1['Atleta'][x] == alvo:
                            b_values = Role_12_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_12_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_2[params][x])
                        a = 0
                        b = max(Role_12_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_2['Atleta'])):
                        if Role_12_first_2['Atleta'][x] == jogadores:
                            a_values = Role_12_first_2.iloc[x].values.tolist()
                        if Role_12_first_2['Atleta'][x] == alvo:
                            b_values = Role_12_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_12_first = Role_12_Mean_Charts.iloc[3:4, :]
                    Role_12_first = pd.concat([Role_12_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_12_first.iat[0, 1]
                    jogadores_clube = Role_12_first.iat[0, 2]
                    jogadores_liga = Role_12_first.iat[0, 3]
                    #alvo = Role_12_first.iat[1, 1]
                    #alvo_clube = Role_12_first.iat[1, 2]
                    #alvo_liga = Role_12_first.iat[1, 3]

                    #Splitting Data
                    Role_12_first_1 = Role_12_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_12_first_2 = Role_12_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_12_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_1[params][x])
                        a = 0
                        b = max(Role_12_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_1['Atleta'])):
                        if Role_12_first_1['Atleta'][x] == jogadores:
                            a_values = Role_12_first_1.iloc[x].values.tolist()
                        if Role_12_first_1['Atleta'][x] == alvo:
                            b_values = Role_12_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_12_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_2[params][x])
                        a = 0
                        b = max(Role_12_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_2['Atleta'])):
                        if Role_12_first_2['Atleta'][x] == jogadores:
                            a_values = Role_12_first_2.iloc[x].values.tolist()
                        if Role_12_first_2['Atleta'][x] == alvo:
                            b_values = Role_12_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_12_first = Role_12_Mean_Charts.iloc[4:5, :]
                    Role_12_first = pd.concat([Role_12_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_12_first.iat[0, 1]
                    jogadores_clube = Role_12_first.iat[0, 2]
                    jogadores_liga = Role_12_first.iat[0, 3]
                    #alvo = Role_12_first.iat[1, 1]
                    #alvo_clube = Role_12_first.iat[1, 2]
                    #alvo_liga = Role_12_first.iat[1, 3]

                    #Splitting Data
                    Role_12_first_1 = Role_12_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_12_first_2 = Role_12_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_12_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_1[params][x])
                        a = 0
                        b = max(Role_12_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_1['Atleta'])):
                        if Role_12_first_1['Atleta'][x] == jogadores:
                            a_values = Role_12_first_1.iloc[x].values.tolist()
                        if Role_12_first_1['Atleta'][x] == alvo:
                            b_values = Role_12_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_12_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_12_first_2[params][x])
                        a = 0
                        b = max(Role_12_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_12_first_2['Atleta'])):
                        if Role_12_first_2['Atleta'][x] == jogadores:
                            a_values = Role_12_first_2.iloc[x].values.tolist()
                        if Role_12_first_2['Atleta'][x] == alvo:
                            b_values = Role_12_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################

                if perfil_similar == ("Segundo Volante Organizador"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_13_data = pd.read_csv('13_Role_Segundo_Volante_Organizador_Similarity.csv')
                    Role_13_data = Role_13_data.drop(Role_13_data.columns[0:4], axis=1)
                    Role_13_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_13_data.loc[(Role_13_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_13_data

                    # Step 9: Add columns "1", "2", "3" to Role_13_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        SegundoVolanteOrganizador = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        SegundoVolanteOrganizador_columns = SegundoVolanteOrganizador.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(SegundoVolanteOrganizador)

                        # Create a DataFrame with loadings
                        LoadingsSegundoVolanteOrganizador = pd.DataFrame(pca.components_.T**2, index=SegundoVolanteOrganizador_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(SegundoVolanteOrganizador, LoadingsSegundoVolanteOrganizador['loading factor 1']) + np.matmul(SegundoVolanteOrganizador, LoadingsSegundoVolanteOrganizador['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_13_data['Atleta'] == jogador_similar) & (Role_13_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 27, 32, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_13_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 27, 33:43]]
                    target = target.iloc[:, np.r_[0, 2, 27, 33:43]]
                    # Renomeando Colunas
                    Role_13_Mean_Charts = Role_13_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                            'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                            'Pisadas_Área_Percentil':'Pisadas Área', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                            'xA_Percentil':'xA', 
                                                            'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos',
                                                            'Deep_Completions_Percentil':'Deep Completions', 
                                                            'Passes_ÁreaPênalti_Certos_Percentil':'Passes ÁreaPênalti Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                            'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                            'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                            'Pisadas_Área_Percentil':'Pisadas Área', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                            'xA_Percentil':'xA', 
                                                            'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos',
                                                            'Deep_Completions_Percentil':'Deep Completions', 
                                                            'Passes_ÁreaPênalti_Certos_Percentil':'Passes ÁreaPênalti Certos'})
                    #Dropping Atleta-alvo
                    Role_13_Mean_Charts = Role_13_Mean_Charts[Role_13_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_13_Mean_Charts = Role_13_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_13_first = Role_13_Mean_Charts.iloc[0:1, :]
                    Role_13_first = pd.concat([Role_13_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_13_first.iat[0, 1]
                    jogadores_clube = Role_13_first.iat[0, 2]
                    jogadores_liga = Role_13_first.iat[0, 3]
                    alvo = Role_13_first.iat[1, 1]
                    alvo_clube = Role_13_first.iat[1, 2]
                    alvo_liga = Role_13_first.iat[1, 3]

                    #Splitting Data
                    Role_13_first_1 = Role_13_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_13_first_2 = Role_13_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_13_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_1[params][x])
                        a = 0
                        b = max(Role_13_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_1['Atleta'])):
                        if Role_13_first_1['Atleta'][x] == jogadores:
                            a_values = Role_13_first_1.iloc[x].values.tolist()
                        if Role_13_first_1['Atleta'][x] == alvo:
                            b_values = Role_13_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_13_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_2[params][x])
                        a = 0
                        b = max(Role_13_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_2['Atleta'])):
                        if Role_13_first_2['Atleta'][x] == jogadores:
                            a_values = Role_13_first_2.iloc[x].values.tolist()
                        if Role_13_first_2['Atleta'][x] == alvo:
                            b_values = Role_13_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_13_first = Role_13_Mean_Charts.iloc[1:2, :]
                    Role_13_first = pd.concat([Role_13_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_13_first.iat[0, 1]
                    jogadores_clube = Role_13_first.iat[0, 2]
                    jogadores_liga = Role_13_first.iat[0, 3]

                    #Splitting Data
                    Role_13_first_1 = Role_13_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_13_first_2 = Role_13_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_13_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_1[params][x])
                        a = 0
                        b = max(Role_13_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_1['Atleta'])):
                        if Role_13_first_1['Atleta'][x] == jogadores:
                            a_values = Role_13_first_1.iloc[x].values.tolist()
                        if Role_13_first_1['Atleta'][x] == alvo:
                            b_values = Role_13_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_13_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_2[params][x])
                        a = 0
                        b = max(Role_13_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_2['Atleta'])):
                        if Role_13_first_2['Atleta'][x] == jogadores:
                            a_values = Role_13_first_2.iloc[x].values.tolist()
                        if Role_13_first_2['Atleta'][x] == alvo:
                            b_values = Role_13_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_13_first = Role_13_Mean_Charts.iloc[2:3, :]
                    Role_13_first = pd.concat([Role_13_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_13_first.iat[0, 1]
                    jogadores_clube = Role_13_first.iat[0, 2]
                    jogadores_liga = Role_13_first.iat[0, 3]

                    #Splitting Data
                    Role_13_first_1 = Role_13_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_13_first_2 = Role_13_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_13_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_1[params][x])
                        a = 0
                        b = max(Role_13_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_1['Atleta'])):
                        if Role_13_first_1['Atleta'][x] == jogadores:
                            a_values = Role_13_first_1.iloc[x].values.tolist()
                        if Role_13_first_1['Atleta'][x] == alvo:
                            b_values = Role_13_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_13_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_2[params][x])
                        a = 0
                        b = max(Role_13_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_2['Atleta'])):
                        if Role_13_first_2['Atleta'][x] == jogadores:
                            a_values = Role_13_first_2.iloc[x].values.tolist()
                        if Role_13_first_2['Atleta'][x] == alvo:
                            b_values = Role_13_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_13_first = Role_13_Mean_Charts.iloc[3:4, :]
                    Role_13_first = pd.concat([Role_13_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_13_first.iat[0, 1]
                    jogadores_clube = Role_13_first.iat[0, 2]
                    jogadores_liga = Role_13_first.iat[0, 3]

                    #Splitting Data
                    Role_13_first_1 = Role_13_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_13_first_2 = Role_13_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_13_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_1[params][x])
                        a = 0
                        b = max(Role_13_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_1['Atleta'])):
                        if Role_13_first_1['Atleta'][x] == jogadores:
                            a_values = Role_13_first_1.iloc[x].values.tolist()
                        if Role_13_first_1['Atleta'][x] == alvo:
                            b_values = Role_13_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_13_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_2[params][x])
                        a = 0
                        b = max(Role_13_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_2['Atleta'])):
                        if Role_13_first_2['Atleta'][x] == jogadores:
                            a_values = Role_13_first_2.iloc[x].values.tolist()
                        if Role_13_first_2['Atleta'][x] == alvo:
                            b_values = Role_13_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_13_first = Role_13_Mean_Charts.iloc[4:5, :]
                    Role_13_first = pd.concat([Role_13_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_13_first.iat[0, 1]
                    jogadores_clube = Role_13_first.iat[0, 2]
                    jogadores_liga = Role_13_first.iat[0, 3]

                    #Splitting Data
                    Role_13_first_1 = Role_13_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_13_first_2 = Role_13_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_13_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_1[params][x])
                        a = 0
                        b = max(Role_13_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_1['Atleta'])):
                        if Role_13_first_1['Atleta'][x] == jogadores:
                            a_values = Role_13_first_1.iloc[x].values.tolist()
                        if Role_13_first_1['Atleta'][x] == alvo:
                            b_values = Role_13_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_13_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_13_first_2[params][x])
                        a = 0
                        b = max(Role_13_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_13_first_2['Atleta'])):
                        if Role_13_first_2['Atleta'][x] == jogadores:
                            a_values = Role_13_first_2.iloc[x].values.tolist()
                        if Role_13_first_2['Atleta'][x] == alvo:
                            b_values = Role_13_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################

                if perfil_similar == ("Segundo Volante Equilibrado"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_14_data = pd.read_csv('14_Role_Segundo_Volante_Equilibrado_Similarity.csv')
                    Role_14_data = Role_14_data.drop(Role_14_data.columns[0:4], axis=1)
                    Role_14_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_14_data.loc[(Role_14_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_14_data

                    # Step 9: Add columns "1", "2", "3" to Role_14_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        SegundoVolante = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        SegundoVolante_columns = SegundoVolante.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(SegundoVolante)

                        # Create a DataFrame with loadings
                        LoadingsSegundoVolante = pd.DataFrame(pca.components_.T**2, index=SegundoVolante_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(SegundoVolante, LoadingsSegundoVolante['loading factor 1']) + np.matmul(SegundoVolante, LoadingsSegundoVolante['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_14_data['Atleta'] == jogador_similar) & (Role_14_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')
                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)
                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_14_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_14_Mean_Charts = Role_14_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    #Dropping Atleta-alvo
                    Role_14_Mean_Charts = Role_14_Mean_Charts[Role_14_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_14_Mean_Charts = Role_14_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_14_first = Role_14_Mean_Charts.iloc[0:1, :]
                    Role_14_first = pd.concat([Role_14_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_14_first.iat[0, 1]
                    jogadores_clube = Role_14_first.iat[0, 2]
                    jogadores_liga = Role_14_first.iat[0, 3]
                    alvo = Role_14_first.iat[1, 1]
                    alvo_clube = Role_14_first.iat[1, 2]
                    alvo_liga = Role_14_first.iat[1, 3]

                    #Splitting Data
                    Role_14_first_1 = Role_14_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_14_first_2 = Role_14_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_14_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_1[params][x])
                        a = 0
                        b = max(Role_14_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_1['Atleta'])):
                        if Role_14_first_1['Atleta'][x] == jogadores:
                            a_values = Role_14_first_1.iloc[x].values.tolist()
                        if Role_14_first_1['Atleta'][x] == alvo:
                            b_values = Role_14_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_14_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_2[params][x])
                        a = 0
                        b = max(Role_14_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_2['Atleta'])):
                        if Role_14_first_2['Atleta'][x] == jogadores:
                            a_values = Role_14_first_2.iloc[x].values.tolist()
                        if Role_14_first_2['Atleta'][x] == alvo:
                            b_values = Role_14_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_14_first = Role_14_Mean_Charts.iloc[1:2, :]
                    Role_14_first = pd.concat([Role_14_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_14_first.iat[0, 1]
                    jogadores_clube = Role_14_first.iat[0, 2]
                    jogadores_liga = Role_14_first.iat[0, 3]
                    #alvo = Role_14_first.iat[1, 1]
                    #alvo_clube = Role_14_first.iat[1, 2]
                    #alvo_liga = Role_14_first.iat[1, 3]

                    #Splitting Data
                    Role_14_first_1 = Role_14_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_14_first_2 = Role_14_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_14_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_1[params][x])
                        a = 0
                        b = max(Role_14_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_1['Atleta'])):
                        if Role_14_first_1['Atleta'][x] == jogadores:
                            a_values = Role_14_first_1.iloc[x].values.tolist()
                        if Role_14_first_1['Atleta'][x] == alvo:
                            b_values = Role_14_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_14_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_2[params][x])
                        a = 0
                        b = max(Role_14_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_2['Atleta'])):
                        if Role_14_first_2['Atleta'][x] == jogadores:
                            a_values = Role_14_first_2.iloc[x].values.tolist()
                        if Role_14_first_2['Atleta'][x] == alvo:
                            b_values = Role_14_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_14_first = Role_14_Mean_Charts.iloc[2:3, :]
                    Role_14_first = pd.concat([Role_14_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_14_first.iat[0, 1]
                    jogadores_clube = Role_14_first.iat[0, 2]
                    jogadores_liga = Role_14_first.iat[0, 3]
                    #alvo = Role_14_first.iat[1, 1]
                    #alvo_clube = Role_14_first.iat[1, 2]
                    #alvo_liga = Role_14_first.iat[1, 3]

                    #Splitting Data
                    Role_14_first_1 = Role_14_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_14_first_2 = Role_14_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_14_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_1[params][x])
                        a = 0
                        b = max(Role_14_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_1['Atleta'])):
                        if Role_14_first_1['Atleta'][x] == jogadores:
                            a_values = Role_14_first_1.iloc[x].values.tolist()
                        if Role_14_first_1['Atleta'][x] == alvo:
                            b_values = Role_14_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_14_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_2[params][x])
                        a = 0
                        b = max(Role_14_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_2['Atleta'])):
                        if Role_14_first_2['Atleta'][x] == jogadores:
                            a_values = Role_14_first_2.iloc[x].values.tolist()
                        if Role_14_first_2['Atleta'][x] == alvo:
                            b_values = Role_14_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_14_first = Role_14_Mean_Charts.iloc[3:4, :]
                    Role_14_first = pd.concat([Role_14_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_14_first.iat[0, 1]
                    jogadores_clube = Role_14_first.iat[0, 2]
                    jogadores_liga = Role_14_first.iat[0, 3]
                    #alvo = Role_14_first.iat[1, 1]
                    #alvo_clube = Role_14_first.iat[1, 2]
                    #alvo_liga = Role_14_first.iat[1, 3]

                    #Splitting Data
                    Role_14_first_1 = Role_14_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_14_first_2 = Role_14_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_14_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_1[params][x])
                        a = 0
                        b = max(Role_14_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_1['Atleta'])):
                        if Role_14_first_1['Atleta'][x] == jogadores:
                            a_values = Role_14_first_1.iloc[x].values.tolist()
                        if Role_14_first_1['Atleta'][x] == alvo:
                            b_values = Role_14_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_14_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_2[params][x])
                        a = 0
                        b = max(Role_14_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_2['Atleta'])):
                        if Role_14_first_2['Atleta'][x] == jogadores:
                            a_values = Role_14_first_2.iloc[x].values.tolist()
                        if Role_14_first_2['Atleta'][x] == alvo:
                            b_values = Role_14_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_14_first = Role_14_Mean_Charts.iloc[4:5, :]
                    Role_14_first = pd.concat([Role_14_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_14_first.iat[0, 1]
                    jogadores_clube = Role_14_first.iat[0, 2]
                    jogadores_liga = Role_14_first.iat[0, 3]
                    #alvo = Role_14_first.iat[1, 1]
                    #alvo_clube = Role_14_first.iat[1, 2]
                    #alvo_liga = Role_14_first.iat[1, 3]

                    #Splitting Data
                    Role_14_first_1 = Role_14_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_14_first_2 = Role_14_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_14_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_1[params][x])
                        a = 0
                        b = max(Role_14_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_1['Atleta'])):
                        if Role_14_first_1['Atleta'][x] == jogadores:
                            a_values = Role_14_first_1.iloc[x].values.tolist()
                        if Role_14_first_1['Atleta'][x] == alvo:
                            b_values = Role_14_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_14_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_14_first_2[params][x])
                        a = 0
                        b = max(Role_14_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_14_first_2['Atleta'])):
                        if Role_14_first_2['Atleta'][x] == jogadores:
                            a_values = Role_14_first_2.iloc[x].values.tolist()
                        if Role_14_first_2['Atleta'][x] == alvo:
                            b_values = Role_14_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    
                elif perfil_similar == ("Meia Organizador"):
                    #####################################################################################################################
                    #####################################################################################################################
                    # MeiaAtacante EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_15_data = pd.read_csv('15_Role_Meia_Organizador_Similarity.csv')
                    Role_15_data = Role_15_data.drop(Role_15_data.columns[0:4], axis=1)
                    Role_15_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_15_data.loc[(Role_15_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_15_data

                    # Step 9: Add columns "1", "2", "3" to Role_15_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]


                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]


                    #############################################################
                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        MeiaOrganizador = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        MeiaOrganizador_columns = MeiaOrganizador.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(MeiaOrganizador)

                        # Create a DataFrame with loadings
                        LoadingsMeiaOrganizador = pd.DataFrame(pca.components_.T**2, index=MeiaOrganizador_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(MeiaOrganizador, LoadingsMeiaOrganizador['loading factor 1']) + np.matmul(MeiaOrganizador, LoadingsMeiaOrganizador['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_15_data['Atleta'] == jogador_similar) & (Role_15_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 27, 32, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")    

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    ########################################################################################################
                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_15_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 27, 33:43]]
                    target = target.iloc[:, np.r_[0, 2, 27, 33:43]]
                    # Renomeando Colunas
                    Role_15_Mean_Charts = Role_15_Mean_Charts.rename(columns={'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                          'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos',
                                                            'Passes_Progressivos_Certos_Percentil': 'Passes Progressivos Certos', 
                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                            'xA_Percentil':'xA', 
                                                            'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos', 
                                                            'Passes_EntreLinhas_Certos_Percentil':'Passes EntreLinhas Certos', 
                                                            'Passes_Chave_Percentil':'Passes Chave'})

                    target = target.rename(columns={'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                          'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos',
                                                            'Passes_Progressivos_Certos_Percentil': 'Passes Progressivos Certos', 
                                                            'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                            'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                            'xA_Percentil':'xA', 
                                                            'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                            'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos', 
                                                            'Passes_EntreLinhas_Certos_Percentil':'Passes EntreLinhas Certos', 
                                                            'Passes_Chave_Percentil':'Passes Chave'})                        
                    #Dropping Atleta-alvo
                    Role_15_Mean_Charts = Role_15_Mean_Charts[Role_15_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_15_Mean_Charts = Role_15_Mean_Charts.iloc[0:5, :]

                    ############################################################################################
                    #Primeiro Gráfico
                    Role_15_first = Role_15_Mean_Charts.iloc[0:1, :]
                    Role_15_first = pd.concat([Role_15_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_15_first.iat[0, 1]
                    jogadores_clube = Role_15_first.iat[0, 2]
                    jogadores_liga = Role_15_first.iat[0, 3]
                    alvo = Role_15_first.iat[1, 1]
                    alvo_clube = Role_15_first.iat[1, 2]
                    alvo_liga = Role_15_first.iat[1, 3]

                    #Splitting Data
                    Role_15_first_1 = Role_15_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_15_first_2 = Role_15_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_15_first_1.columns)
                    params = params[4:]


                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_1[params][x])
                        a = 0
                        b = max(Role_15_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_1['Atleta'])):
                        if Role_15_first_1['Atleta'][x] == jogadores:
                            a_values = Role_15_first_1.iloc[x].values.tolist()
                        if Role_15_first_1['Atleta'][x] == alvo:
                            b_values = Role_15_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_15_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_2[params][x])
                        a = 0
                        b = max(Role_15_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_2['Atleta'])):
                        if Role_15_first_2['Atleta'][x] == jogadores:
                            a_values = Role_15_first_2.iloc[x].values.tolist()
                        if Role_15_first_2['Atleta'][x] == alvo:
                            b_values = Role_15_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    ############################################################################

                    #Segundo Gráfico
                    Role_15_first = Role_15_Mean_Charts.iloc[1:2, :]
                    Role_15_first = pd.concat([Role_15_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_15_first.iat[0, 1]
                    jogadores_clube = Role_15_first.iat[0, 2]
                    jogadores_liga = Role_15_first.iat[0, 3]

                    #Splitting Data
                    Role_15_first_1 = Role_15_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_15_first_2 = Role_15_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_15_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_1[params][x])
                        a = 0
                        b = max(Role_15_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_1['Atleta'])):
                        if Role_15_first_1['Atleta'][x] == jogadores:
                            a_values = Role_15_first_1.iloc[x].values.tolist()
                        if Role_15_first_1['Atleta'][x] == alvo:
                            b_values = Role_15_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_15_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_2[params][x])
                        a = 0
                        b = max(Role_15_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_2['Atleta'])):
                        if Role_15_first_2['Atleta'][x] == jogadores:
                            a_values = Role_15_first_2.iloc[x].values.tolist()
                        if Role_15_first_2['Atleta'][x] == alvo:
                            b_values = Role_15_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_15_first = Role_15_Mean_Charts.iloc[2:3, :]
                    Role_15_first = pd.concat([Role_15_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_15_first.iat[0, 1]
                    jogadores_clube = Role_15_first.iat[0, 2]
                    jogadores_liga = Role_15_first.iat[0, 3]

                    #Splitting Data
                    Role_15_first_1 = Role_15_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_15_first_2 = Role_15_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_15_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_1[params][x])
                        a = 0
                        b = max(Role_15_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_1['Atleta'])):
                        if Role_15_first_1['Atleta'][x] == jogadores:
                            a_values = Role_15_first_1.iloc[x].values.tolist()
                        if Role_15_first_1['Atleta'][x] == alvo:
                            b_values = Role_15_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_15_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_2[params][x])
                        a = 0
                        b = max(Role_15_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_2['Atleta'])):
                        if Role_15_first_2['Atleta'][x] == jogadores:
                            a_values = Role_15_first_2.iloc[x].values.tolist()
                        if Role_15_first_2['Atleta'][x] == alvo:
                            b_values = Role_15_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_15_first = Role_15_Mean_Charts.iloc[3:4, :]
                    Role_15_first = pd.concat([Role_15_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_15_first.iat[0, 1]
                    jogadores_clube = Role_15_first.iat[0, 2]
                    jogadores_liga = Role_15_first.iat[0, 3]

                    #Splitting Data
                    Role_15_first_1 = Role_15_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_15_first_2 = Role_15_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_15_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_1[params][x])
                        a = 0
                        b = max(Role_15_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_1['Atleta'])):
                        if Role_15_first_1['Atleta'][x] == jogadores:
                            a_values = Role_15_first_1.iloc[x].values.tolist()
                        if Role_15_first_1['Atleta'][x] == alvo:
                            b_values = Role_15_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_15_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_2[params][x])
                        a = 0
                        b = max(Role_15_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_2['Atleta'])):
                        if Role_15_first_2['Atleta'][x] == jogadores:
                            a_values = Role_15_first_2.iloc[x].values.tolist()
                        if Role_15_first_2['Atleta'][x] == alvo:
                            b_values = Role_15_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_15_first = Role_15_Mean_Charts.iloc[4:5, :]
                    Role_15_first = pd.concat([Role_15_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_15_first.iat[0, 1]
                    jogadores_clube = Role_15_first.iat[0, 2]
                    jogadores_liga = Role_15_first.iat[0, 3]

                    #Splitting Data
                    Role_15_first_1 = Role_15_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_15_first_2 = Role_15_first.iloc[:, np.r_[0:3, 8:14]]

                    # Preparing Graph 1
                    params = list(Role_15_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_1[params][x])
                        a = 0
                        b = max(Role_15_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_1['Atleta'])):
                        if Role_15_first_1['Atleta'][x] == jogadores:
                            a_values = Role_15_first_1.iloc[x].values.tolist()
                        if Role_15_first_1['Atleta'][x] == alvo:
                            b_values = Role_15_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_15_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_15_first_2[params][x])
                        a = 0
                        b = max(Role_15_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_15_first_2['Atleta'])):
                        if Role_15_first_2['Atleta'][x] == jogadores:
                            a_values = Role_15_first_2.iloc[x].values.tolist()
                        if Role_15_first_2['Atleta'][x] == alvo:
                            b_values = Role_15_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                elif perfil_similar == ("Meia Atacante"):
                    #####################################################################################################################
                    #####################################################################################################################
                    # MeiaAtacante EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_16_data = pd.read_csv('16_Role_Meia_Atacante_Similarity.csv')
                    Role_16_data = Role_16_data.drop(Role_16_data.columns[0:4], axis=1)
                    Role_16_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_16_data.loc[(Role_16_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]

                    # Definição da Base de Trabalho
                    selected = Role_16_data

                    # Step 9: Add columns "1", "2", "3" to Role_16_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]
                    selected['5'] = given_ID[4]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]
                    elif given_ID[0] == "N":
                        selected['1'] = selected["N1"]
                    elif given_ID[0] == "O":
                        selected['1'] = selected["O1"]
                    elif given_ID[0] == "P":
                        selected['1'] = selected["P1"]
                    elif given_ID[0] == "Q":
                        selected['1'] = selected["Q1"]
                    elif given_ID[0] == "R":
                        selected['1'] = selected["R1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    elif given_ID[1] == "N":
                        selected['2'] = selected["N1"]
                    elif given_ID[1] == "O":
                        selected['2'] = selected["O1"]
                    elif given_ID[1] == "P":
                        selected['2'] = selected["P1"]
                    elif given_ID[1] == "Q":
                        selected['2'] = selected["Q1"]
                    elif given_ID[1] == "R":
                        selected['2'] = selected["R1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]
                    elif given_ID[2] == "N":
                        selected['3'] = selected["N1"]
                    elif given_ID[2] == "O":
                        selected['3'] = selected["O1"]
                    elif given_ID[2] == "P":
                        selected['3'] = selected["P1"]
                    elif given_ID[2] == "Q":
                        selected['3'] = selected["Q1"]
                    elif given_ID[2] == "R":
                        selected['3'] = selected["R1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]
                    elif given_ID[3] == "N":
                        selected['4'] = selected["N1"]
                    elif given_ID[3] == "O":
                        selected['4'] = selected["O1"]
                    elif given_ID[3] == "P":
                        selected['4'] = selected["P1"]
                    elif given_ID[3] == "Q":
                        selected['4'] = selected["Q1"]
                    elif given_ID[3] == "R":
                        selected['4'] = selected["R1"]


                    if given_ID[4] == "A":
                        selected['5'] = selected["A1"]
                    elif given_ID[4] == "B":
                        selected['5'] = selected["B1"]
                    elif given_ID[4] == "C":
                        selected['5'] = selected["C1"]
                    elif given_ID[4] == "D":
                        selected['5'] = selected["D1"]
                    elif given_ID[4] == "E":
                        selected['5'] = selected["E1"]
                    elif given_ID[4] == "F":
                        selected['5'] = selected["F1"]
                    elif given_ID[4] == "G":
                        selected['5'] = selected["G1"]
                    elif given_ID[4] == "H":
                        selected['5'] = selected["H1"]
                    elif given_ID[4] == "I":
                        selected['5'] = selected["I1"]
                    elif given_ID[4] == "J":
                        selected['5'] = selected["J1"]
                    elif given_ID[4] == "K":
                        selected['5'] = selected["K1"]
                    elif given_ID[4] == "L":
                        selected['5'] = selected["L1"]
                    elif given_ID[4] == "M":
                        selected['5'] = selected["M1"]
                    elif given_ID[4] == "N":
                        selected['5'] = selected["N1"]
                    elif given_ID[4] == "O":
                        selected['5'] = selected["O1"]
                    elif given_ID[4] == "P":
                        selected['5'] = selected["P1"]
                    elif given_ID[4] == "Q":
                        selected['5'] = selected["Q1"]
                    elif given_ID[4] == "R":
                        selected['5'] = selected["R1"]

                    #############################################################
                    #############################################################

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        MeiaAtacante = selected.iloc[:, np.r_[-5:0]]

                        # Defining Columns
                        MeiaAtacante_columns = MeiaAtacante.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(MeiaAtacante)

                        # Create a DataFrame with loadings
                        LoadingsMeiaAtacante = pd.DataFrame(pca.components_.T**2, index=MeiaAtacante_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(MeiaAtacante, LoadingsMeiaAtacante['loading factor 1']) + np.matmul(MeiaAtacante, LoadingsMeiaAtacante['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    #MeiaAtacante = MeiaAtacante.join(Similarity)
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_16_data['Atleta'] == jogador_similar) & (Role_16_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 34, 39, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")    

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    

                    ########################################################################################################
                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_16_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 34, 40:57]]
                    target = target.iloc[:, np.r_[0, 2, 34, 40:57]]
                    # Renomeando Colunas
                    Role_16_Mean_Charts = Role_16_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                                              'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                              'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Pisadas_Área_Percentil':'Pisadas Área', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Acelerações_Percentil':'Acelerações', 
                                                                                'xA_Percentil':'xA', 
                                                                                'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos', 
                                                                                'Deep_Completions_Percentil':'Deep Completions',
                                                                                'Deep_Completed_Crosses_Percentil':'Deep Completed Crosses', 
                                                                                'Passes_ÁreaPênalti_Certos_Percentil':'Passes ÁreaPênalti Certos'})

                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos', 
                                                                              'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                              'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos',
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Ações_Ofensivas_BemSucedidas_Percentil':'Ações Ofensivas BemSucedidas', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Pisadas_Área_Percentil':'Pisadas Área', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Acelerações_Percentil':'Acelerações', 
                                                                                'xA_Percentil':'xA', 
                                                                                'Assistência_Finalização_Percentil':'Assistência Finalização', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos', 
                                                                                'Deep_Completions_Percentil':'Deep Completions',
                                                                                'Deep_Completed_Crosses_Percentil':'Deep Completed Crosses', 
                                                                                'Passes_ÁreaPênalti_Certos_Percentil':'Passes ÁreaPênalti Certos'})                        
                    #Dropping Atleta-alvo
                    Role_16_Mean_Charts = Role_16_Mean_Charts[Role_16_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_16_Mean_Charts = Role_16_Mean_Charts.iloc[0:5, :]

                    ############################################################################################
                    #Primeiro Gráfico
                    Role_16_first = Role_16_Mean_Charts.iloc[0:1, :]
                    Role_16_first = pd.concat([Role_16_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_16_first.iat[0, 1]
                    jogadores_clube = Role_16_first.iat[0, 2]
                    jogadores_liga = Role_16_first.iat[0, 3]
                    alvo = Role_16_first.iat[1, 1]
                    alvo_clube = Role_16_first.iat[1, 2]
                    alvo_liga = Role_16_first.iat[1, 3]

                    #Splitting Data
                    Role_16_first_1 = Role_16_first.iloc[:, np.r_[0:3, 3:13]]
                    Role_16_first_2 = Role_16_first.iloc[:, np.r_[0:3, 13:21]]

                    # Preparing Graph 1
                    params = list(Role_16_first_1.columns)
                    params = params[4:]


                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_1[params][x])
                        a = 0
                        b = max(Role_16_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_1['Atleta'])):
                        if Role_16_first_1['Atleta'][x] == jogadores:
                            a_values = Role_16_first_1.iloc[x].values.tolist()
                        if Role_16_first_1['Atleta'][x] == alvo:
                            b_values = Role_16_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_16_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_2[params][x])
                        a = 0
                        b = max(Role_16_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_2['Atleta'])):
                        if Role_16_first_2['Atleta'][x] == jogadores:
                            a_values = Role_16_first_2.iloc[x].values.tolist()
                        if Role_16_first_2['Atleta'][x] == alvo:
                            b_values = Role_16_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    ############################################################################

                    #Segundo Gráfico
                    Role_16_first = Role_16_Mean_Charts.iloc[1:2, :]
                    Role_16_first = pd.concat([Role_16_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_16_first.iat[0, 1]
                    jogadores_clube = Role_16_first.iat[0, 2]
                    jogadores_liga = Role_16_first.iat[0, 3]
                    alvo = Role_16_first.iat[1, 1]
                    alvo_clube = Role_16_first.iat[1, 2]
                    alvo_liga = Role_16_first.iat[1, 3]

                    #Splitting Data
                    Role_16_first_1 = Role_16_first.iloc[:, np.r_[0:3, 3:13]]
                    Role_16_first_2 = Role_16_first.iloc[:, np.r_[0:3, 13:21]]

                    # Preparing Graph 1
                    params = list(Role_16_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_1[params][x])
                        a = 0
                        b = max(Role_16_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_1['Atleta'])):
                        if Role_16_first_1['Atleta'][x] == jogadores:
                            a_values = Role_16_first_1.iloc[x].values.tolist()
                        if Role_16_first_1['Atleta'][x] == alvo:
                            b_values = Role_16_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_16_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_2[params][x])
                        a = 0
                        b = max(Role_16_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_2['Atleta'])):
                        if Role_16_first_2['Atleta'][x] == jogadores:
                            a_values = Role_16_first_2.iloc[x].values.tolist()
                        if Role_16_first_2['Atleta'][x] == alvo:
                            b_values = Role_16_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_16_first = Role_16_Mean_Charts.iloc[2:3, :]
                    Role_16_first = pd.concat([Role_16_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_16_first.iat[0, 1]
                    jogadores_clube = Role_16_first.iat[0, 2]
                    jogadores_liga = Role_16_first.iat[0, 3]
                    #alvo = Role_16_first.iat[1, 1]
                    #alvo_clube = Role_16_first.iat[1, 2]
                    #alvo_liga = Role_16_first.iat[1, 3]

                    #Splitting Data
                    Role_16_first_1 = Role_16_first.iloc[:, np.r_[0:3, 3:13]]
                    Role_16_first_2 = Role_16_first.iloc[:, np.r_[0:3, 13:21]]

                    # Preparing Graph 1
                    params = list(Role_16_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_1[params][x])
                        a = 0
                        b = max(Role_16_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_1['Atleta'])):
                        if Role_16_first_1['Atleta'][x] == jogadores:
                            a_values = Role_16_first_1.iloc[x].values.tolist()
                        if Role_16_first_1['Atleta'][x] == alvo:
                            b_values = Role_16_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_16_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_2[params][x])
                        a = 0
                        b = max(Role_16_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_2['Atleta'])):
                        if Role_16_first_2['Atleta'][x] == jogadores:
                            a_values = Role_16_first_2.iloc[x].values.tolist()
                        if Role_16_first_2['Atleta'][x] == alvo:
                            b_values = Role_16_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_16_first = Role_16_Mean_Charts.iloc[3:4, :]
                    Role_16_first = pd.concat([Role_16_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_16_first.iat[0, 1]
                    jogadores_clube = Role_16_first.iat[0, 2]
                    jogadores_liga = Role_16_first.iat[0, 3]
                    #alvo = Role_16_first.iat[1, 1]
                    #alvo_clube = Role_16_first.iat[1, 2]
                    #alvo_liga = Role_16_first.iat[1, 3]

                    #Splitting Data
                    Role_16_first_1 = Role_16_first.iloc[:, np.r_[0:3, 3:13]]
                    Role_16_first_2 = Role_16_first.iloc[:, np.r_[0:3, 13:21]]

                    # Preparing Graph 1
                    params = list(Role_16_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_1[params][x])
                        a = 0
                        b = max(Role_16_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_1['Atleta'])):
                        if Role_16_first_1['Atleta'][x] == jogadores:
                            a_values = Role_16_first_1.iloc[x].values.tolist()
                        if Role_16_first_1['Atleta'][x] == alvo:
                            b_values = Role_16_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_16_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_2[params][x])
                        a = 0
                        b = max(Role_16_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_2['Atleta'])):
                        if Role_16_first_2['Atleta'][x] == jogadores:
                            a_values = Role_16_first_2.iloc[x].values.tolist()
                        if Role_16_first_2['Atleta'][x] == alvo:
                            b_values = Role_16_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_16_first = Role_16_Mean_Charts.iloc[4:5, :]
                    Role_16_first = pd.concat([Role_16_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_16_first.iat[0, 1]
                    jogadores_clube = Role_16_first.iat[0, 2]
                    jogadores_liga = Role_16_first.iat[0, 3]
                    #alvo = Role_16_first.iat[1, 1]
                    #alvo_clube = Role_16_first.iat[1, 2]
                    #alvo_liga = Role_16_first.iat[1, 3]

                    #Splitting Data
                    Role_16_first_1 = Role_16_first.iloc[:, np.r_[0:3, 3:13]]
                    Role_16_first_2 = Role_16_first.iloc[:, np.r_[0:3, 13:21]]

                    # Preparing Graph 1
                    params = list(Role_16_first_1.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_1[params][x])
                        a = 0
                        b = max(Role_16_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_1['Atleta'])):
                        if Role_16_first_1['Atleta'][x] == jogadores:
                            a_values = Role_16_first_1.iloc[x].values.tolist()
                        if Role_16_first_1['Atleta'][x] == alvo:
                            b_values = Role_16_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_16_first_2.columns)
                    params = params[4:]

                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_16_first_2[params][x])
                        a = 0
                        b = max(Role_16_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_16_first_2['Atleta'])):
                        if Role_16_first_2['Atleta'][x] == jogadores:
                            a_values = Role_16_first_2.iloc[x].values.tolist()
                        if Role_16_first_2['Atleta'][x] == alvo:
                            b_values = Role_16_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

########################################################################################################################
########################################################################################################################
########################################################################################################################
########################################################################################################################

                if perfil_similar == ("Extremo Organizador"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_17_data = pd.read_csv('17_Role_Extremo_Organizador_Similarity.csv')
                    Role_17_data = Role_17_data.drop(Role_17_data.columns[0:4], axis=1)
                    Role_17_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_17_data.loc[(Role_17_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_17_data

                    # Step 9: Add columns "1", "2", "3" to Role_17_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        ExtremoOrganizador = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        ExtremoOrganizador_columns = ExtremoOrganizador.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(ExtremoOrganizador)

                        # Create a DataFrame with loadings
                        LoadingsExtremoOrganizador = pd.DataFrame(pca.components_.T**2, index=ExtremoOrganizador_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(ExtremoOrganizador, LoadingsExtremoOrganizador['loading factor 1']) + np.matmul(ExtremoOrganizador, LoadingsExtremoOrganizador['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_17_data['Atleta'] == jogador_similar) & (Role_17_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_17_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_17_Mean_Charts = Role_17_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    #Dropping Atleta-alvo
                    Role_17_Mean_Charts = Role_17_Mean_Charts[Role_17_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_17_Mean_Charts = Role_17_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_17_first = Role_17_Mean_Charts.iloc[0:1, :]
                    Role_17_first = pd.concat([Role_17_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_17_first.iat[0, 1]
                    jogadores_clube = Role_17_first.iat[0, 2]
                    jogadores_liga = Role_17_first.iat[0, 3]
                    alvo = Role_17_first.iat[1, 1]
                    alvo_clube = Role_17_first.iat[1, 2]
                    alvo_liga = Role_17_first.iat[1, 3]

                    #Splitting Data
                    Role_17_first_1 = Role_17_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_17_first_2 = Role_17_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_17_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_1[params][x])
                        a = 0
                        b = max(Role_17_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_1['Atleta'])):
                        if Role_17_first_1['Atleta'][x] == jogadores:
                            a_values = Role_17_first_1.iloc[x].values.tolist()
                        if Role_17_first_1['Atleta'][x] == alvo:
                            b_values = Role_17_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_17_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_2[params][x])
                        a = 0
                        b = max(Role_17_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_2['Atleta'])):
                        if Role_17_first_2['Atleta'][x] == jogadores:
                            a_values = Role_17_first_2.iloc[x].values.tolist()
                        if Role_17_first_2['Atleta'][x] == alvo:
                            b_values = Role_17_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_17_first = Role_17_Mean_Charts.iloc[1:2, :]
                    Role_17_first = pd.concat([Role_17_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_17_first.iat[0, 1]
                    jogadores_clube = Role_17_first.iat[0, 2]
                    jogadores_liga = Role_17_first.iat[0, 3]
                    #alvo = Role_17_first.iat[1, 1]
                    #alvo_clube = Role_17_first.iat[1, 2]
                    #alvo_liga = Role_17_first.iat[1, 3]

                    #Splitting Data
                    Role_17_first_1 = Role_17_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_17_first_2 = Role_17_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_17_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_1[params][x])
                        a = 0
                        b = max(Role_17_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_1['Atleta'])):
                        if Role_17_first_1['Atleta'][x] == jogadores:
                            a_values = Role_17_first_1.iloc[x].values.tolist()
                        if Role_17_first_1['Atleta'][x] == alvo:
                            b_values = Role_17_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_17_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_2[params][x])
                        a = 0
                        b = max(Role_17_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_2['Atleta'])):
                        if Role_17_first_2['Atleta'][x] == jogadores:
                            a_values = Role_17_first_2.iloc[x].values.tolist()
                        if Role_17_first_2['Atleta'][x] == alvo:
                            b_values = Role_17_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_17_first = Role_17_Mean_Charts.iloc[2:3, :]
                    Role_17_first = pd.concat([Role_17_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_17_first.iat[0, 1]
                    jogadores_clube = Role_17_first.iat[0, 2]
                    jogadores_liga = Role_17_first.iat[0, 3]
                    #alvo = Role_17_first.iat[1, 1]
                    #alvo_clube = Role_17_first.iat[1, 2]
                    #alvo_liga = Role_17_first.iat[1, 3]

                    #Splitting Data
                    Role_17_first_1 = Role_17_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_17_first_2 = Role_17_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_17_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_1[params][x])
                        a = 0
                        b = max(Role_17_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_1['Atleta'])):
                        if Role_17_first_1['Atleta'][x] == jogadores:
                            a_values = Role_17_first_1.iloc[x].values.tolist()
                        if Role_17_first_1['Atleta'][x] == alvo:
                            b_values = Role_17_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_17_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_2[params][x])
                        a = 0
                        b = max(Role_17_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_2['Atleta'])):
                        if Role_17_first_2['Atleta'][x] == jogadores:
                            a_values = Role_17_first_2.iloc[x].values.tolist()
                        if Role_17_first_2['Atleta'][x] == alvo:
                            b_values = Role_17_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_17_first = Role_17_Mean_Charts.iloc[3:4, :]
                    Role_17_first = pd.concat([Role_17_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_17_first.iat[0, 1]
                    jogadores_clube = Role_17_first.iat[0, 2]
                    jogadores_liga = Role_17_first.iat[0, 3]
                    #alvo = Role_17_first.iat[1, 1]
                    #alvo_clube = Role_17_first.iat[1, 2]
                    #alvo_liga = Role_17_first.iat[1, 3]

                    #Splitting Data
                    Role_17_first_1 = Role_17_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_17_first_2 = Role_17_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_17_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_1[params][x])
                        a = 0
                        b = max(Role_17_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_1['Atleta'])):
                        if Role_17_first_1['Atleta'][x] == jogadores:
                            a_values = Role_17_first_1.iloc[x].values.tolist()
                        if Role_17_first_1['Atleta'][x] == alvo:
                            b_values = Role_17_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_17_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_2[params][x])
                        a = 0
                        b = max(Role_17_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_2['Atleta'])):
                        if Role_17_first_2['Atleta'][x] == jogadores:
                            a_values = Role_17_first_2.iloc[x].values.tolist()
                        if Role_17_first_2['Atleta'][x] == alvo:
                            b_values = Role_17_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_17_first = Role_17_Mean_Charts.iloc[4:5, :]
                    Role_17_first = pd.concat([Role_17_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_17_first.iat[0, 1]
                    jogadores_clube = Role_17_first.iat[0, 2]
                    jogadores_liga = Role_17_first.iat[0, 3]
                    #alvo = Role_17_first.iat[1, 1]
                    #alvo_clube = Role_17_first.iat[1, 2]
                    #alvo_liga = Role_17_first.iat[1, 3]

                    #Splitting Data
                    Role_17_first_1 = Role_17_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_17_first_2 = Role_17_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_17_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_1[params][x])
                        a = 0
                        b = max(Role_17_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_1['Atleta'])):
                        if Role_17_first_1['Atleta'][x] == jogadores:
                            a_values = Role_17_first_1.iloc[x].values.tolist()
                        if Role_17_first_1['Atleta'][x] == alvo:
                            b_values = Role_17_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_17_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_17_first_2[params][x])
                        a = 0
                        b = max(Role_17_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_17_first_2['Atleta'])):
                        if Role_17_first_2['Atleta'][x] == jogadores:
                            a_values = Role_17_first_2.iloc[x].values.tolist()
                        if Role_17_first_2['Atleta'][x] == alvo:
                            b_values = Role_17_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################

                if perfil_similar == ("Extremo Tático"):
                ###############################################################################
                ###########################################################################
                    # EXTREMO TÁTICO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_18_data = pd.read_csv('18_Role_Extremo_Tático_Similarity.csv')
                    Role_18_data = Role_18_data.drop(Role_18_data.columns[0:4], axis=1)
                    Role_18_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_18_data.loc[(Role_18_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_18_data

                    # Step 9: Add columns "1", "2", "3" to Role_18_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]


                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]



                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        ExtremoTático = selected.iloc[:, np.r_[-3:0]]

                        # Defining Columns
                        ExtremoTático_columns = ExtremoTático.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(ExtremoTático)

                        # Create a DataFrame with loadings
                        LoadingsExtremoTático = pd.DataFrame(pca.components_.T**2, index=ExtremoTático_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(ExtremoTático, LoadingsExtremoTático['loading factor 1']) + np.matmul(ExtremoTático, LoadingsExtremoTático['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_18_data['Atleta'] == jogador_similar) & (Role_18_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 24, 29, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_18_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 24, 30:37]]
                    target = target.iloc[:, np.r_[0, 2, 24, 30:37]]
                    # Renomeando Colunas
                    Role_18_Mean_Charts = Role_18_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Passes_Frontais_Percentil':'Passes Frontais',
                                                                              'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                              'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos',
                                                                              'xG_Percentil':'xG', 
                                                                              'xA_Percentil':'xA'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                    'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                    'Passes_Frontais_Percentil':'Passes Frontais',
                                                    'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                    'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos',
                                                    'xG_Percentil':'xG', 
                                                    'xA_Percentil':'xA'})
                    #Dropping Atleta-alvo
                    Role_18_Mean_Charts = Role_18_Mean_Charts[Role_18_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_18_Mean_Charts = Role_18_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_18_first = Role_18_Mean_Charts.iloc[0:1, :]
                    Role_18_first = pd.concat([Role_18_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_18_first.iat[0, 1]
                    jogadores_clube = Role_18_first.iat[0, 2]
                    jogadores_liga = Role_18_first.iat[0, 3]
                    alvo = Role_18_first.iat[1, 1]
                    alvo_clube = Role_18_first.iat[1, 2]
                    alvo_liga = Role_18_first.iat[1, 3]

                    #Splitting Data
                    Role_18_first_1 = Role_18_first.iloc[:, np.r_[0:3, 3:11]]

                    # Preparing Graph 1
                    params = list(Role_18_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_18_first_1[params][x])
                        a = 0
                        b = max(Role_18_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_18_first_1['Atleta'])):
                        if Role_18_first_1['Atleta'][x] == jogadores:
                            a_values = Role_18_first_1.iloc[x].values.tolist()
                        if Role_18_first_1['Atleta'][x] == alvo:
                            b_values = Role_18_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Segundo Gráfico
                    Role_18_first = Role_18_Mean_Charts.iloc[1:2, :]
                    Role_18_first = pd.concat([Role_18_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_18_first.iat[0, 1]
                    jogadores_clube = Role_18_first.iat[0, 2]
                    jogadores_liga = Role_18_first.iat[0, 3]

                    #Splitting Data
                    Role_18_first_1 = Role_18_first.iloc[:, np.r_[0:3, 3:11]]

                    # Preparing Graph 1
                    params = list(Role_18_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_18_first_1[params][x])
                        a = 0
                        b = max(Role_18_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_18_first_1['Atleta'])):
                        if Role_18_first_1['Atleta'][x] == jogadores:
                            a_values = Role_18_first_1.iloc[x].values.tolist()
                        if Role_18_first_1['Atleta'][x] == alvo:
                            b_values = Role_18_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_18_first = Role_18_Mean_Charts.iloc[2:3, :]
                    Role_18_first = pd.concat([Role_18_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_18_first.iat[0, 1]
                    jogadores_clube = Role_18_first.iat[0, 2]
                    jogadores_liga = Role_18_first.iat[0, 3]

                    #Splitting Data
                    Role_18_first_1 = Role_18_first.iloc[:, np.r_[0:3, 3:11]]

                    # Preparing Graph 1
                    params = list(Role_18_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_18_first_1[params][x])
                        a = 0
                        b = max(Role_18_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_18_first_1['Atleta'])):
                        if Role_18_first_1['Atleta'][x] == jogadores:
                            a_values = Role_18_first_1.iloc[x].values.tolist()
                        if Role_18_first_1['Atleta'][x] == alvo:
                            b_values = Role_18_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_18_first = Role_18_Mean_Charts.iloc[3:4, :]
                    Role_18_first = pd.concat([Role_18_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_18_first.iat[0, 1]
                    jogadores_clube = Role_18_first.iat[0, 2]
                    jogadores_liga = Role_18_first.iat[0, 3]

                    #Splitting Data
                    Role_18_first_1 = Role_18_first.iloc[:, np.r_[0:3, 3:11]]

                    # Preparing Graph 1
                    params = list(Role_18_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_18_first_1[params][x])
                        a = 0
                        b = max(Role_18_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_18_first_1['Atleta'])):
                        if Role_18_first_1['Atleta'][x] == jogadores:
                            a_values = Role_18_first_1.iloc[x].values.tolist()
                        if Role_18_first_1['Atleta'][x] == alvo:
                            b_values = Role_18_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_18_first = Role_18_Mean_Charts.iloc[4:5, :]
                    Role_18_first = pd.concat([Role_18_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_18_first.iat[0, 1]
                    jogadores_clube = Role_18_first.iat[0, 2]
                    jogadores_liga = Role_18_first.iat[0, 3]

                    #Splitting Data
                    Role_18_first_1 = Role_18_first.iloc[:, np.r_[0:3, 3:11]]

                    # Preparing Graph 1
                    params = list(Role_18_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_18_first_1[params][x])
                        a = 0
                        b = max(Role_18_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_18_first_1['Atleta'])):
                        if Role_18_first_1['Atleta'][x] == jogadores:
                            a_values = Role_18_first_1.iloc[x].values.tolist()
                        if Role_18_first_1['Atleta'][x] == alvo:
                            b_values = Role_18_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################

                if perfil_similar == ("Extremo Agudo"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_19_data = pd.read_csv('19_Role_Extremo_Agudo_Similarity.csv')
                    Role_19_data = Role_19_data.drop(Role_19_data.columns[0:4], axis=1)
                    Role_19_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_19_data.loc[(Role_19_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_19_data

                    # Step 9: Add columns "1", "2", "3" to Role_19_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        ExtremoAgudo = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        ExtremoAgudo_columns = ExtremoAgudo.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(ExtremoAgudo)

                        # Create a DataFrame with loadings
                        LoadingsExtremoAgudo = pd.DataFrame(pca.components_.T**2, index=ExtremoAgudo_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(ExtremoAgudo, LoadingsExtremoAgudo['loading factor 1']) + np.matmul(ExtremoAgudo, LoadingsExtremoAgudo['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_19_data['Atleta'] == jogador_similar) & (Role_19_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_19_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_19_Mean_Charts = Role_19_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    #Dropping Atleta-alvo
                    Role_19_Mean_Charts = Role_19_Mean_Charts[Role_19_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_19_Mean_Charts = Role_19_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_19_first = Role_19_Mean_Charts.iloc[0:1, :]
                    Role_19_first = pd.concat([Role_19_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_19_first.iat[0, 1]
                    jogadores_clube = Role_19_first.iat[0, 2]
                    jogadores_liga = Role_19_first.iat[0, 3]
                    alvo = Role_19_first.iat[1, 1]
                    alvo_clube = Role_19_first.iat[1, 2]
                    alvo_liga = Role_19_first.iat[1, 3]

                    #Splitting Data
                    Role_19_first_1 = Role_19_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_19_first_2 = Role_19_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_19_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_1[params][x])
                        a = 0
                        b = max(Role_19_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_1['Atleta'])):
                        if Role_19_first_1['Atleta'][x] == jogadores:
                            a_values = Role_19_first_1.iloc[x].values.tolist()
                        if Role_19_first_1['Atleta'][x] == alvo:
                            b_values = Role_19_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_19_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_2[params][x])
                        a = 0
                        b = max(Role_19_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_2['Atleta'])):
                        if Role_19_first_2['Atleta'][x] == jogadores:
                            a_values = Role_19_first_2.iloc[x].values.tolist()
                        if Role_19_first_2['Atleta'][x] == alvo:
                            b_values = Role_19_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_19_first = Role_19_Mean_Charts.iloc[1:2, :]
                    Role_19_first = pd.concat([Role_19_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_19_first.iat[0, 1]
                    jogadores_clube = Role_19_first.iat[0, 2]
                    jogadores_liga = Role_19_first.iat[0, 3]
                    #alvo = Role_19_first.iat[1, 1]
                    #alvo_clube = Role_19_first.iat[1, 2]
                    #alvo_liga = Role_19_first.iat[1, 3]

                    #Splitting Data
                    Role_19_first_1 = Role_19_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_19_first_2 = Role_19_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_19_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_1[params][x])
                        a = 0
                        b = max(Role_19_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_1['Atleta'])):
                        if Role_19_first_1['Atleta'][x] == jogadores:
                            a_values = Role_19_first_1.iloc[x].values.tolist()
                        if Role_19_first_1['Atleta'][x] == alvo:
                            b_values = Role_19_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_19_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_2[params][x])
                        a = 0
                        b = max(Role_19_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_2['Atleta'])):
                        if Role_19_first_2['Atleta'][x] == jogadores:
                            a_values = Role_19_first_2.iloc[x].values.tolist()
                        if Role_19_first_2['Atleta'][x] == alvo:
                            b_values = Role_19_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_19_first = Role_19_Mean_Charts.iloc[2:3, :]
                    Role_19_first = pd.concat([Role_19_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_19_first.iat[0, 1]
                    jogadores_clube = Role_19_first.iat[0, 2]
                    jogadores_liga = Role_19_first.iat[0, 3]
                    #alvo = Role_19_first.iat[1, 1]
                    #alvo_clube = Role_19_first.iat[1, 2]
                    #alvo_liga = Role_19_first.iat[1, 3]

                    #Splitting Data
                    Role_19_first_1 = Role_19_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_19_first_2 = Role_19_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_19_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_1[params][x])
                        a = 0
                        b = max(Role_19_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_1['Atleta'])):
                        if Role_19_first_1['Atleta'][x] == jogadores:
                            a_values = Role_19_first_1.iloc[x].values.tolist()
                        if Role_19_first_1['Atleta'][x] == alvo:
                            b_values = Role_19_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_19_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_2[params][x])
                        a = 0
                        b = max(Role_19_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_2['Atleta'])):
                        if Role_19_first_2['Atleta'][x] == jogadores:
                            a_values = Role_19_first_2.iloc[x].values.tolist()
                        if Role_19_first_2['Atleta'][x] == alvo:
                            b_values = Role_19_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_19_first = Role_19_Mean_Charts.iloc[3:4, :]
                    Role_19_first = pd.concat([Role_19_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_19_first.iat[0, 1]
                    jogadores_clube = Role_19_first.iat[0, 2]
                    jogadores_liga = Role_19_first.iat[0, 3]
                    #alvo = Role_19_first.iat[1, 1]
                    #alvo_clube = Role_19_first.iat[1, 2]
                    #alvo_liga = Role_19_first.iat[1, 3]

                    #Splitting Data
                    Role_19_first_1 = Role_19_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_19_first_2 = Role_19_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_19_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_1[params][x])
                        a = 0
                        b = max(Role_19_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_1['Atleta'])):
                        if Role_19_first_1['Atleta'][x] == jogadores:
                            a_values = Role_19_first_1.iloc[x].values.tolist()
                        if Role_19_first_1['Atleta'][x] == alvo:
                            b_values = Role_19_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_19_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_2[params][x])
                        a = 0
                        b = max(Role_19_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_2['Atleta'])):
                        if Role_19_first_2['Atleta'][x] == jogadores:
                            a_values = Role_19_first_2.iloc[x].values.tolist()
                        if Role_19_first_2['Atleta'][x] == alvo:
                            b_values = Role_19_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_19_first = Role_19_Mean_Charts.iloc[4:5, :]
                    Role_19_first = pd.concat([Role_19_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_19_first.iat[0, 1]
                    jogadores_clube = Role_19_first.iat[0, 2]
                    jogadores_liga = Role_19_first.iat[0, 3]
                    #alvo = Role_19_first.iat[1, 1]
                    #alvo_clube = Role_19_first.iat[1, 2]
                    #alvo_liga = Role_19_first.iat[1, 3]

                    #Splitting Data
                    Role_19_first_1 = Role_19_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_19_first_2 = Role_19_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_19_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_1[params][x])
                        a = 0
                        b = max(Role_19_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_1['Atleta'])):
                        if Role_19_first_1['Atleta'][x] == jogadores:
                            a_values = Role_19_first_1.iloc[x].values.tolist()
                        if Role_19_first_1['Atleta'][x] == alvo:
                            b_values = Role_19_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_19_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_19_first_2[params][x])
                        a = 0
                        b = max(Role_19_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_19_first_2['Atleta'])):
                        if Role_19_first_2['Atleta'][x] == jogadores:
                            a_values = Role_19_first_2.iloc[x].values.tolist()
                        if Role_19_first_2['Atleta'][x] == alvo:
                            b_values = Role_19_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                if perfil_similar == ("Atacante Referência"):
                ###############################################################################
                ###########################################################################
                    # ATACANTE REFERÊNCIA
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_20_data = pd.read_csv('20_Role_Atacante_Referência_Similarity.csv')
                    Role_20_data = Role_20_data.drop(Role_20_data.columns[0:4], axis=1)
                    Role_20_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_20_data.loc[(Role_20_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_20_data

                    # Step 9: Add columns "1", "2", "3" to Role_20_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        AtacanteReferência = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        AtacanteReferência_columns = AtacanteReferência.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(AtacanteReferência)

                        # Create a DataFrame with loadings
                        LoadingsAtacanteReferência = pd.DataFrame(pca.components_.T**2, index=AtacanteReferência_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(AtacanteReferência, LoadingsAtacanteReferência['loading factor 1']) + np.matmul(AtacanteReferência, LoadingsAtacanteReferência['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_20_data['Atleta'] == jogador_similar) & (Role_20_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 27, 32, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_20_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 27, 33:43]]
                    target = target.iloc[:, np.r_[0, 2, 27, 33:43]]
                    # Renomeando Colunas
                    Role_20_Mean_Charts = Role_20_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    #Dropping Atleta-alvo
                    Role_20_Mean_Charts = Role_20_Mean_Charts[Role_20_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_20_Mean_Charts = Role_20_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_20_first = Role_20_Mean_Charts.iloc[0:1, :]
                    Role_20_first = pd.concat([Role_20_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_20_first.iat[0, 1]
                    jogadores_clube = Role_20_first.iat[0, 2]
                    jogadores_liga = Role_20_first.iat[0, 3]
                    alvo = Role_20_first.iat[1, 1]
                    alvo_clube = Role_20_first.iat[1, 2]
                    alvo_liga = Role_20_first.iat[1, 3]

                    #Splitting Data
                    Role_20_first_1 = Role_20_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_20_first_2 = Role_20_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_20_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_1[params][x])
                        a = 0
                        b = max(Role_20_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_1['Atleta'])):
                        if Role_20_first_1['Atleta'][x] == jogadores:
                            a_values = Role_20_first_1.iloc[x].values.tolist()
                        if Role_20_first_1['Atleta'][x] == alvo:
                            b_values = Role_20_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_20_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_2[params][x])
                        a = 0
                        b = max(Role_20_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_2['Atleta'])):
                        if Role_20_first_2['Atleta'][x] == jogadores:
                            a_values = Role_20_first_2.iloc[x].values.tolist()
                        if Role_20_first_2['Atleta'][x] == alvo:
                            b_values = Role_20_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_20_first = Role_20_Mean_Charts.iloc[1:2, :]
                    Role_20_first = pd.concat([Role_20_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_20_first.iat[0, 1]
                    jogadores_clube = Role_20_first.iat[0, 2]
                    jogadores_liga = Role_20_first.iat[0, 3]
                    #alvo = Role_20_first.iat[1, 1]
                    #alvo_clube = Role_20_first.iat[1, 2]
                    #alvo_liga = Role_20_first.iat[1, 3]

                    #Splitting Data
                    Role_20_first_1 = Role_20_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_20_first_2 = Role_20_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_20_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_1[params][x])
                        a = 0
                        b = max(Role_20_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_1['Atleta'])):
                        if Role_20_first_1['Atleta'][x] == jogadores:
                            a_values = Role_20_first_1.iloc[x].values.tolist()
                        if Role_20_first_1['Atleta'][x] == alvo:
                            b_values = Role_20_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_20_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_2[params][x])
                        a = 0
                        b = max(Role_20_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_2['Atleta'])):
                        if Role_20_first_2['Atleta'][x] == jogadores:
                            a_values = Role_20_first_2.iloc[x].values.tolist()
                        if Role_20_first_2['Atleta'][x] == alvo:
                            b_values = Role_20_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_20_first = Role_20_Mean_Charts.iloc[2:3, :]
                    Role_20_first = pd.concat([Role_20_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_20_first.iat[0, 1]
                    jogadores_clube = Role_20_first.iat[0, 2]
                    jogadores_liga = Role_20_first.iat[0, 3]
                    #alvo = Role_20_first.iat[1, 1]
                    #alvo_clube = Role_20_first.iat[1, 2]
                    #alvo_liga = Role_20_first.iat[1, 3]

                    #Splitting Data
                    Role_20_first_1 = Role_20_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_20_first_2 = Role_20_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_20_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_1[params][x])
                        a = 0
                        b = max(Role_20_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_1['Atleta'])):
                        if Role_20_first_1['Atleta'][x] == jogadores:
                            a_values = Role_20_first_1.iloc[x].values.tolist()
                        if Role_20_first_1['Atleta'][x] == alvo:
                            b_values = Role_20_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_20_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_2[params][x])
                        a = 0
                        b = max(Role_20_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_2['Atleta'])):
                        if Role_20_first_2['Atleta'][x] == jogadores:
                            a_values = Role_20_first_2.iloc[x].values.tolist()
                        if Role_20_first_2['Atleta'][x] == alvo:
                            b_values = Role_20_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_20_first = Role_20_Mean_Charts.iloc[3:4, :]
                    Role_20_first = pd.concat([Role_20_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_20_first.iat[0, 1]
                    jogadores_clube = Role_20_first.iat[0, 2]
                    jogadores_liga = Role_20_first.iat[0, 3]
                    #alvo = Role_20_first.iat[1, 1]
                    #alvo_clube = Role_20_first.iat[1, 2]
                    #alvo_liga = Role_20_first.iat[1, 3]

                    #Splitting Data
                    Role_20_first_1 = Role_20_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_20_first_2 = Role_20_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_20_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_1[params][x])
                        a = 0
                        b = max(Role_20_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_1['Atleta'])):
                        if Role_20_first_1['Atleta'][x] == jogadores:
                            a_values = Role_20_first_1.iloc[x].values.tolist()
                        if Role_20_first_1['Atleta'][x] == alvo:
                            b_values = Role_20_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_20_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_2[params][x])
                        a = 0
                        b = max(Role_20_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_2['Atleta'])):
                        if Role_20_first_2['Atleta'][x] == jogadores:
                            a_values = Role_20_first_2.iloc[x].values.tolist()
                        if Role_20_first_2['Atleta'][x] == alvo:
                            b_values = Role_20_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_20_first = Role_20_Mean_Charts.iloc[4:5, :]
                    Role_20_first = pd.concat([Role_20_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_20_first.iat[0, 1]
                    jogadores_clube = Role_20_first.iat[0, 2]
                    jogadores_liga = Role_20_first.iat[0, 3]
                    #alvo = Role_20_first.iat[1, 1]
                    #alvo_clube = Role_20_first.iat[1, 2]
                    #alvo_liga = Role_20_first.iat[1, 3]

                    #Splitting Data
                    Role_20_first_1 = Role_20_first.iloc[:, np.r_[0:3, 3:9]]
                    Role_20_first_2 = Role_20_first.iloc[:, np.r_[0:3, 9:14]]

                    # Preparing Graph 1
                    params = list(Role_20_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_1[params][x])
                        a = 0
                        b = max(Role_20_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_1['Atleta'])):
                        if Role_20_first_1['Atleta'][x] == jogadores:
                            a_values = Role_20_first_1.iloc[x].values.tolist()
                        if Role_20_first_1['Atleta'][x] == alvo:
                            b_values = Role_20_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_20_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_20_first_2[params][x])
                        a = 0
                        b = max(Role_20_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_20_first_2['Atleta'])):
                        if Role_20_first_2['Atleta'][x] == jogadores:
                            a_values = Role_20_first_2.iloc[x].values.tolist()
                        if Role_20_first_2['Atleta'][x] == alvo:
                            b_values = Role_20_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                if perfil_similar == ("Atacante Móvel"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_21_data = pd.read_csv('21_Role_Atacante_Móvel_Similarity.csv')
                    Role_21_data = Role_21_data.drop(Role_21_data.columns[0:4], axis=1)
                    Role_21_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_21_data.loc[(Role_21_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_21_data

                    # Step 9: Add columns "1", "2", "3" to Role_21_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        AtacanteMóvel = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        AtacanteMóvel_columns = AtacanteMóvel.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(AtacanteMóvel)

                        # Create a DataFrame with loadings
                        LoadingsAtacanteMóvel = pd.DataFrame(pca.components_.T**2, index=AtacanteMóvel_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(AtacanteMóvel, LoadingsAtacanteMóvel['loading factor 1']) + np.matmul(AtacanteMóvel, LoadingsAtacanteMóvel['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_21_data['Atleta'] == jogador_similar) & (Role_21_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 26, 31, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]
                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_21_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 26, 32:41]]
                    target = target.iloc[:, np.r_[0, 2, 26, 32:41]]
                    # Renomeando Colunas
                    Role_21_Mean_Charts = Role_21_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    #Dropping Atleta-alvo
                    Role_21_Mean_Charts = Role_21_Mean_Charts[Role_21_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_21_Mean_Charts = Role_21_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_21_first = Role_21_Mean_Charts.iloc[0:1, :]
                    Role_21_first = pd.concat([Role_21_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_21_first.iat[0, 1]
                    jogadores_clube = Role_21_first.iat[0, 2]
                    jogadores_liga = Role_21_first.iat[0, 3]
                    alvo = Role_21_first.iat[1, 1]
                    alvo_clube = Role_21_first.iat[1, 2]
                    alvo_liga = Role_21_first.iat[1, 3]

                    #Splitting Data
                    Role_21_first_1 = Role_21_first.iloc[:, np.r_[0:3, 3:13]]
                    #Role_21_first_2 = Role_21_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_21_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_21_first_1[params][x])
                        a = 0
                        b = max(Role_21_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_21_first_1['Atleta'])):
                        if Role_21_first_1['Atleta'][x] == jogadores:
                            a_values = Role_21_first_1.iloc[x].values.tolist()
                        if Role_21_first_1['Atleta'][x] == alvo:
                            b_values = Role_21_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    #Segundo Gráfico
                    Role_21_first = Role_21_Mean_Charts.iloc[1:2, :]
                    Role_21_first = pd.concat([Role_21_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_21_first.iat[0, 1]
                    jogadores_clube = Role_21_first.iat[0, 2]
                    jogadores_liga = Role_21_first.iat[0, 3]
                    #alvo = Role_21_first.iat[1, 1]
                    #alvo_clube = Role_21_first.iat[1, 2]
                    #alvo_liga = Role_21_first.iat[1, 3]

                    #Splitting Data
                    Role_21_first_1 = Role_21_first.iloc[:, np.r_[0:3, 3:13]]
                    #Role_21_first_2 = Role_21_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_21_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_21_first_1[params][x])
                        a = 0
                        b = max(Role_21_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_21_first_1['Atleta'])):
                        if Role_21_first_1['Atleta'][x] == jogadores:
                            a_values = Role_21_first_1.iloc[x].values.tolist()
                        if Role_21_first_1['Atleta'][x] == alvo:
                            b_values = Role_21_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_21_first = Role_21_Mean_Charts.iloc[2:3, :]
                    Role_21_first = pd.concat([Role_21_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_21_first.iat[0, 1]
                    jogadores_clube = Role_21_first.iat[0, 2]
                    jogadores_liga = Role_21_first.iat[0, 3]
                    #alvo = Role_21_first.iat[1, 1]
                    #alvo_clube = Role_21_first.iat[1, 2]
                    #alvo_liga = Role_21_first.iat[1, 3]

                    #Splitting Data
                    Role_21_first_1 = Role_21_first.iloc[:, np.r_[0:3, 3:13]]
                    #Role_21_first_2 = Role_21_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_21_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_21_first_1[params][x])
                        a = 0
                        b = max(Role_21_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_21_first_1['Atleta'])):
                        if Role_21_first_1['Atleta'][x] == jogadores:
                            a_values = Role_21_first_1.iloc[x].values.tolist()
                        if Role_21_first_1['Atleta'][x] == alvo:
                            b_values = Role_21_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_21_first = Role_21_Mean_Charts.iloc[3:4, :]
                    Role_21_first = pd.concat([Role_21_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_21_first.iat[0, 1]
                    jogadores_clube = Role_21_first.iat[0, 2]
                    jogadores_liga = Role_21_first.iat[0, 3]
                    #alvo = Role_21_first.iat[1, 1]
                    #alvo_clube = Role_21_first.iat[1, 2]
                    #alvo_liga = Role_21_first.iat[1, 3]

                    #Splitting Data
                    Role_21_first_1 = Role_21_first.iloc[:, np.r_[0:3, 3:13]]
                    #Role_21_first_2 = Role_21_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_21_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_21_first_1[params][x])
                        a = 0
                        b = max(Role_21_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_21_first_1['Atleta'])):
                        if Role_21_first_1['Atleta'][x] == jogadores:
                            a_values = Role_21_first_1.iloc[x].values.tolist()
                        if Role_21_first_1['Atleta'][x] == alvo:
                            b_values = Role_21_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_21_first = Role_21_Mean_Charts.iloc[4:5, :]
                    Role_21_first = pd.concat([Role_21_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_21_first.iat[0, 1]
                    jogadores_clube = Role_21_first.iat[0, 2]
                    jogadores_liga = Role_21_first.iat[0, 3]
                    #alvo = Role_21_first.iat[1, 1]
                    #alvo_clube = Role_21_first.iat[1, 2]
                    #alvo_liga = Role_21_first.iat[1, 3]

                    #Splitting Data
                    Role_21_first_1 = Role_21_first.iloc[:, np.r_[0:3, 3:13]]
                    #Role_21_first_2 = Role_21_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_21_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_21_first_1[params][x])
                        a = 0
                        b = max(Role_21_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_21_first_1['Atleta'])):
                        if Role_21_first_1['Atleta'][x] == jogadores:
                            a_values = Role_21_first_1.iloc[x].values.tolist()
                        if Role_21_first_1['Atleta'][x] == alvo:
                            b_values = Role_21_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                if perfil_similar == ("Segundo Atacante"):
                ###############################################################################
                ###########################################################################
                    # PRIMEIRO VOLANTE EQUILIBRADO
                    # Texto de Abertura>
                    markdown_amount_1 = f"<div style='text-align:center; font-size:{fontsize}px'>{jogador_similar:}</div>"
                    st.markdown("<h4 style='text-align: center;'>Jogador Selecionado</b></h4>", unsafe_allow_html=True)
                    st.markdown(markdown_amount_1, unsafe_allow_html=True)
                    st.markdown("---")

                    #Carregando arquivo de dados
                    Role_22_data = pd.read_csv('22_Role_Segundo_Atacante_Similarity.csv')
                    Role_22_data = Role_22_data.drop(Role_22_data.columns[0:4], axis=1)
                    Role_22_data.reset_index(drop=True, inplace=True)

                    # Step : Defina o atleta-alvo
                    #base_bruta_similaridade = pd.read_csv("base_bruta_similaridade.csv")
                    target = Role_22_data.loc[(Role_22_data['Atleta'] == jogador_similar)]

                    #Step : Definindo "ID-alvo"
                    given_ID = target.iat[0, -1]
                    
                    selected = Role_22_data

                    # Step 9: Add columns "1", "2", "3" to Role_22_data

                    selected['1'] = given_ID[0]
                    selected['2'] = given_ID[1]
                    selected['3'] = given_ID[2]
                    selected['4'] = given_ID[3]

                    # Assigning correct columns to 1, 2, 3

                    if given_ID[0] == "A":
                        selected['1'] = selected["A1"]
                    elif given_ID[0] == "B":
                        selected['1'] = selected["B1"]
                    elif given_ID[0] == "C":
                        selected['1'] = selected["C1"]
                    elif given_ID[0] == "D":
                        selected['1'] = selected["D1"]
                    elif given_ID[0] == "E":
                        selected['1'] = selected["E1"]
                    elif given_ID[0] == "F":
                        selected['1'] = selected["F1"]
                    elif given_ID[0] == "G":
                        selected['1'] = selected["G1"]
                    elif given_ID[0] == "H":
                        selected['1'] = selected["H1"]
                    elif given_ID[0] == "I":
                        selected['1'] = selected["I1"]
                    elif given_ID[0] == "J":
                        selected['1'] = selected["J1"]
                    elif given_ID[0] == "K":
                        selected['1'] = selected["K1"]
                    elif given_ID[0] == "L":
                        selected['1'] = selected["L1"]
                    elif given_ID[0] == "M":
                        selected['1'] = selected["M1"]


                    if given_ID[1] == "A":
                        selected['2'] = selected["A1"]
                    elif given_ID[1] == "B":
                        selected['2'] = selected["B1"]
                    elif given_ID[1] == "C":
                        selected['2'] = selected["C1"]
                    elif given_ID[1] == "D":
                        selected['2'] = selected["D1"]
                    elif given_ID[1] == "E":
                        selected['2'] = selected["E1"]
                    elif given_ID[1] == "F":
                        selected['2'] = selected["F1"]
                    elif given_ID[1] == "G":
                        selected['2'] = selected["G1"]
                    elif given_ID[1] == "H":
                        selected['2'] = selected["H1"]
                    elif given_ID[1] == "I":
                        selected['2'] = selected["I1"]
                    elif given_ID[1] == "J":
                        selected['2'] = selected["J1"]
                    elif given_ID[1] == "K":
                        selected['2'] = selected["K1"]
                    elif given_ID[1] == "L":
                        selected['2'] = selected["L1"]
                    elif given_ID[1] == "M":
                        selected['2'] = selected["M1"]
                    
                    
                    if given_ID[2] == "A":
                        selected['3'] = selected["A1"]
                    elif given_ID[2] == "B":
                        selected['3'] = selected["B1"]
                    elif given_ID[2] == "C":
                        selected['3'] = selected["C1"]
                    elif given_ID[2] == "D":
                        selected['3'] = selected["D1"]
                    elif given_ID[2] == "E":
                        selected['3'] = selected["E1"]
                    elif given_ID[2] == "F":
                        selected['3'] = selected["F1"]
                    elif given_ID[2] == "G":
                        selected['3'] = selected["G1"]
                    elif given_ID[2] == "H":
                        selected['3'] = selected["H1"]
                    elif given_ID[2] == "I":
                        selected['3'] = selected["I1"]
                    elif given_ID[2] == "J":
                        selected['3'] = selected["J1"]
                    elif given_ID[2] == "K":
                        selected['3'] = selected["K1"]
                    elif given_ID[2] == "L":
                        selected['3'] = selected["L1"]
                    elif given_ID[2] == "M":
                        selected['3'] = selected["M1"]

                    if given_ID[3] == "A":
                        selected['4'] = selected["A1"]
                    elif given_ID[3] == "B":
                        selected['4'] = selected["B1"]
                    elif given_ID[3] == "C":
                        selected['4'] = selected["C1"]
                    elif given_ID[3] == "D":
                        selected['4'] = selected["D1"]
                    elif given_ID[3] == "E":
                        selected['4'] = selected["E1"]
                    elif given_ID[3] == "F":
                        selected['4'] = selected["F1"]
                    elif given_ID[3] == "G":
                        selected['4'] = selected["G1"]
                    elif given_ID[3] == "H":
                        selected['4'] = selected["H1"]
                    elif given_ID[3] == "I":
                        selected['4'] = selected["I1"]
                    elif given_ID[3] == "J":
                        selected['4'] = selected["J1"]
                    elif given_ID[3] == "K":
                        selected['4'] = selected["K1"]
                    elif given_ID[3] == "L":
                        selected['4'] = selected["L1"]
                    elif given_ID[3] == "M":
                        selected['4'] = selected["M1"]

                    # Applying PCA for Scaled Selected Columns

                    leagues = ["ARG1", "AUT", "BEL1", "BRA1", "BRA2", "BUL", "CHN", 
                            "COL", "DEN", "ENG1", "ENG2", "FRA1", "FRA2", "GER1", 
                            "GER2", "GRE", "HOL", "ITA1", "ITA2", "JAP", "MEX", "PAR", 
                            "POR1", "QAT", "RUS", "SAUD", "SCT", "SER", "SPA1", 
                            "SPA2", "SWZ", "TUR", "UAE", "UKR", "URU", "USA"]

                    # Iterate over each league
                    for league in leagues:

                        # Extract columns 46 through 50
                        SegundoAtacante = selected.iloc[:, np.r_[-4:0]]

                        # Defining Columns
                        SegundoAtacante_columns = SegundoAtacante.columns

                        # Applying PCA
                        pca = PCA(n_components=2)
                        principalComponents = pca.fit_transform(SegundoAtacante)

                        # Create a DataFrame with loadings
                        LoadingsSegundoAtacante = pd.DataFrame(pca.components_.T**2, index=SegundoAtacante_columns, columns=['loading factor 1', 'loading factor 2'])

                        # Multiplying Matrices to obtain Pre_Variables
                        Similarity = pd.DataFrame(np.matmul(SegundoAtacante, LoadingsSegundoAtacante['loading factor 1']) + np.matmul(SegundoAtacante, LoadingsSegundoAtacante['loading factor 2']),
                                                columns=["Similarity"])

                    # Rebuilding Full Training Set
                    selected = selected.join(Similarity)

                    ##############################################################
                    ##############################################################

                    # Lista de Similares
                    # Initialize an empty list to store DataFrames
                    target = selected.loc[(Role_22_data['Atleta'] == jogador_similar) & (Role_22_data['Liga'] == liga_similar)]
                    target_similarity = target.iat[0, -1]

                    selected["Índice de Similaridade"] = (selected['Similarity']/target_similarity)*100
                    selected["Índice de Similaridade"] = round(selected["Índice de Similaridade"], 2)

                    target = selected.loc[(selected['Atleta'] == jogador_similar) & (selected['Liga'] == liga_similar)]
                    selected['Dif_Similarity'] = abs(selected["Índice de Similaridade"] - 100)

                    selected = selected.sort_values(by='Dif_Similarity')

                    lista_similares = selected.iloc[1:31, np.r_[0, 2, 30, 35, -2:0]]
                    lista_similares = lista_similares.sort_values(by='Rating', ascending=False)
                    lista_similares = lista_similares.rename(columns={'Equipe_Janela_Análise':'Equipe', 'Dif_Similarity':'Diferença de Similaridade'})

                    # Lista de Jogadores Similares Ordenados segundo o Rating
                    st.markdown("<h4 style='text-align: center;'>30 Jogadores + Similares</b></h4>", unsafe_allow_html=True)
                    #st.dataframe(lista_similares, use_container_width=True, hide_index=True)
                    st.markdown("---")

                    # Styling DataFrame using Pandas
                    def style_table(df):
                        df = df.reset_index(drop=True)
                        # Ensure 'Rating' is rounded and formatted to 3 decimal places during styling
                        formatter = {"Rating": "{:.3f}", "Índice de Similaridade": "{:.2f}", "Diferença de Similaridade": "{:.2f}"}  # Format the 'Rating' column to 3 decimal places
                        return df.style.format(formatter).set_table_styles(
                            [{
                                'selector': 'thead th',
                                'props': [('font-weight', 'bold'),
                                        ('border-style', 'solid'),
                                        ('border-width', '0px 0px 2px 0px'),
                                        ('border-color', 'black')]
                            }, {
                                'selector': 'thead th:not(:first-child)',
                                'props': [('text-align', 'center')]  # Centering all headers except the first
                            }, {
                                'selector': 'thead th:last-child',
                                'props': [('color', 'black')]  # Make last column header black
                            }, {
                                'selector': 'td',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'center')]
                            }, {
                                'selector': 'th',
                                'props': [('border-style', 'solid'),
                                        ('border-width', '0px 0px 1px 0px'),
                                        ('border-color', 'black'),
                                        ('text-align', 'left')]
                            }]
                        ).set_properties(**{'padding': '2px',
                                            'font-size': '15px'})

                    # Displaying in Streamlit
                    def main():
                        #st.title("Your DataFrame")

                        # Convert the styled DataFrame to HTML without the index and display it
                        styled_html = style_table(lista_similares).to_html(escape=False, index=False, hide_index=True)
                        st.markdown(styled_html, unsafe_allow_html=True)

                    if __name__ == '__main__':
                        main()

                    # Lista de Latinos
                    selected_latam = selected.iloc[1:31, :]
                    selected_latam = selected_latam[(selected_latam["Nacionalidade"] == "Argentina")|(selected_latam["Nacionalidade"] == "Brazil")
                                        |(selected_latam["Nacionalidade"] == "Bolivia")|(selected_latam["Nacionalidade"] == "Chile")
                                        |(selected_latam["Nacionalidade"] == "Colombia")|(selected_latam["Nacionalidade"] == "Costa Rica")
                                        |(selected_latam["Nacionalidade"] == "Ecuador")|(selected_latam["Nacionalidade"] == "Mexico")
                                        |(selected_latam["Nacionalidade"] == "Panama")|(selected_latam["Nacionalidade"] == "Paraguay")
                                        |(selected_latam["Nacionalidade"] == "Peru")|(selected_latam["Nacionalidade"] == "Uruguay")
                                        |(selected_latam["Nacionalidade"] == "Venezuela")]
                    lista_similares_latam = selected_latam.iloc[0:30, :]

                    lista_similares_latam = lista_similares_latam.sort_values(by="Rating", ascending = False)

                    #Texto para os Gráficos
                    st.markdown("<h4 style='text-align: center;'><br>5 Jogadores Latinos Similares Melhor Ranquedos</b></h4>", unsafe_allow_html=True)
                    st.markdown("---")    


                    # Gerar Gráficos com os 5 melhores
                    # Arquivo para o Gráfico
                    Role_22_Mean_Charts = lista_similares_latam.iloc[:, np.r_[0, 2, 30, 36:49]]
                    target = target.iloc[:, np.r_[0, 2, 30, 36:49]]
                    # Renomeando Colunas
                    Role_22_Mean_Charts = Role_22_Mean_Charts.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    
                    target = target.rename(columns={'Ações_Defensivas_BemSucedidas_Percentil':'Ações Defensivas BemSucedidas', 
                                                                              'Duelos_Defensivos_Ganhos_Percentil':'Duelos Defensivos Ganhos', 
                                                                              'Duelos_Aéreos_Ganhos_Percentil':'Duelos Aéreos Ganhos',
                                                                                'Finalizações_Bloqueadas_Percentil':'Finalizações Bloqueadas', 
                                                                                'Interceptações_Ajustadas_a_Posse_Percentil':'Interceptações Ajustadas a Posse', 
                                                                                'Passes_Longos_Certos_Percentil':'Passes Longos Certos', 
                                                                                'Passes_Frontais_Certos_Percentil':'Passes Frontais Certos', 
                                                                                'Passes_Progressivos_Certos_Percentil':'Passes Progressivos Certos', 
                                                                                'Passes_Laterais_Certos_Percentil':'Passes Laterais Certos', 
                                                                                'Duelos_Ofensivos_Ganhos_Percentil':'Duelos Ofensivos Ganhos', 
                                                                                'Dribles_BemSucedidos_Percentil':'Dribles BemSucedidos', 
                                                                                'Corridas_Progressivas_Percentil':'Corridas Progressivas', 
                                                                                'Passes_TerçoFinal_Certos_Percentil':'Passes TerçoFinal Certos'})
                    #Dropping Atleta-alvo
                    Role_22_Mean_Charts = Role_22_Mean_Charts[Role_22_Mean_Charts['Atleta'] != jogador_similar] 
                    #Extraindo 5 melhores
                    Role_22_Mean_Charts = Role_22_Mean_Charts.iloc[0:5, :]


                    #Primeiro Gráfico
                    Role_22_first = Role_22_Mean_Charts.iloc[0:1, :]
                    Role_22_first = pd.concat([Role_22_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_22_first.iat[0, 1]
                    jogadores_clube = Role_22_first.iat[0, 2]
                    jogadores_liga = Role_22_first.iat[0, 3]
                    alvo = Role_22_first.iat[1, 1]
                    alvo_clube = Role_22_first.iat[1, 2]
                    alvo_liga = Role_22_first.iat[1, 3]

                    #Splitting Data
                    Role_22_first_1 = Role_22_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_22_first_2 = Role_22_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_22_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_1[params][x])
                        a = 0
                        b = max(Role_22_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_1['Atleta'])):
                        if Role_22_first_1['Atleta'][x] == jogadores:
                            a_values = Role_22_first_1.iloc[x].values.tolist()
                        if Role_22_first_1['Atleta'][x] == alvo:
                            b_values = Role_22_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_22_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_2[params][x])
                        a = 0
                        b = max(Role_22_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_2['Atleta'])):
                        if Role_22_first_2['Atleta'][x] == jogadores:
                            a_values = Role_22_first_2.iloc[x].values.tolist()
                        if Role_22_first_2['Atleta'][x] == alvo:
                            b_values = Role_22_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################

                    #Segundo Gráfico
                    Role_22_first = Role_22_Mean_Charts.iloc[1:2, :]
                    Role_22_first = pd.concat([Role_22_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_22_first.iat[0, 1]
                    jogadores_clube = Role_22_first.iat[0, 2]
                    jogadores_liga = Role_22_first.iat[0, 3]
                    #alvo = Role_22_first.iat[1, 1]
                    #alvo_clube = Role_22_first.iat[1, 2]
                    #alvo_liga = Role_22_first.iat[1, 3]

                    #Splitting Data
                    Role_22_first_1 = Role_22_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_22_first_2 = Role_22_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_22_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_1[params][x])
                        a = 0
                        b = max(Role_22_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_1['Atleta'])):
                        if Role_22_first_1['Atleta'][x] == jogadores:
                            a_values = Role_22_first_1.iloc[x].values.tolist()
                        if Role_22_first_1['Atleta'][x] == alvo:
                            b_values = Role_22_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_22_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_2[params][x])
                        a = 0
                        b = max(Role_22_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_2['Atleta'])):
                        if Role_22_first_2['Atleta'][x] == jogadores:
                            a_values = Role_22_first_2.iloc[x].values.tolist()
                        if Role_22_first_2['Atleta'][x] == alvo:
                            b_values = Role_22_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Terceiro Gráfico
                    Role_22_first = Role_22_Mean_Charts.iloc[2:3, :]
                    Role_22_first = pd.concat([Role_22_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_22_first.iat[0, 1]
                    jogadores_clube = Role_22_first.iat[0, 2]
                    jogadores_liga = Role_22_first.iat[0, 3]
                    #alvo = Role_22_first.iat[1, 1]
                    #alvo_clube = Role_22_first.iat[1, 2]
                    #alvo_liga = Role_22_first.iat[1, 3]

                    #Splitting Data
                    Role_22_first_1 = Role_22_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_22_first_2 = Role_22_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_22_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_1[params][x])
                        a = 0
                        b = max(Role_22_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_1['Atleta'])):
                        if Role_22_first_1['Atleta'][x] == jogadores:
                            a_values = Role_22_first_1.iloc[x].values.tolist()
                        if Role_22_first_1['Atleta'][x] == alvo:
                            b_values = Role_22_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_22_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_2[params][x])
                        a = 0
                        b = max(Role_22_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_2['Atleta'])):
                        if Role_22_first_2['Atleta'][x] == jogadores:
                            a_values = Role_22_first_2.iloc[x].values.tolist()
                        if Role_22_first_2['Atleta'][x] == alvo:
                            b_values = Role_22_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quarto Gráfico
                    Role_22_first = Role_22_Mean_Charts.iloc[3:4, :]
                    Role_22_first = pd.concat([Role_22_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_22_first.iat[0, 1]
                    jogadores_clube = Role_22_first.iat[0, 2]
                    jogadores_liga = Role_22_first.iat[0, 3]
                    #alvo = Role_22_first.iat[1, 1]
                    #alvo_clube = Role_22_first.iat[1, 2]
                    #alvo_liga = Role_22_first.iat[1, 3]

                    #Splitting Data
                    Role_22_first_1 = Role_22_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_22_first_2 = Role_22_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_22_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_1[params][x])
                        a = 0
                        b = max(Role_22_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_1['Atleta'])):
                        if Role_22_first_1['Atleta'][x] == jogadores:
                            a_values = Role_22_first_1.iloc[x].values.tolist()
                        if Role_22_first_1['Atleta'][x] == alvo:
                            b_values = Role_22_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_22_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_2[params][x])
                        a = 0
                        b = max(Role_22_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_2['Atleta'])):
                        if Role_22_first_2['Atleta'][x] == jogadores:
                            a_values = Role_22_first_2.iloc[x].values.tolist()
                        if Role_22_first_2['Atleta'][x] == alvo:
                            b_values = Role_22_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ##########################################################################################
                    ############################################################################

                    #Quinto Gráfico
                    Role_22_first = Role_22_Mean_Charts.iloc[4:5, :]
                    Role_22_first = pd.concat([Role_22_first, target]).reset_index()

                    # Definindo atletas para comparar
                    jogadores = Role_22_first.iat[0, 1]
                    jogadores_clube = Role_22_first.iat[0, 2]
                    jogadores_liga = Role_22_first.iat[0, 3]
                    #alvo = Role_22_first.iat[1, 1]
                    #alvo_clube = Role_22_first.iat[1, 2]
                    #alvo_liga = Role_22_first.iat[1, 3]

                    #Splitting Data
                    Role_22_first_1 = Role_22_first.iloc[:, np.r_[0:3, 3:11]]
                    Role_22_first_2 = Role_22_first.iloc[:, np.r_[0:3, 11:17]]

                    # Preparing Graph 1
                    params = list(Role_22_first_1.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_1[params][x])
                        a = 0
                        b = max(Role_22_first_1[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_1['Atleta'])):
                        if Role_22_first_1['Atleta'][x] == jogadores:
                            a_values = Role_22_first_1.iloc[x].values.tolist()
                        if Role_22_first_1['Atleta'][x] == alvo:
                            b_values = Role_22_first_1.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)

                    ############################################################################
                    # Preparing Graph 2
                    params = list(Role_22_first_2.columns)
                    params = params[4:]
                    
                    #Preparing Data
                    ranges = []
                    a_values = []
                    b_values = []

                    for x in params:
                        a = min(Role_22_first_2[params][x])
                        a = 0
                        b = max(Role_22_first_2[params][x])
                        b = 100
                        ranges.append((a, b))

                    for x in range(len(Role_22_first_2['Atleta'])):
                        if Role_22_first_2['Atleta'][x] == jogadores:
                            a_values = Role_22_first_2.iloc[x].values.tolist()
                        if Role_22_first_2['Atleta'][x] == alvo:
                            b_values = Role_22_first_2.iloc[x].values.tolist()
                            
                    a_values = a_values[4:]
                    b_values = b_values[4:]

                    values = [a_values, b_values]

                    #Plotting Data
                    title = dict(
                        title_name = jogadores,
                        title_color = '#B6282F',
                        subtitle_name = jogadores_clube + "/" + jogadores_liga,
                        subtitle_color = '#B6282F',
                        title_name_2 = alvo,
                        title_color_2 = '#344D94',
                        subtitle_name_2 = alvo_clube + "/" + alvo_liga,
                        subtitle_color_2 = '#344D94',
                        title_fontsize = 18,
                    ) 

                    endnote = 'Viz by@JAmerico1898\ Data from Wyscout\nAll data in League percentiles'

                    radar=Radar(fontfamily='Cursive', range_fontsize=8)
                    fig,ax = radar.plot_radar(ranges=ranges,params=params,values=values,radar_color=['#B6282F', '#344D94'], dpi=600, alphas=[.8,.6], title=title, endnote=endnote, compare=True)
                    st.pyplot(fig)
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################
                    #####################################################################################################################

if st.session_state.selected_option == "Compare Jogadores":

    #CABEÇALHO DO FORM
    st.markdown("<h2 style='text-align: center;'>Compare Jogadores</h2>", unsafe_allow_html=True)
    st.markdown("---")
    
    jogadores_comp = df_comp["Atleta"].astype(str).str.strip().drop_duplicates().sort_values()

    jogador_1 = st.selectbox("Escolha o primeiro Jogador. A grafia deve ser exata!", options=jogadores_comp, index=None, key=1000, placeholder="Escolha o primeiro Jogador!")

    if jogador_1:
        #Determinar Temporada
        df20 = df_comp.loc[(df_comp['Atleta']==jogador_1)]
        temporadas = df20['Versão_Temporada'].unique()
        temporada_1 = st.selectbox("Escolha a Temporada", options=temporadas, key=1002)
        if temporada_1:
            #Determinar a Liga
            dfa = df20.loc[(df20['Versão_Temporada']==temporada_1)]
            ligas = dfa['Liga'].unique()
            liga_1 = st.selectbox("Escolha a Liga", options=ligas, key=1004)
            if liga_1:
                #Determinar a equipe
                dfj = dfa.loc[(dfa['Versão_Temporada']==temporada_1)&(dfa['Liga']==liga_1)]
                equipe = dfj['Equipe'].unique()
                equipe_1 = st.selectbox("Escolha a Equipe", options=equipe, key=1008)
                if equipe_1:
                    #Determinar a posição
                    df4 = dfj.loc[(dfj['Versão_Temporada']==temporada_1)&(dfj['Liga']==liga_1)&(dfj['Equipe']==equipe_1)]
                    posição = dfj['Posição'].unique()
                    posição_1 = st.selectbox("Escolha a Posição", options=posição, key=1006)
                    
    st.write("---")
    jogador_2 = st.selectbox("Escolha o segundo Jogador!", options=jogadores_comp, index=None, key=1001, placeholder="Escolha o segundo Jogador!")

    if jogador_2:
        #Determinar Temporada
        df21 = df_comp.loc[(df_comp['Atleta']==jogador_2)]
        temporadas = df21['Versão_Temporada'].unique()
        temporada_2 = st.selectbox("Escolha a Temporada", options=temporadas, key=1003)
        if temporada_2:
            #Determinar a Liga
            dfb = df21.loc[(df21['Versão_Temporada']==temporada_2)]
            ligas = dfb['Liga'].unique()
            liga_2 = st.selectbox("Escolha a Liga", options=ligas, key=1005)
            if liga_2:
                #Determinar a equipe
                dfk = dfb.loc[(dfb['Versão_Temporada']==temporada_2)&(dfb['Liga']==liga_2)]
                equipe = dfk['Equipe'].unique()
                equipe_2 = st.selectbox("Escolha a Equipe", options=equipe, key=1009)
                if equipe_2:
                    #Determinar a posição
                    df5 = dfk.loc[(dfk['Versão_Temporada']==temporada_2)&(dfk['Liga']==liga_2)&(dfk['Equipe']==equipe_2)]
                    posição = dfb['Posição'].unique()
                    posição_2 = st.selectbox("Escolha a Posição", options=posição, key=1007)

        if (posição_1 == posição_2 == ("Goleiro")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Goleiro Clássico</h3>", unsafe_allow_html=True)
            Goleiro_Charts = pd.read_csv('PlayerAnalysis_Role_1.csv')

            Goleiro_Charts_1 = Goleiro_Charts[
            ((Goleiro_Charts['Atleta'] == jogador_1) & (Goleiro_Charts['Equipe'] == equipe_1)
            & (Goleiro_Charts['Liga'] == liga_1) & (Goleiro_Charts['Versão_Temporada'] == temporada_1)) |
            ((Goleiro_Charts['Atleta'] == jogador_2) & (Goleiro_Charts['Equipe'] == equipe_2)
            & (Goleiro_Charts['Liga'] == liga_2) & (Goleiro_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            Goleiro_Charts_1 = Goleiro_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            Goleiro_Charts_1 = Goleiro_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in Goleiro_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics = Goleiro_Charts_1.iloc[:, np.r_[0:2, 48:55]].reset_index(drop=True)
            metrics.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics[(metrics['Atleta'] == jogador_1) & (metrics['Versão_Temporada'] == temporada_1)]
            b_row = metrics[(metrics['Atleta'] == jogador_2) & (metrics['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)

######################################################################################################################################
            # Define column metricas
            metricas = ['Duelos Aéreos Ganhos', 'Defesas',	'Gols Evitados',
                            'Saídas',	'Interceptações',	'xG Evitado',
                            'Finalizações por Gol Sofrido']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('1_Role_Goleiro.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_1.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:25]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.rename(columns={'Interceptações.1':'Interceptações'})
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[9, 48:55]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.rename(columns={'Interceptações.1_Percentil':'Interceptações_Percentil'})
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('1_Role_Goleiro.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_1.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:25]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.rename(columns={'Interceptações.1':'Interceptações'})
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[9, 48:55]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.rename(columns={'Interceptações.1_Percentil':'Interceptações_Percentil'})
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Lateral")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Lateral Equilibrado</h3>", unsafe_allow_html=True)
            Lateral_Charts = pd.read_csv('PlayerAnalysis_Role_5.csv')

            Lateral_Charts_1 = Lateral_Charts[
            ((Lateral_Charts['Atleta'] == jogador_1) & (Lateral_Charts['Equipe'] == equipe_1)
            & (Lateral_Charts['Liga'] == liga_1) & (Lateral_Charts['Versão_Temporada'] == temporada_1)) |
            ((Lateral_Charts['Atleta'] == jogador_2) & (Lateral_Charts['Equipe'] == equipe_2)
            & (Lateral_Charts['Liga'] == liga_2) & (Lateral_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            Lateral_Charts_1 = Lateral_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            Lateral_Charts_1 = Lateral_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in Lateral_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = Lateral_Charts_1.iloc[:, np.r_[0:2, 66:73]].reset_index(drop=True)
            metrics_2 = Lateral_Charts_1.iloc[:, np.r_[0:2, 73:79]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            #Plotting the second graph
            
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_1['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
                        
            
            

######################################################################################################################################
            # Define column metricas
            metricas = ["Ações Defensivas BemSucedidas", "Duelos Defensivos Ganhos", "Duelos Aéreos Ganhos", 
                        "Ações Ofensivas BemSucedidas", "Duelos Ofensivos Ganhos", "Cruzamentos Certos", "Pisadas Área", 
                        "Dribles BemSucedidos", "Corridas Progressivas", "Acelerações", "xA", 
                        "Passes Inteligentes Certos", "Deep Completed Crosses"
                        ]

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('5_Role_Lateral_Equilibrado.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_5.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('5_Role_Lateral_Equilibrado.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_5.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            


######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Zagueiro")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Zagueiro Equilibrado</h3>", unsafe_allow_html=True)
            Zagueiro_Charts = pd.read_csv('PlayerAnalysis_Role_8.csv')

            Zagueiro_Charts_1 = Zagueiro_Charts[
            ((Zagueiro_Charts['Atleta'] == jogador_1) & (Zagueiro_Charts['Equipe'] == equipe_1)
            & (Zagueiro_Charts['Liga'] == liga_1) & (Zagueiro_Charts['Versão_Temporada'] == temporada_1)) |
            ((Zagueiro_Charts['Atleta'] == jogador_2) & (Zagueiro_Charts['Equipe'] == equipe_2)
            & (Zagueiro_Charts['Liga'] == liga_2) & (Zagueiro_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            Zagueiro_Charts_1 = Zagueiro_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            Zagueiro_Charts_1 = Zagueiro_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in Zagueiro_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = Zagueiro_Charts_1.iloc[:, np.r_[0:2, 66:73]].reset_index(drop=True)
            metrics_2 = Zagueiro_Charts_1.iloc[:, np.r_[0:2, 73:79]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            #Plotting the second graph
            
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_1['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
                        
            
            

######################################################################################################################################
            # Define column metricas
            metricas = ["Ações Defensivas BemSucedidas", "Duelos Defensivos Ganhos", "Duelos Aéreos Ganhos", 
                        "Finalizações Bloqueadas", "Interceptações Ajustadas a Posse", "Passes Longos Certos", 
                        "Passes Frontais Certos", "Passes Progressivos Certos", "Passes Laterais Certos", 
                        "Duelos Ofensivos Ganhos", "Dribles BemSucedidos", "Corridas Progressivas", "Passes TerçoFinal Certos"]

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('8_Role_Zagueiro_Equilibrado.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_8.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('8_Role_Zagueiro_Equilibrado.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_8.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Primeiro Volante")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Primeiro Volante Equilibrado</h3>", unsafe_allow_html=True)
            Primeiro_Volante_Charts = pd.read_csv('PlayerAnalysis_Role_11.csv')

            Primeiro_Volante_Charts_1 = Primeiro_Volante_Charts[
            ((Primeiro_Volante_Charts['Atleta'] == jogador_1) & (Primeiro_Volante_Charts['Equipe'] == equipe_1)
            & (Primeiro_Volante_Charts['Liga'] == liga_1) & (Primeiro_Volante_Charts['Versão_Temporada'] == temporada_1)) |
            ((Primeiro_Volante_Charts['Atleta'] == jogador_2) & (Primeiro_Volante_Charts['Equipe'] == equipe_2)
            & (Primeiro_Volante_Charts['Liga'] == liga_2) & (Primeiro_Volante_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            Primeiro_Volante_Charts_1 = Primeiro_Volante_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            Primeiro_Volante_Charts_1 = Primeiro_Volante_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in Primeiro_Volante_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = Primeiro_Volante_Charts_1.iloc[:, np.r_[0:2, 60:66]].reset_index(drop=True)
            metrics_2 = Primeiro_Volante_Charts_1.iloc[:, np.r_[0:2, 66:71]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            #Plotting the second graph
            
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_1['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
                        
            
            

######################################################################################################################################
            # Define column metricas
            metricas = ["Ações Defensivas BemSucedidas", "Duelos Defensivos Ganhos", "Duelos Aéreos Ganhos", 
                        "Passes Longos Certos", "Passes Frontais Certos", "Passes Progressivos Certos", 
                        "Ações Ofensivas BemSucedidas", "Duelos Ofensivos Ganhos", "Dribles BemSucedidos", 
                        "Corridas Progressivas", "Passes TerçoFinal Certos"]

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('11_Role_Volante_Equilibrado.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_11.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:29]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[13, 60:71]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('11_Role_Volante_Equilibrado.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_11.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:29]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[13, 60:71]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Segundo Volante")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Segundo Volante Equilibrado</h3>", unsafe_allow_html=True)
            Primeiro_Volante_Charts = pd.read_csv('PlayerAnalysis_Role_14.csv')

            Primeiro_Volante_Charts_1 = Primeiro_Volante_Charts[
            ((Primeiro_Volante_Charts['Atleta'] == jogador_1) & (Primeiro_Volante_Charts['Equipe'] == equipe_1)
            & (Primeiro_Volante_Charts['Liga'] == liga_1) & (Primeiro_Volante_Charts['Versão_Temporada'] == temporada_1)) |
            ((Primeiro_Volante_Charts['Atleta'] == jogador_2) & (Primeiro_Volante_Charts['Equipe'] == equipe_2)
            & (Primeiro_Volante_Charts['Liga'] == liga_2) & (Primeiro_Volante_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            Primeiro_Volante_Charts_1 = Primeiro_Volante_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            Primeiro_Volante_Charts_1 = Primeiro_Volante_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in Primeiro_Volante_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = Primeiro_Volante_Charts_1.iloc[:, np.r_[0:2, 66:72]].reset_index(drop=True)
            metrics_2 = Primeiro_Volante_Charts_1.iloc[:, np.r_[0:2, 72:79]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            #Plotting the second graph
            
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_1['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
                        
            
            

######################################################################################################################################
            # Define column metricas
            metricas = ['Ações Defensivas BemSucedidas', 'Duelos Defensivos Ganhos', 'Passes Longos Certos', 
                        'Passes Progressivos Certos', 'Pisadas Área', 'Dribles BemSucedidos', 
                        'Corridas Progressivas', 'xG', 'xA', 'Assistência Finalização', 'Passes TerçoFinal Certos', 
                        'Deep Completions', 'Passes ÁreaPênalti Certos']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('14_Role_Segundo_Volante_Equilibrado.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_14.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('14_Role_Segundo_Volante_Equilibrado.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_14.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Meia")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Meia Atacante</h3>", unsafe_allow_html=True)
            Meia_Charts = pd.read_csv('PlayerAnalysis_Role_15.csv')

            Meia_Charts_1 = Meia_Charts[
            ((Meia_Charts['Atleta'] == jogador_1) & (Meia_Charts['Equipe'] == equipe_1)
            & (Meia_Charts['Liga'] == liga_1) & (Meia_Charts['Versão_Temporada'] == temporada_1)) |
            ((Meia_Charts['Atleta'] == jogador_2) & (Meia_Charts['Equipe'] == equipe_2)
            & (Meia_Charts['Liga'] == liga_2) & (Meia_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            Meia_Charts_1 = Meia_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            Meia_Charts_1 = Meia_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in Meia_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = Meia_Charts_1.iloc[:, np.r_[0:2, 57:67]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            

######################################################################################################################################
            # Define column metricas
            metricas = ['Passes Longos Certos', 'Passes Frontais Certos', 'Passes Progressivos Certos', 
                        'Duelos Ofensivos Ganhos', 'Dribles BemSucedidos', 'xA', 'Assistência Finalização', 
                        'Passes TerçoFinal Certos', 'Passes EntreLinhas Certos', 'Passes Chave']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('15_Role_Meia_Organizador.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_15.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:28]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[12, 57:67]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('15_Role_Meia_Organizador.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_15.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:28]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[12, 57:67]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Extremo")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Extremo Organizador</h3>", unsafe_allow_html=True)
            ExtremoOrg_Charts = pd.read_csv('PlayerAnalysis_Role_17.csv')

            ExtremoOrg_Charts_1 = ExtremoOrg_Charts[
            ((ExtremoOrg_Charts['Atleta'] == jogador_1) & (ExtremoOrg_Charts['Equipe'] == equipe_1)
            & (ExtremoOrg_Charts['Liga'] == liga_1) & (ExtremoOrg_Charts['Versão_Temporada'] == temporada_1)) |
            ((ExtremoOrg_Charts['Atleta'] == jogador_2) & (ExtremoOrg_Charts['Equipe'] == equipe_2)
            & (ExtremoOrg_Charts['Liga'] == liga_2) & (ExtremoOrg_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            ExtremoOrg_Charts_1 = ExtremoOrg_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            ExtremoOrg_Charts_1 = ExtremoOrg_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in ExtremoOrg_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = ExtremoOrg_Charts_1.iloc[:, np.r_[0:2, 66:73]].reset_index(drop=True)
            metrics_2 = ExtremoOrg_Charts_1.iloc[:, np.r_[0:2, 73:79]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            # Plot Second Graph
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_2['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)


######################################################################################################################################
            # Define column metricas
            metricas = ['Passes Longos Certos', 'Passes Frontais Certos', 'Passes Progressivos Certos', 
                        'Duelos Ofensivos Ganhos', 'Dribles BemSucedidos', 'xG', 'Finalizações NoAlvo', 
                        'Conversão Gols', 'xA', 'Assistência Finalização', 'Passes Inteligentes Certos', 
                        'Passes EntreLinhas Certos', 'Passes Chave']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('17_Role_Extremo_Organizador.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_17.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('17_Role_Extremo_Organizador.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_17.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

##################################################################################################################
##################################################################################################################
##################################################################################################################
##################################################################################################################
        
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Extremo Agudo</h3>", unsafe_allow_html=True)
            ExtremoAgudo_Charts = pd.read_csv('PlayerAnalysis_Role_19.csv')

            ExtremoAgudo_Charts_1 = ExtremoAgudo_Charts[
            ((ExtremoAgudo_Charts['Atleta'] == jogador_1) & (ExtremoAgudo_Charts['Equipe'] == equipe_1)
            & (ExtremoAgudo_Charts['Liga'] == liga_1) & (ExtremoAgudo_Charts['Versão_Temporada'] == temporada_1)) |
            ((ExtremoAgudo_Charts['Atleta'] == jogador_2) & (ExtremoAgudo_Charts['Equipe'] == equipe_2)
            & (ExtremoAgudo_Charts['Liga'] == liga_2) & (ExtremoAgudo_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            ExtremoAgudo_Charts_1 = ExtremoAgudo_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            ExtremoAgudo_Charts_1 = ExtremoAgudo_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in ExtremoAgudo_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = ExtremoAgudo_Charts_1.iloc[:, np.r_[0:2, 66:73]].reset_index(drop=True)
            metrics_2 = ExtremoAgudo_Charts_1.iloc[:, np.r_[0:2, 73:79]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            # Plot Second Graph
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_2['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)


######################################################################################################################################
            # Define column metricas
            metricas = ['Duelos Ofensivos Ganhos', 'Pisadas Área', 'Dribles BemSucedidos', 
                        'Acelerações', 'Passes Longos Recebidos', 'xG', 'Finalizações NoAlvo', 
                        'Conversão Gols', 'xA', 'Assistência Finalização', 'Deep Completions', 
                        'Deep Completed Crosses', 'Passes Chave']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('19_Role_Extremo_Agudo.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_19.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('19_Role_Extremo_Agudo.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_19.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            
        
        


######################################################################################################################################
######################################################################################################################################


        elif (posição_1 == posição_2 == ("Atacante")):
            
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Atacante Referência</h3>", unsafe_allow_html=True)
            AtacanteRef_Charts = pd.read_csv('PlayerAnalysis_Role_20.csv')

            AtacanteRef_Charts_1 = AtacanteRef_Charts[
            ((AtacanteRef_Charts['Atleta'] == jogador_1) & (AtacanteRef_Charts['Equipe'] == equipe_1)
            & (AtacanteRef_Charts['Liga'] == liga_1) & (AtacanteRef_Charts['Versão_Temporada'] == temporada_1)) |
            ((AtacanteRef_Charts['Atleta'] == jogador_2) & (AtacanteRef_Charts['Equipe'] == equipe_2)
            & (AtacanteRef_Charts['Liga'] == liga_2) & (AtacanteRef_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            AtacanteRef_Charts_1 = AtacanteRef_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            AtacanteRef_Charts_1 = AtacanteRef_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in AtacanteRef_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = AtacanteRef_Charts_1.iloc[:, np.r_[0:2, 57:67]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            

######################################################################################################################################
            # Define column metricas
            metricas = ['Duelos Aéreos Ganhos', 'Duelos Ofensivos Ganhos', 'xG', 'Conversão Gols', 
                        'Conversão xG', 'Ameaça Ofensiva', 'xA', 'Deep Completions', 'Passes Chave', 
                        'Passes ÁreaPênalti Certos']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('20_Role_Atacante_Referência.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_20.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:28]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[12, 57:67]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('20_Role_Atacante_Referência.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_20.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:28]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[12, 57:67]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            

##################################################################################################################
##################################################################################################################
##################################################################################################################
##################################################################################################################
        
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Atacante Móvel</h3>", unsafe_allow_html=True)
            AtacanteMovel_Charts = pd.read_csv('PlayerAnalysis_Role_21.csv')

            AtacanteMovel_Charts_1 = AtacanteMovel_Charts[
            ((AtacanteMovel_Charts['Atleta'] == jogador_1) & (AtacanteMovel_Charts['Equipe'] == equipe_1)
            & (AtacanteMovel_Charts['Liga'] == liga_1) & (AtacanteMovel_Charts['Versão_Temporada'] == temporada_1)) |
            ((AtacanteMovel_Charts['Atleta'] == jogador_2) & (AtacanteMovel_Charts['Equipe'] == equipe_2)
            & (AtacanteMovel_Charts['Liga'] == liga_2) & (AtacanteMovel_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            AtacanteMovel_Charts_1 = AtacanteMovel_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            AtacanteMovel_Charts_1 = AtacanteMovel_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in AtacanteMovel_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = AtacanteMovel_Charts_1.iloc[:, np.r_[0:2, 54:63]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            

######################################################################################################################################
            # Define column metricas
            metricas = ['Duelos Ofensivos Ganhos', 'Dribles BemSucedidos', 'Acelerações', 
                        'xG', 'Conversão Gols', 'Conversão xG', 'Ameaça Ofensiva', 'xA', 
                        'Assistência Finalização']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('21_Role_Atacante_Móvel.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_21.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:27]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[11, 54:63]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('21_Role_Atacante_Móvel.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_21.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:27]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[11, 54:63]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            
        
        
##################################################################################################################
##################################################################################################################
##################################################################################################################
##################################################################################################################
        
            #Plotar Primeiro Gráfico - Radar de Percentis do Jogador na liga:
            st.markdown("<h3 style='text-align: center; color: blue; '>Comparação do Desempenho dos Jogadores<br><br>Perfil: Segundo Atacante</h3>", unsafe_allow_html=True)
            SegAtacante_Charts = pd.read_csv('PlayerAnalysis_Role_22.csv')

            SegAtacante_Charts_1 = SegAtacante_Charts[
            ((SegAtacante_Charts['Atleta'] == jogador_1) & (SegAtacante_Charts['Equipe'] == equipe_1)
            & (SegAtacante_Charts['Liga'] == liga_1) & (SegAtacante_Charts['Versão_Temporada'] == temporada_1)) |
            ((SegAtacante_Charts['Atleta'] == jogador_2) & (SegAtacante_Charts['Equipe'] == equipe_2)
            & (SegAtacante_Charts['Liga'] == liga_2) & (SegAtacante_Charts['Versão_Temporada'] == temporada_2))
            ]

            # Reindex to ensure the correct order
            # Criar índice com 'Atleta' e 'Versão_Temporada'
            SegAtacante_Charts_1 = SegAtacante_Charts_1.set_index(['Atleta', 'Versão_Temporada'])
            # Selecionar os dois pares (jogador, temporada)
            SegAtacante_Charts_1 = SegAtacante_Charts_1.loc[
                [(jogador_1, temporada_1), (jogador_2, temporada_2)]
            ].reset_index()

            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in SegAtacante_Charts_1.columns if '_Percentil' in col
            }            
            #Collecting data to plot
            metrics_1 = SegAtacante_Charts_1.iloc[:, np.r_[0:2, 66:73]].reset_index(drop=True)
            metrics_2 = SegAtacante_Charts_1.iloc[:, np.r_[0:2, 73:79]].reset_index(drop=True)
            metrics_1.rename(columns=columns_to_rename, inplace=True)
            metrics_2.rename(columns=columns_to_rename, inplace=True)

            ## parameter names
            params = list(metrics_1.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_1[(metrics_1['Atleta'] == jogador_1) & (metrics_1['Versão_Temporada'] == temporada_1)]
            b_row = metrics_1[(metrics_1['Atleta'] == jogador_2) & (metrics_1['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)
            
            ## Plotar segundo Gráfico
            ## parameter names
            params = list(metrics_2.columns[2:])

            ## range values
            ranges = [(0, 100), (0, 100), (0, 100), (0, 100), (0, 100), (0, 100)]
            a_values = []
            b_values = []

            # Filtrar as linhas correspondentes
            a_row = metrics_2[(metrics_2['Atleta'] == jogador_1) & (metrics_2['Versão_Temporada'] == temporada_1)]
            b_row = metrics_2[(metrics_2['Atleta'] == jogador_2) & (metrics_2['Versão_Temporada'] == temporada_2)]

            # Extrair os valores, ignorando as colunas 'Atleta' e 'Versão_Temporada'
            a_values = a_row.iloc[0, 2:].tolist() if not a_row.empty else None
            b_values = b_row.iloc[0, 2:].tolist() if not b_row.empty else None

            values = [a_values, b_values]

            ## title values
            title = dict(
                title_name=jogador_1,
                title_color = '#B6282F',
                subtitle_name= f"{equipe_1} / {temporada_1}",
                subtitle_color='#B6282F',
                title_name_2=jogador_2,
                title_color_2 = '#344D94',
                subtitle_name_2= f"{equipe_2} / {temporada_2}",
                subtitle_color_2='#344D94',
                title_fontsize=20,
                subtitle_fontsize=18,
            )            

            ## endnote 
            endnote = "Gráfico: @JAmerico1898\nTodos os dados em percentil"

            ## instantiate object
            #radar = Radar()

            radar=Radar(fontfamily='Cursive', range_fontsize=8)
            fig, ax = radar.plot_radar(
                ranges=ranges,
                params=params,
                values=values,
                radar_color=['#B6282F', '#344D94'],
                dpi=600,
                alphas=[.8, .6],
                title=title,
                endnote=endnote,
                compare=True
            )
            st.pyplot(fig)

######################################################################################################################################
            # Define column metricas
            metricas = ['Duelos Ofensivos Ganhos', 'Dribles BemSucedidos', 'Acelerações', 'xG', 
                        'Finalizações NoAlvo', 'Conversão Gols', 'Conversão xG', 'Ameaça Ofensiva', 
                        'xA', 'Assistência Finalização', 'Deep Completions', 'Passes Chave', 
                        'Passes ÁreaPênalti Certos']

            # #Elaborar Tabela com Métricas do Atleta
            jogador_1_metrics = pd.read_csv('22_Role_Segundo_Atacante.csv')
            jogador_1_percents = pd.read_csv('PlayerAnalysis_Role_22.csv')
            #Collecting metrics for jogador_1
            jogador_1_metrics = jogador_1_metrics[
            ((jogador_1_metrics['Atleta'] == jogador_1) & (jogador_1_metrics['Equipe_Janela_Análise'] == equipe_1) 
            & (jogador_1_metrics['Liga'] == liga_1) & (jogador_1_metrics['Versão_Temporada'] == temporada_1))]

            jogador_1_metrics = jogador_1_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.round(decimals=2)
            jogador_1_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_1
            jogador_1_percents = jogador_1_percents[
            ((jogador_1_percents['Atleta'] == jogador_1) & (jogador_1_percents['Equipe'] == equipe_1)
            & (jogador_1_percents['Liga'] == liga_1) & (jogador_1_percents['Versão_Temporada'] == temporada_1))]
            
            jogador_1_percents = jogador_1_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_1_percents = jogador_1_percents.round(decimals=0)
            jogador_1_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_1 + "_percent"
            jogador_1_percents.iloc[0, 0] = jogador_1 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_1_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_1_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_1_metrics = pd.concat([jogador_1_metrics, jogador_1_percents])
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics = jogador_1_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_1_metrics.columns = jogador_1_metrics.iloc[0]  # Set the first row as the header
            jogador_1_metrics = jogador_1_metrics.drop(jogador_1_metrics.index[0])  # Drop the old header row
            jogador_1_metrics = jogador_1_metrics.reset_index(drop=True)
            jogador_1_metrics.insert(0, 'Métricas', metricas)
            
            
#################################################################################################################

            # #Elaborar Tabela com Métricas do Jogador_2
            jogador_2_metrics = pd.read_csv('22_Role_Segundo_Atacante.csv')
            jogador_2_percents = pd.read_csv('PlayerAnalysis_Role_22.csv')
            #Collecting metrics for jogador_2
            jogador_2_metrics = jogador_2_metrics[
            ((jogador_2_metrics['Atleta'] == jogador_2) & (jogador_2_metrics['Equipe'] == equipe_2)
            & (jogador_2_metrics['Liga'] == liga_2) & (jogador_2_metrics['Versão_Temporada'] == temporada_2))]
            jogador_2_metrics = jogador_2_metrics.iloc[:, np.r_[1, 18:31]].reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.round(decimals=2)
            jogador_2_metrics.rename(columns={'Atleta': 'Métricas'}, inplace=True)
                        
            #Collecting percentiles for jogador_2
            jogador_2_percents = jogador_2_percents[
            ((jogador_2_percents['Atleta'] == jogador_2) & (jogador_2_percents['Equipe'] == equipe_2)
            & (jogador_2_percents['Liga'] == liga_2) & (jogador_2_percents['Versão_Temporada'] == temporada_2))]
            jogador_2_percents = jogador_2_percents.iloc[:, np.r_[15, 66:79]].reset_index(drop=True)
            jogador_2_percents = jogador_2_percents.round(decimals=0)
            jogador_2_percents.rename(columns={'Atleta': 'Métricas'}, inplace=True)
            # Replace the cell at [0, 0] with jogador_2 + "_percent"
            jogador_2_percents.iloc[0, 0] = jogador_2 + "_percent"
            
            # Create a dictionary of columns to rename by removing the '_percentil' suffix
            columns_to_rename = {
                col: col.replace('_Percentil', '') for col in jogador_2_percents.columns if '_Percentil' in col
            }            

            #Collecting data to plot
            jogador_2_percents.rename(columns=columns_to_rename, inplace=True)
                                  
            #Concatenating metrics and percentiles for jogador 1
            jogador_2_metrics = pd.concat([jogador_2_metrics, jogador_2_percents])
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics = jogador_2_metrics.transpose()
            # Remove the index by resetting it and using new headers
            jogador_2_metrics.columns = jogador_2_metrics.iloc[0]  # Set the first row as the header
            jogador_2_metrics = jogador_2_metrics.drop(jogador_2_metrics.index[0])  # Drop the old header row
            jogador_2_metrics = jogador_2_metrics.reset_index(drop=True)
            jogador_2_metrics.insert(0, 'Métricas', metricas)

            # Function to apply conditional formatting based on the percentile values
            def apply_colormap_based_on_value(val):
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                if pd.isna(val):
                    return ''  # No styling for NaN values
                elif val >= 90:
                    color = cmap2(0.70)  # "Elite"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 75 <= val < 90:
                    color = cmap2(0.50)  # "Destaque"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 60 <= val < 75:
                    color = cmap(0.50)  # "Razoável"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 40 <= val < 60:
                    color = cmap(0.25)  # "Mediano"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                elif 20 <= val < 40:
                    color = cmap1(0.30)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
                else:
                    color = cmap1(0.50)  # Orange color for "Frágil"
                    return f'background-color: rgba({color[0]*255}, {color[1]*255}, {color[2]*255}, 0.8); color: black'
            # Function to apply the colormap to a specified column based on the corresponding percentiles column
            def apply_colormap_to_column_based_on_percentiles(styler, df, values_col, percentiles_col):
                colormap_styles = [apply_colormap_based_on_value(val) for val in df[percentiles_col]]
                return styler.apply(lambda _: colormap_styles, subset=[values_col])


            def merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2_nome, temporada_2):
                # Define os nomes das colunas com base nos identificadores únicos (nome + temporada)
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2_nome} ({temporada_2})"

                # Renomeia colunas dos dois dataframes
                jogador_1_metrics.columns = ['Métricas', col_jogador_1, 'Player 1 Percentiles']
                jogador_2_metrics.columns = ['Métricas', col_jogador_2, 'Player 2 Percentiles']

                # Merge dos dois dataframes com base na coluna "Métricas"
                merged_df = pd.merge(
                    jogador_1_metrics[['Métricas', col_jogador_1, 'Player 1 Percentiles']],
                    jogador_2_metrics[['Métricas', col_jogador_2, 'Player 2 Percentiles']],
                    on='Métricas'
                )

                return merged_df

            # Styling function for merged DataFrame
            def style_merged_table(merged_df, jogador_1, temporada_1, jogador_2, temporada_2):
                # Reconstruir os nomes exatos das colunas
                col_jogador_1 = f"{jogador_1} ({temporada_1})"
                col_jogador_2 = f"{jogador_2} ({temporada_2})"

                # Create a Styler object from the merged DataFrame
                styled_df = merged_df.style

                # Apply colormap to jogador_1 values based on Player 1 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_1, 'Player 1 Percentiles')

                # Apply colormap to jogador_2 values based on Player 2 percentiles
                styled_df = apply_colormap_to_column_based_on_percentiles(styled_df, merged_df, col_jogador_2, 'Player 2 Percentiles')

                # Format both jogador_1 and jogador_2 columns to display 2 decimal places
                styled_df = styled_df.format({col_jogador_1: "{:.2f}", col_jogador_2: "{:.2f}"})

                # Align text: left for Métricas, center for player columns
                styled_df = styled_df.set_properties(subset=['Métricas'], **{'text-align': 'left'})
                styled_df = styled_df.set_properties(subset=[col_jogador_1, col_jogador_2], **{'text-align': 'center'})

                # Hide percentile columns
                styled_df = styled_df.hide(axis='columns', subset=['Player 1 Percentiles', 'Player 2 Percentiles'])

                # Apply table styles
                styled_df = styled_df.set_table_styles(
                    [   {
                            'selector': 'thead th',
                            'props': [('font-weight', 'bold'),
                                    ('border-style', 'solid'),
                                    ('border-width', '0px 0px 2px 0px'),
                                    ('border-color', 'black')]
                        },
                        {
                            'selector': 'thead th:not(:first-child)',
                            'props': [('text-align', 'center')]
                        },
                        {
                            'selector': 'thead th:last-child',
                            'props': [('color', 'black')]
                        },
                        {
                            'selector': 'td',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'center')]
                        },
                        {
                            'selector': 'th',
                            'props': [('border-style', 'solid'),
                                    ('border-width', '0px 0px 1px 0px'),
                                    ('border-color', 'black'),
                                    ('text-align', 'left')]
                        }
                    ]
                ).set_properties(**{'padding': '2px', 'font-size': '15px'})

                return styled_df

            # Main function to process the data
            def main():
                # Assumindo que as variáveis abaixo já estejam definidas globalmente ou foram lidas antes do main
                # jogador_1, temporada_1, jogador_2, temporada_2
                # jogador_1_metrics, jogador_2_metrics

                # Merge the two tables
                merged_metrics = merge_metrics_tables(jogador_1_metrics, jogador_2_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Style the merged table
                styled_merged_metrics = style_merged_table(merged_metrics, jogador_1, temporada_1, jogador_2, temporada_2)

                # Convert to HTML and center-align for display
                merged_html = styled_merged_metrics.to_html(escape=False, index=False)
                center_html = f"<div style='margin-left: auto; margin-right: auto; width: fit-content;'>{merged_html}</div>"

                # Output the final table (for Streamlit)
                st.markdown(center_html, unsafe_allow_html=True)

            if __name__ == '__main__':
                main()



            # Function to plot the legend using the same colors as the apply_colormap_based_on_value function
            st.markdown("<br><h5 style='text-align: center;'>Legenda Baseada no Percentil do Jogador na Liga</h5>", unsafe_allow_html=True)

            def plot_color_legend():
                # Custom colors for the categories (using the same logic as in apply_colormap_based_on_value)
                cmap = plt.get_cmap("Blues")
                cmap1 = plt.get_cmap("Reds")
                cmap2 = plt.get_cmap("Greens")

                # Assign colors using the same logic
                colors = [
                    cmap2(0.70),   # "Elite"
                    cmap2(0.50),  # "Destaque"
                    cmap(0.50),   # "Razoável"
                    cmap(0.25),  # "Mediano"
                    cmap1(0.30), # "Frágil"
                    cmap1(0.50)  # "Péssimo"
                ]
                
                # Labels for the legend (highest to lowest)
                labels = ['Elite (>=90)', 'Destaque (75-90)', 'Razoável (60-75)', 'Mediano (40-60)', 'Frágil (20-40)', 'Péssimo (<20)']

                # Plot the legend horizontally with a smaller size
                fig, ax = plt.subplots(figsize=(6, 0.3))  # Smaller layout
                for i, (label, color) in enumerate(zip(labels[::-1], colors[::-1])):  # Reverse labels for display
                    ax.add_patch(plt.Rectangle((i, 0), 1, 1, facecolor=color, edgecolor='black'))  # Draw rectangle
                    ax.text(i + 0.5, 0.5, label, ha='center', va='center', fontsize=6.0)  # Add text inside the rectangles

                ax.set_xlim(0, 6)
                ax.set_ylim(0, 1)
                ax.axis('off')  # Remove axes

                # Add an arrow pointing from "Highest" to "Lowest"
                ax.annotate('', xy=(6, 1), xytext=(0, 1),
                            arrowprops=dict(facecolor='black', shrink=0.04, width=1.2, headwidth=5))

                return fig

            # Call the function to plot the legend and display it in Streamlit
            legend_fig = plot_color_legend()
            st.pyplot(legend_fig)            
                
# Footer
st.divider()
st.markdown("<p style='text-align: center; color: #777; font-size: 0.8em;'>Plataforma de Scouting</p>", unsafe_allow_html=True)
st.markdown("<p style='text-align: center; color: #777; font-size: 0.8em;'>@JAmerico1898</p>", unsafe_allow_html=True)

        
        
        
        
        